webpackJsonp([10],{"4Qrg":function(t,e){},CxGC:function(t,e){},Xv9X:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("woOf"),a=i.n(s),o=i("Dd8w"),n=i.n(o),r=i("NYxO"),l=i("kZ4T"),c=i("MvR/"),f=i("MsbF"),h=i("K9jU"),d=i("zWK9"),v=i("9Ak7"),_={components:{StepTitle:d.a,AreaFollowRecord:v.a},props:{tags:{type:Array,default:function(){return[]}}},data:function(){return{shopInfo:{},recordList:[],activedTag:0}},created:function(){this.tags&&this.tags.length&&this.getArchiveDetail(this.tags[0].id)},computed:{formText:function(){var t=[];return this.shopInfo.source&&t.push(this.shopInfo.source),this.shopInfo.source_second&&t.push(this.shopInfo.source_second),t.join("-")},addressStr:function(){var t="";return this.shopInfo.province_name&&(t+=this.shopInfo.province_name),this.shopInfo.city_name&&(t+=this.shopInfo.city_name),this.shopInfo.region_name&&(t+=this.shopInfo.region_name),this.shopInfo.address&&this.shopInfo.address.indexOf(this.shopInfo.province_name)>-1?t=this.shopInfo.address:this.shopInfo.address&&(t=t+"("+this.shopInfo.address+")"),t},hasCarStyle:function(){var t=[];return this.shopInfo.archive_car_brand_name&&t.push(this.shopInfo.archive_car_brand_name),this.shopInfo.archive_car_model_name&&t.push(this.shopInfo.archive_car_model_name),this.shopInfo.archive_car_series_name&&t.push(this.shopInfo.archive_car_series_name),t.join(" ")}},methods:{changeTag:function(t,e){this.activedTag=e,this.getArchiveDetail(t.id)},getArchiveDetail:function(t){var e=this;this.$fetch.business.archiveAreaDetail({id:t}).then(function(t){e.$handleResponse(t,function(t){e.shopInfo=t||{},e.recordList=t.follows?t.follows:[],e.dealData(t)},!0)}).catch(function(){e.$store.commit("closeLoading")})},dealData:function(t){var e=t.select_form;if(this.shopInfo.purpose){var i=!1;if(e&&e.Purposes&&e.Purposes.length)for(var s=0,a=e.Purposes.length;s<a;s++)if(this.shopInfo.purpose===e.Purposes[s].id){i=!0;break}i||(this.shopInfo.purpose="其他")}if(this.shopInfo.buy_type){var o=!1;if(e&&e.BuyTypes&&e.BuyTypes.length)for(var n=0,r=e.BuyTypes.length;n<r;n++)if(this.shopInfo.buy_type===e.BuyTypes[n].id){o=!0;break}o||(this.shopInfo.buy_type="其他")}var l="--";if(this.shopInfo.age>0&&e&&e.AgeRange&&e.AgeRange.length)for(var c=0,f=e.AgeRange.length;c<f;c++)if(this.shopInfo.age==e.AgeRange[c].id){l=e.AgeRange[c].name;break}this.$set(this.shopInfo,"ageText",l)}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"area-archive-component"},[i("div",{staticClass:"m-b-10"},t._l(t.tags,function(e,s){return i("el-tag",{key:"tag"+s,staticClass:"m-r-10 m-b-10",attrs:{effect:t.activedTag==s?"dark":"plain"},on:{click:function(i){return t.changeTag(e,s)}}},[t._v("\n            "+t._s(e.areaName)+"\n        ")])}),1),t._v(" "),i("div",{staticClass:"detail-wrap flex"},[i("div",{staticClass:"flex-1 detail-left"},[i("step-title",{attrs:{step:{title:"客户档案"}}}),t._v(" "),i("el-form",{ref:"form",staticClass:"m-t-20",attrs:{"label-position":"right","label-width":"150px"}},[i("el-form-item",{attrs:{label:"姓名"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.name))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"性别"}},[t._v(" "+t._s(1==t.shopInfo.sex?"男":"女")+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"手机号码"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.tel))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"微信号"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.wechat_id))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"出生日期"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.birthday))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"身份证"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.id_number))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"年龄段"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.ageText))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"客户来源"}},[t._v(" "+t._s(t._f("filterBlank")(t.formText))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"居住地址"}},[t._v(" "+t._s(t._f("filterBlank")(t.addressStr))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"保有车型"}},[t._v(" "+t._s(t._f("filterBlank")(t.hasCarStyle))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"竞争车型"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.compare_car))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"客户标签"}},[t.shopInfo.tag_info?i("div",t._l(t.shopInfo.tag_info,function(e){return i("el-tag",{key:e.tag_name,staticClass:"m-r-5 m-b-5"},[t._v("\n                          "+t._s(e.tag_name)+"\n                        ")])}),1):i("div",[t._v("--")])]),t._v(" "),i("el-form-item",{attrs:{label:"购车用途"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.purpose))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"购车类型"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.buy_type))+" ")]),t._v(" "),"置换"==t.shopInfo.buy_type?i("el-form-item",{attrs:{label:"二手车车型"}},[t._v(" "+t._s(t._f("filterBlank")(t.shopInfo.second_hand_car))+" ")]):t._e()],1)],1),t._v(" "),i("div",{staticClass:"w-100"}),t._v(" "),i("div",{staticClass:"flex-1 detail-right"},[i("step-title",{attrs:{step:{title:"跟进记录"}}}),t._v(" "),i("area-follow-record",{attrs:{list:t.recordList}})],1)])])},staticRenderFns:[]};var p=i("VU/8")(_,u,!1,function(t){i("l501")},"data-v-7b712c40",null).exports,m=i("Gu7T"),g=i.n(m),b=i("Y1jt"),I={components:{StepTitle:d.a,FollowRecord:b.a},props:{info:{type:Object,default:function(){return{}}}},data:function(){return{recordList:[],followPage:{totalCount:0,page:1,pageSize:10,totalPage:1}}},created:function(){this.potentialId=this.$route.query.id,this.getFollowList("init")},computed:{buyPlace:function(){var t=[];return this.info.provinceName&&t.push(this.info.provinceName),this.info.cityName&&t.push(this.info.cityName),this.info.regionName&&t.push(this.info.regionName),t.join("--")},buyQuotaText:function(){var t="";switch(this.info.buyQuota){case 0:t="未知";break;case 1:t="有";break;case 2:t="无"}return t},isMortgageText:function(){return 1==this.info.isMortgage?"是":2==this.info.isMortgage?"否":"未知"},buyTypeText:function(){var t="";switch(this.info.buyType){case 1:t="首次购车";break;case 2:t="增购";break;case 3:t="置换";break;case 4:t="其他";break;default:t="未知"}return t},intentionInfo:function(){var t=[];return this.info.intentionInfo&&this.info.intentionInfo.length?this.info.intentionInfo.forEach(function(e){var i=[];e.fromTopName&&i.push(e.fromTopName),e.fromSecondName&&i.push(e.fromSecondName),e.formText=i.join("-"),t.push(e)}):t.push({areaName:"",model:"",fromText:""}),t}},methods:{getFollowList:function(t){var e=this;"init"==t&&(this.recordList=[],this.followPage.page=1);var i=this.followPage,s=i.page,a=i.pageSize,o={typeId:1,id:this.potentialId,page:s,pageSize:a};this.$fetch.common.followListByType(o,!1).then(function(t){e.$handleResponse(t,function(t){var i=t.list,s=t.page;i&&i.length>0&&(e.recordList=[].concat(g()(e.recordList),g()(i))),e.followPage.totalCount=s.totalCount,e.followPage.totalPage=s.totalPage},!0)}).catch(function(){e.$store.commit("closeLoading")})},handleFollowScroll:function(){this.followPage.page>=this.followPage.totalPage||(this.followPage.page++,this.getFollowList())}}},C={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"dcc-archive-component"},[i("div",{staticClass:"detail-wrap flex"},[i("div",{staticClass:"flex-1 detail-left"},[i("step-title",{attrs:{step:{title:"客户档案"}}}),t._v(" "),i("el-form",{ref:"form",staticClass:"m-t-20",attrs:{"label-position":"right","label-width":"150px"}},[i("el-form-item",{attrs:{label:"跟进状态"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.statusName))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"跟进坐席组"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.dccGroupName))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"跟进DCC"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.dccName))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"客户ID"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.userId))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"客户姓名"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.nickname))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"手机号码"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.tel))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"意向等级"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.level))+" "),t.info.level?i("span",[t._v("级")]):t._e()]),t._v(" "),i("el-form-item",{attrs:{label:"建档时间"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.createdAt))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"最后跟进时间"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.lastFollowDate))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"下次跟进时间"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.nextFollowDate))+" ")]),t._v(" "),t._l(t.intentionInfo,function(e,s){return i("div",{key:"inten"+s},[i("el-form-item",{attrs:{label:"归属门店"+(s+1)}},[t._v(" "+t._s(t._f("filterBlank")(e.areaName))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"意向车型"+(s+1)}},[t._v(" "+t._s(t._f("filterBlank")(e.model))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"客户来源"+(s+1)}},[t._v(" "+t._s(t._f("filterBlank")(e.formText))+" ")])],1)}),t._v(" "),i("el-form-item",{attrs:{label:"销售顾问"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.advisorName))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"购车区域"}},[t._v(" "+t._s(t._f("filterBlank")(t.buyPlace))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"购车指标"}},[t._v(" "+t._s(t._f("filterBlank")(t.buyQuotaText))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"购车类型"}},[t._v(" "+t._s(t._f("filterBlank")(t.buyTypeText))+" ")]),t._v(" "),i("el-form-item",{attrs:{label:"是否贷款"}},[t._v(" "+t._s(t._f("filterBlank")(t.isMortgageText))+" ")])],2)],1),t._v(" "),i("div",{staticClass:"w-100"}),t._v(" "),i("div",{staticClass:"flex-1 detail-right"},[i("step-title",{attrs:{step:{title:"跟进记录"}}}),t._v(" "),i("follow-record",{staticClass:"m-t-20 p-20 potential-follow-record reset-scrollbar",attrs:{"record-list":t.recordList,scrollEvent:!0},on:{"event-scroll":t.handleFollowScroll}})],1)])])},staticRenderFns:[]};var y=i("VU/8")(I,C,!1,function(t){i("s20F")},"data-v-deb74b82",null).exports,w={components:{TabsScrm:l.a,BreadCrumb:c.a,Distribute:f.a,Actived:h.a,AreaArchive:p,DccArchive:y},data:function(){return{tabs:[{title:"DCC档案",name:"dcc",count:"1"}],activedTab:"dcc",info:{},showDistribute:!1,showActived:!1,viewStatus:"",viewLevel:"",dialogLoading:!1}},created:function(){this.areaArr=[],this.getLevelOption(),this.potentialId=this.$route.query.id,this.getDccArchiveDetail(this.potentialId)},computed:n()({},Object(r.b)(["roleKey"])),methods:{getReloadData:function(){this.activedTab="dcc",this.$refs.tabs.initTab(),this.getDccArchiveDetail(this.potentialId),this.$refs.dccArchive&&this.$refs.dccArchive.getFollowList("init")},changeTab:function(t){this.activedTab=t,"dcc"==t&&this.getDccArchiveDetail(this.potentialId)},getDccArchiveDetail:function(t){var e=this;this.$fetch.business.archiveDccDetail({id:t}).then(function(t){e.$handleResponse(t,function(t){e.info=t||{},t.areaArchive&&t.areaArchive.length&&0==e.areaArr.length&&(e.areaArr=t.areaArchive,e.tabs&&1==e.tabs.length&&e.tabs.push({title:"门店档案",name:"area",count:"10"}),e.tabs[1]&&(e.tabs[1].count=t.areaArchive.length)),e.viewStatus=e.info.status,e.viewLevel=e.info.level},!0)}).catch(function(){e.$store.commit("closeLoading")})},handleFollow:function(){this.$router.push({path:"/work/customerFollow",query:{id:this.info.id,userId:this.info.userId}})},distributeFn:function(){var t=this;this.disConfig={title:"分配",groupLabel:"处理坐席组",groupOptions:[],groupObj:{},dccLabel:"处理DCC",dccRequired:!0,selectId:[this.potentialId],tip:""},this.$fetch.business.archiveAssignDCCList({ids:this.disConfig.selectId,operate:"assign"}).then(function(e){t.$handleResponse(e,function(e){t.disConfig.listTotal=e.listTotal,1==e.listTotal?(t.disConfig.groupOptions=t.$hasArrContent(e.list)?e.list:[],t.showDistribute=!0,t.dialogLoading=!1):e.listTotal>1?t.$message.error("所选潜客分别归属多个组，不能被分配(分配功能只可选择归属坐席组一致且非战败审核中的潜客，您可通过归属门店和跟进状态进行潜客筛选)"):t.$notify.error({title:"错误提示",message:"当前潜客不符合要求"})},!0)}).catch(function(){t.$store.commit("closeLoading")})},closeDistribute:function(t,e){var i=this;if("cancel"==t)return this.showDistribute=!1,void(this.dialogLoading=!1);if(e.dccId){var s=a()({ids:this.disConfig.selectId},e);this.dialogLoading=!0,this.$fetch.business.ArchiveAssign(s).then(function(t){i.$handleResponse(t,function(t){i.$message.success("分配成功"),i.showDistribute=!1,i.getReloadData()},!0),i.dialogLoading=!1}).catch(function(){i.dialogLoading=!1,i.$store.commit("closeLoading")})}else this.$message.error("请选择dcc人员")},getLevelOption:function(){var t=this;this.$fetch.common.commonClueLevelList({},!1,!1).then(function(e){t.$handleResponse(e,function(e){if(t.$hasArrContent(e)){var i=[];e.forEach(function(t){i.push({title:t+"级",id:t})}),t.levelOptions=i}},!1)})},handleActive:function(){var t=this;this.actConfig={title:"激活",groupLabel:"处理坐席组",groupOptions:[],groupObj:{},dccLabel:"处理DCC",dccRequired:!0,showLevel:!0,levelOptions:this.levelOptions?this.levelOptions:[],showTime:!0,selectId:[this.potentialId],tip:""},this.$fetch.business.archiveAssignDCCList({ids:this.actConfig.selectId,operate:"defeatActive"}).then(function(e){t.$handleResponse(e,function(e){t.actConfig.listTotal=e.listTotal,1==e.listTotal?(t.actConfig.groupOptions=t.$hasArrContent(e.list)?e.list:[],t.showActived=!0,t.dialogLoading=!1,t.actConfig.tip=""):e.listTotal>1?(t.showActived=!0,t.dialogLoading=!1,t.actConfig.groupOptions=[],t.actConfig.tip="您所选择的潜客档案归属坐席组不一致，批量激活后这些潜客并由原处理DCC继续处理"):t.$notify.error({title:"错误提示",message:"当前潜客不符合要求"})},!0)}).catch(function(){t.$store.commit("closeLoading")})},closeActived:function(t,e){var i=this;if("cancel"==t)return this.showActived=!1,void(this.dialogLoading=!1);var s=a()({ids:this.actConfig.selectId},e);this.dialogLoading=!0,this.$fetch.business.defeatActive(s).then(function(t){i.$handleResponse(t,function(t){i.$message.success("激活成功"),i.showActived=!1,i.getReloadData()},!0),i.dialogLoading=!1}).catch(function(){i.dialogLoading=!1,i.$store.commit("closeLoading")})}}},k={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"potential-detail-page m-20"},[i("bread-crumb"),t._v(" "),i("div",{staticClass:"common-box  m-t-20 por"},[i("tabs-scrm",{ref:"tabs",attrs:{tabs:t.tabs,tabStyle:{height:"3px",line:"top"}},on:{change:t.changeTab}}),t._v(" "),i("div",{staticClass:"detail-btn"},[4!=t.viewStatus?i("el-button",{staticClass:"w-60",attrs:{type:"primary",round:"",size:"small",disabled:-1==["dcc_supervisor","dcc_group_leader","administrator"].indexOf(t.roleKey)},on:{click:t.distributeFn}},[t._v("分配")]):t._e(),t._v(" "),"F"==t.viewLevel?i("el-button",{staticClass:"w-60",attrs:{type:"primary",round:"",size:"small",disabled:-1==["dcc_supervisor","dcc_group_leader","dcc_inviter","administrator"].indexOf(t.roleKey)},on:{click:t.handleActive}},[t._v("激活")]):t._e(),t._v(" "),"F"!=t.viewLevel?i("el-button",{staticClass:"w-60",attrs:{type:"primary",round:"",size:"small",disabled:"dcc_inviter"!==t.roleKey},on:{click:t.handleFollow}},[t._v("跟进")]):t._e()],1),t._v(" "),"dcc"==t.activedTab?i("dcc-archive",{ref:"dccArchive",attrs:{info:t.info}}):t._e(),t._v(" "),"area"==t.activedTab?i("area-archive",{attrs:{tags:t.areaArr}}):t._e()],1),t._v(" "),t.showDistribute?i("distribute",{attrs:{config:t.disConfig,loading:t.dialogLoading},on:{close:t.closeDistribute}}):t._e(),t._v(" "),t.showActived?i("actived",{attrs:{config:t.actConfig,loading:t.dialogLoading},on:{close:t.closeActived}}):t._e()],1)},staticRenderFns:[]};var A=i("VU/8")(w,k,!1,function(t){i("4Qrg")},"data-v-7bcb7f1d",null);e.default=A.exports},l501:function(t,e){},s20F:function(t,e){},zWK9:function(t,e,i){"use strict";var s={props:{step:{type:Object,default:function(){return{title:"第一步",content:"海报内容"}}},colorStyle:{type:String,default:""}},data:function(){return{}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"step-title-component step__order por"},[i("el-row",[i("el-col",{attrs:{span:12}},[i("span",{staticClass:"step_left"},[t._v(t._s(t.step.title))]),t._v(" "),i("span",{class:t.colorStyle},[t._v(t._s(t.step.content))])]),t._v(" "),i("el-col",{attrs:{span:12}},[t._t("default")],2)],1)],1)},staticRenderFns:[]};var o=i("VU/8")(s,a,!1,function(t){i("CxGC")},"data-v-27537562",null);e.a=o.exports}});
//# sourceMappingURL=10.a5096cf45f4ef8eba5b9.js.map