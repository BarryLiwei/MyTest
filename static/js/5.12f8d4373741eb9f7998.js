webpackJsonp([5],{U8P7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("MvR/"),i=a("kfhN"),n={components:{BreadCrumb:s.a,ScrmFormItem:i.a},data:function(){return{type:"add",parentData:{},info:{name:"",id:""},transProps:{key:"id",label:"short_name"},dataAreas:[],selectedAreas:[],labelTitle:"子组织名称"}},created:function(){this.parentData=this.$route.query,"/setting/org-structure/edit"==this.$route.path&&(this.type="edit",this.labelTitle="当前组织名称",this.getDetialOrg(this.parentData.id)),this.getShopList()},methods:{cancel:function(){this.$router.push("/setting/org-structure")},getShopList:function(){var t=this,e={pagination:0},a="edit"==this.type?this.parentData.id:this.parentData.parentId;e.mode="edit"==this.type?"update":"add",this.$fetch.setting.queryOrgShopList(a,e).then(function(e){t.$handleResponse(e,function(e){t.dataAreas=e.areas&&e.areas.list},!0),"edit"==t.type&&t.getRightShop()}).catch(function(e){t.$store.commit("closeLoading")})},getRightShop:function(){var t=this,e={expand:"brands",orgId:this.parentData.id};this.$fetch.setting.queryAreasList(e).then(function(e){t.$handleResponse(e,function(e){t.$hasArrContent(e.list)&&e.list.forEach(function(e){t.selectedAreas.push(e.id),t.dataAreas.push(e)})},!0)}).catch(function(e){t.$store.commit("closeLoading")})},getDetialOrg:function(t){var e=this;this.$fetch.setting.orgInfo(t,{}).then(function(t){e.$handleResponse(t,function(t){e.info=t.org},!0)}).catch(function(t){e.$store.commit("closeLoading")})},addManager:function(){var t=this.getParams();t&&("add"==this.type?this.createFn(t):this.updateFn(t))},getParams:function(){var t=this.info,e=(t.areaIds,t.name),a={areaIds:this.selectedAreas,name:e,pid:this.parentData.parentId};return e?a:(this.$message.error("组织名称不能为空"),!1)},createFn:function(t){var e=this;this.$fetch.setting.orgCreate(t).then(function(t){e.$handleResponse(t,function(t){e.$message.success("新增成功"),e.$router.push("/setting/org-structure")},!0)}).catch(function(t){e.$store.commit("closeLoading")})},updateFn:function(t){var e=this;this.$fetch.setting.orgUpdate(this.parentData.id,t).then(function(t){e.$handleResponse(t,function(t){e.$message.success("更新成功"),e.$router.push("/setting/org-structure")},!0)}).catch(function(t){e.$store.commit("closeLoading")})},filterMethod:function(t){}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"add-org-page m-20"},[a("bread-crumb"),t._v(" "),a("div",{staticClass:"common-box p-b-20 m-t-20"},[a("div",{staticClass:"group-title"},[t._v("上层组织: "),a("span",{staticClass:"m-l-5"},[t._v(t._s(t.parentData.parentName?t.parentData.parentName:"广汽集团"))])]),t._v(" "),a("el-form",{ref:"form",staticClass:"m-t-20",attrs:{"label-width":"150px"}},[a("scrm-form-item",{attrs:{itemLabel:t.labelTitle,itemType:"input",itemRequired:!0,itemClass:"form_required_after",itemInfo:t.info,itemKey:"name",subClass:"w-350",placeholder:"限20个字符",maxlength:20}}),t._v(" "),a("el-form-item",{attrs:{label:"选择门店"}},[a("el-transfer",{staticClass:"transfer-class",attrs:{filterable:"","filter-placeholder":"请输入选项名称",data:t.dataAreas,titles:["待选选择：","已选列表："],props:t.transProps},model:{value:t.selectedAreas,callback:function(e){t.selectedAreas=e},expression:"selectedAreas"}})],1),t._v(" "),a("el-form-item",{staticClass:"m-t-50",attrs:{label:""}},[a("el-button",{staticClass:"w-90",attrs:{round:"",size:"small"},on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),a("el-button",{staticClass:"w-90",attrs:{round:"",size:"small",type:"primary"},on:{click:t.addManager}},[t._v("保 存")])],1)],1)],1)],1)},staticRenderFns:[]};var o=a("VU/8")(n,r,!1,function(t){a("khis")},"data-v-e6d202cc",null);e.default=o.exports},khis:function(t,e){}});
//# sourceMappingURL=5.12f8d4373741eb9f7998.js.map