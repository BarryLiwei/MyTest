webpackJsonp([6],{"2d3c":function(t,e,a){"use strict";var i=a("BO1k"),l=a.n(i),s=a("woOf"),o=a.n(s),n=a("/Pc9"),c=a("PJh5"),r=a.n(c),d={props:{dccConfig:{type:Object,default:function(){return{}}}},data:function(){return{loading:!1,dialogVisible:!0,followTypeOptions:[{value:1,label:"电话跟进"},{value:2,label:"微信跟进"}],followResultOptions:[{value:1,label:"继续跟进"},{value:2,label:"下发邀约"}],genderOptions:[{value:1,label:"男"},{value:2,label:"女"}],options:[{value:1,label:"是"},{value:0,label:"否"}],options2:[{value:1,label:"有"},{value:0,label:"无"}],yaoyueOptions:[],filters:{dccGroupId:"",dccId:"",nickname:"",tel:"",wechatNumber:"",wechatAdded:"",buyType:"",isMortgage:"",provinceId:"",cityId:"",regionId:"",buyQuota:"",level:"H",followType:1,followResult:1,remark:"",addClue:""},pickerOptions:{},nextFollowDate:"",nextFollowDate2:"",inviteInfo:[{areaId:"",date:""}],source:[{source_id:1,source_title:"2323"}],clueFromOptions:"",buyTypeOptions:"",areaListOptions:"",source_second:[],intentionInfo:[{areaId:"",brandId:"",carSeriesId:"",modelId:"",fromTopId:"",fromSecondId:""}],intentionInfoOptions:[{brandOptions:[],seriesOptions:[],modelOptions:[]}],cars:[],address:"",shiAddress:"",sheng:"",quAddress:"",gender:"",dccOptions:[],minTime:r()(new Date).subtract(1,"day")}},created:function(){this.getFollowForm(),this.getAreaList(),this.getCitys(),this.getNextFollowDate()},methods:{initSDK:function(){var t=document.getElementById("clues-phone-slot");console.log(t),t&&new window.AiccSdk.default({companyId:"34590",mobile:"13168766000",client_id:"9vVgN0xsBFpSuz8W",client_secret:"c2lhuHLS0Z6beCFC07lPniiDEGSR1A",phoneRenderSlot:t})},handleClick:function(t,e){console.log(t,e)},add:function(){this.dialogVisible=!0},handleClose:function(){this.dialogVisible=!1,this.$emit("archiveCloseFn","cancel")},save:function(){var t=this;console.log(this.filters);var e={};if(o()(e,this.filters),e.wechatAdded=1==e.wechatAdded?1:0,e.addClue=1==e.addClue?1:0,e.gender=this.gender,e.intentionInfo=this.intentionInfo,console.log(e),!this.dccConfig.show||this.filters.dccGroupId)if(!this.dccConfig.show||this.filters.dccId)if(e.nickname)if(e.gender)if(e.tel)if(!e.tel||/^1[0-9]{10}$/.test(e.tel)){var a=!0;try{e.intentionInfo.forEach(function(e,i){if(!e.areaId)throw t.$message.error("请选择归属门店"),a=!1,Error();if(console.log("dsdsd"),e.areaId&&!e.modelId)throw t.$message.error("请选择意向车型"),a=!1,Error();if(!e.fromTopId)throw t.$message.error("请选择客户来源"),a=!1,Error()})}catch(t){}if(a){if(1==this.filters.followResult){if(e.nextFollowDate=this.nextFollowDate,!e.nextFollowDate)return void this.$message.error("请选择下次跟进时间")}else{e.inviteInfo=this.inviteInfo,e.nextFollowDate=this.nextFollowDate2;var i=!0;try{e.inviteInfo.forEach(function(e,a){if(!e.areaId)throw t.$message.error("请选择邀约门店"),i=!1,Error();if(console.log("dsdsd"),e.areaId&&!e.date)throw t.$message.error("请选择到店时间"),i=!1,Error()})}catch(t){}if(!i)return}e.remark?(console.log(e),this.loading=!0,n.clueAdd2(e).then(function(e){t.loading=!1,t.$handleResponse(e,function(e){console.log(e),t.$emit("archiveCloseFn","success")},!0)}).catch(function(e){t.loading=!1,t.$store.commit("closeLoading")})):this.$message.error("请填写客户描述")}}else this.$message.error("客户电话格式错误！");else this.$message.error("请填写客户电话");else this.$message.error("请填写性别");else this.$message.error("请填写客户姓名");else this.$message.error("请填写处理DCC");else this.$message.error("请填写处理坐席组")},addStroeAndCar:function(){this.storeAndCar.push({store:"",car:""})},getFollowForm:function(){var t=this;n.getFollowForm({}).then(function(e){t.$handleResponse(e,function(e){t.clueFromOptions=e.clueFrom,t.buyTypeOptions=e.buyType},!0)}).catch(function(e){t.$store.commit("closeLoading")})},getAreaList:function(){var t=this;this.$fetch.common.commonAreaList({}).then(function(e){t.$handleResponse(e,function(e){t.areaListOptions=e,t.$forceUpdate()},!0)}).catch(function(e){t.$store.commit("closeLoading")})},getCitys:function(){var t=this;n.getRegin({}).then(function(e){t.$store.commit("closeLoading"),t.$handleResponse(e,function(e){console.log(e),t.address=e,t.address.forEach(function(e){t.filters.provinceId==e.id&&(t.sheng=e,t.shiAddress=e.children,e.children.forEach(function(e){t.filters.cityId==e.id&&(t.shi=e,t.quAddress=e.children,e.children.forEach(function(e){t.filters.regionId==e.id&&(t.qu=e)}))}))})},!0)}).catch(function(e){t.$store.commit("closeLoading")})},changeSheng:function(){this.filters.cityId="",this.filters.regionId="",this.shiAddress=[],this.quAddress=[];var t=!0,e=!1,a=void 0;try{for(var i,s=l()(this.address);!(t=(i=s.next()).done);t=!0){var o=i.value;o.id==this.filters.provinceId&&(this.shiAddress=o.children)}}catch(t){e=!0,a=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw a}}},changeShi:function(){this.filters.regionId="",this.quAddress=[];var t=!0,e=!1,a=void 0;try{for(var i,s=l()(this.shiAddress);!(t=(i=s.next()).done);t=!0){var o=i.value;o.id==this.filters.cityId&&(this.quAddress=o.children)}}catch(t){e=!0,a=t}finally{try{!t&&s.return&&s.return()}finally{if(e)throw a}}},changeQu:function(){},sourceChange:function(t){this.intentionInfo[t].fromSecondId="";var e=!0,a=!1,i=void 0;try{for(var s,o=l()(this.clueFromOptions);!(e=(s=o.next()).done);e=!0){var n=s.value;n.id==this.intentionInfo[t].fromTopId&&(this.source_second=n.children||[])}}catch(t){a=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(a)throw i}}},sourceSecondChange:function(){this.$forceUpdate()},areaIdChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments[1];this.intentionInfo[t].brandId="",this.intentionInfo[t].carSeriesId="",this.intentionInfo[t].modelId="",this.intentionInfoOptions[t].brandOptions=[],this.intentionInfoOptions[t].seriesOptions=[],this.intentionInfoOptions[t].modelOptions=[],this.getBrandList(this.intentionInfo[t].areaId,t),console.log(e);var a=this.intentionInfo[t].areaId,i="";this.areaListOptions.forEach(function(t){t.id==a&&(i=t.title)}),this.yaoyueOptions=[{id:a,title:i}]},getBrandList:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.$fetch.common.carBrand({areaId:t},!1).then(function(t){e.$handleResponse(t,function(t){e.intentionInfoOptions[a].brandOptions=e.$hasArrContent(t)?t:[]},!1)})},changeBrand:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.intentionInfo[a].carSeriesId="",this.intentionInfo[a].modelId="",this.intentionInfoOptions[a].seriesOptions=[],this.intentionInfoOptions[a].modelOptions=[],this.$fetch.common.carSeries({brandId:t},!1).then(function(t){e.$handleResponse(t,function(t){e.intentionInfoOptions[a].seriesOptions=e.$hasArrContent(t)?t:[]},!1)})},changeSeries:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.intentionInfo[a].modelId="",this.intentionInfoOptions[a].modelOptions=[],this.$fetch.common.carModel({seriesId:t},!1).then(function(t){e.intentionInfoOptions[a].modelOptions=e.$hasArrContent(t.data.data)?t.data.data:[]})},changeModel:function(t){this.$forceUpdate()},getNextFollowDate:function(){var t=this,e=this;1==this.filters.followResult&&n.nextFollowDate({level:this.filters.level}).then(function(a){t.$store.commit("closeLoading"),t.$handleResponse(a,function(a){t.pickerOptions={disabledDate:function(t){return t<new Date(e.minTime).getTime()||t>new Date(a.date).getTime()}},t.nextFollowDate=a.date},!0)}).catch(function(e){t.$store.commit("closeLoading")})},dccGroupChange:function(t){var e=this.dccConfig.groupObj[t].dccList;this.filters.dccId="",this.dccOptions=this.$hasArrContent(e)?e:[]}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"add-archives-dialog"},[a("el-dialog",{attrs:{title:"新增档案",visible:t.dialogVisible,"close-on-click-modal":!1,"custom-class":"dialog-width","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"dialog-center"},[a("el-row",{attrs:{gutter:22}},[t.dccConfig.show?a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("\n                              处理坐席组\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",size:"small"},on:{change:t.dccGroupChange},model:{value:t.filters.dccGroupId,callback:function(e){t.$set(t.filters,"dccGroupId",e)},expression:"filters.dccGroupId"}},t._l(t.dccConfig.groupOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.dccGroupName,value:t.id}})}),1)],1)])],1)],1):t._e(),t._v(" "),t.dccConfig.show?a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("\n                              处理DCC\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",size:"small"},model:{value:t.filters.dccId,callback:function(e){t.$set(t.filters,"dccId",e)},expression:"filters.dccId"}},t._l(t.dccOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.dccName,value:t.id}})}),1)],1)])],1)],1):t._e(),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("客户名称\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-input",{attrs:{placeholder:"请输入",maxlength:"20"},model:{value:t.filters.nickname,callback:function(e){t.$set(t.filters,"nickname",e)},expression:"filters.nickname"}})],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("性别\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-radio-group",{staticClass:"radio-button-level",staticStyle:{width:"100%"},attrs:{gutter:24,size:"small"},model:{value:t.gender,callback:function(e){t.gender=e},expression:"gender"}},t._l(t.genderOptions,function(e){return a("el-radio-button",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])}),1)],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("客户电话\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-input",{attrs:{placeholder:"请输入",type:"text",maxlength:"11"},model:{value:t.filters.tel,callback:function(e){t.$set(t.filters,"tel",e)},expression:"filters.tel"}})],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("微信号\n                              "),a("span",{staticClass:"mini-width5"})])]),t._v(" "),a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content"},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:t.filters.wechatNumber,callback:function(e){t.$set(t.filters,"wechatNumber",e)},expression:"filters.wechatNumber"}})],1)]),t._v(" "),a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content"},[a("el-checkbox",{staticClass:"grid-content-wechat",staticStyle:{float:"right"},model:{value:t.filters.wechatAdded,callback:function(e){t.$set(t.filters,"wechatAdded",e)},expression:"filters.wechatAdded"}},[t._v("已加微信")])],1)])],1)],1),t._v(" "),t._l(t.intentionInfo,function(e,i){return a("el-col",{key:i,staticClass:"m-b-10",staticStyle:{"padding-left":"0","padding-right":"0"},attrs:{span:24}},[a("el-col",{attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("归属门店\n                                  "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",size:"small"},on:{change:function(e){return t.areaIdChange()}},model:{value:t.intentionInfo[i].areaId,callback:function(e){t.$set(t.intentionInfo[i],"areaId",e)},expression:"intentionInfo[index].areaId"}},t._l(t.areaListOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1)])],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("意向车型\n                                  "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-col",{attrs:{span:8}},[a("el-select",{class:""==t.intentionInfo[i].brandId?"c-placeholder":"",attrs:{placeholder:"请选择",filterable:"",size:"small"},on:{change:t.changeBrand},model:{value:t.intentionInfo[i].brandId,callback:function(e){t.$set(t.intentionInfo[i],"brandId",e)},expression:"intentionInfo[index].brandId"}},t._l(t.intentionInfoOptions[i].brandOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-select",{class:""==t.intentionInfo[i].carSeriesId?"c-placeholder":"",attrs:{placeholder:"请选择",filterable:"",size:"small"},on:{change:t.changeSeries},model:{value:t.intentionInfo[i].carSeriesId,callback:function(e){t.$set(t.intentionInfo[i],"carSeriesId",e)},expression:"intentionInfo[index].carSeriesId"}},t._l(t.intentionInfoOptions[i].seriesOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-select",{class:""==t.intentionInfo[i].modelId?"c-placeholder":"",attrs:{placeholder:"请选择",filterable:"",size:"small"},on:{change:t.changeModel},model:{value:t.intentionInfo[i].modelId,callback:function(e){t.$set(t.intentionInfo[i],"modelId",e)},expression:"intentionInfo[index].modelId"}},t._l(t.intentionInfoOptions[i].modelOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1)],1)])],1)],1)],1)}),t._v(" "),t._l(t.intentionInfo,function(e,i){return a("el-col",{key:"source-"+i,staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("\n                              客户来源\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-col",{attrs:{span:12}},[a("el-select",{attrs:{placeholder:"一级来源",filterable:"",size:"small"},on:{change:function(e){return t.sourceChange(i)}},model:{value:e.fromTopId,callback:function(a){t.$set(e,"fromTopId",a)},expression:"items.fromTopId"}},t._l(t.clueFromOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-select",{attrs:{placeholder:"二级来源",filterable:"",size:"small"},on:{change:t.sourceSecondChange},model:{value:e.fromSecondId,callback:function(a){t.$set(e,"fromSecondId",a)},expression:"items.fromSecondId"}},t._l(t.source_second,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1)],1)])],1)],1)}),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("\n                              购车区域\n                              "),a("span",{staticClass:"mini-width5"})])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-col",{attrs:{span:8}},[a("el-select",{class:""==t.filters.provinceId?"c-placeholder":"",staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"省",size:"small"},on:{change:t.changeSheng},model:{value:t.filters.provinceId,callback:function(e){t.$set(t.filters,"provinceId",e)},expression:"filters.provinceId"}},t._l(t.address,function(t){return a("el-option",{key:t.id,attrs:{label:t.regionName,value:t.id}})}),1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-select",{class:""==t.filters.cityId?"c-placeholder":"",attrs:{placeholder:"市",filterable:"",size:"small"},on:{change:t.changeShi},model:{value:t.filters.cityId,callback:function(e){t.$set(t.filters,"cityId",e)},expression:"filters.cityId"}},t._l(t.shiAddress,function(t){return a("el-option",{key:t.id,attrs:{label:t.regionName,value:t.id}})}),1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-select",{class:""==t.filters.regionId?"c-placeholder":"",attrs:{placeholder:"区",filterable:"",size:"small"},on:{change:t.changeQu},model:{value:t.filters.regionId,callback:function(e){t.$set(t.filters,"regionId",e)},expression:"filters.regionId"}},t._l(t.quAddress,function(t){return a("el-option",{key:t.id,attrs:{label:t.regionName,value:t.id}})}),1)],1)],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("购车指标"),a("span",{staticClass:"mini-width5"})])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-radio-group",{staticClass:"radio-button-level",staticStyle:{width:"100%"},attrs:{gutter:24,size:"small"},model:{value:t.filters.buyQuota,callback:function(e){t.$set(t.filters,"buyQuota",e)},expression:"filters.buyQuota"}},t._l(t.options2,function(e){return a("el-radio-button",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])}),1)],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("购车类型\n                              "),a("span",{staticClass:"mini-width5"})])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.filters.buyType,callback:function(e){t.$set(t.filters,"buyType",e)},expression:"filters.buyType"}},t._l(t.buyTypeOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id,size:"small"}})}),1)],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("是否贷款\n                              "),a("span",{staticClass:"mini-width5"})])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-radio-group",{staticClass:"radio-button-level",staticStyle:{width:"100%"},attrs:{gutter:24,size:"small"},model:{value:t.filters.isMortgage,callback:function(e){t.$set(t.filters,"isMortgage",e)},expression:"filters.isMortgage"}},t._l(t.options,function(e){return a("el-radio-button",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])}),1)],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10 col-line-height",attrs:{span:12}}),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("客户级别\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-radio-group",{staticClass:"radio-button-level",staticStyle:{width:"100%"},attrs:{gutter:24,size:"small"},on:{change:function(e){return t.getNextFollowDate()}},model:{value:t.filters.level,callback:function(e){t.$set(t.filters,"level",e)},expression:"filters.level"}},[a("el-radio-button",{attrs:{label:"H"}}),t._v(" "),a("el-radio-button",{attrs:{label:"A"}}),t._v(" "),a("el-radio-button",{attrs:{label:"B"}}),t._v(" "),a("el-radio-button",{attrs:{label:"C"}})],1)],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("跟进类型\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-radio-group",{staticClass:"radio-button-level",staticStyle:{width:"100%"},attrs:{gutter:24,size:"small"},model:{value:t.filters.followType,callback:function(e){t.$set(t.filters,"followType",e)},expression:"filters.followType"}},t._l(t.followTypeOptions,function(e){return a("el-radio-button",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])}),1)],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("跟进结果\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-radio-group",{staticClass:"radio-button-level",staticStyle:{width:"100%"},attrs:{gutter:24,size:"small"},on:{change:function(e){return t.getNextFollowDate()}},model:{value:t.filters.followResult,callback:function(e){t.$set(t.filters,"followResult",e)},expression:"filters.followResult"}},t._l(t.followResultOptions,function(e){return a("el-radio-button",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])}),1)],1)])],1)],1),t._v(" "),1==t.filters.followResult?a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("下次跟进\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-date-picker",{staticClass:"my-date-picker",staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,size:"small"},model:{value:t.nextFollowDate,callback:function(e){t.nextFollowDate=e},expression:"nextFollowDate"}})],1)])],1)],1):t._e(),t._v(" "),2==t.filters.followResult?a("el-col",{staticClass:"m-b-10 col-line-height",attrs:{span:12}}):t._e(),t._v(" "),t._l(t.inviteInfo,function(e,i){return 2==t.filters.followResult?a("el-col",{key:"invite-"+i,staticClass:"m-b-10",staticStyle:{"padding-left":"0","padding-right":"0"},attrs:{span:24}},[a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("邀约门店\n                                  "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择",size:"small"},model:{value:e.areaId,callback:function(a){t.$set(e,"areaId",a)},expression:"items.areaId"}},t._l(t.yaoyueOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("到店时间\n                                  "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-date-picker",{staticClass:"my-date-picker",staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择到店时间","value-format":"yyyy-MM-dd HH:mm",format:"yyyy-MM-dd HH:mm",size:"small"},model:{value:e.date,callback:function(a){t.$set(e,"date",a)},expression:"items.date"}})],1)])],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"grid-content-left"},[t._v("下次跟进\n                                  "),a("span",{staticClass:"mini-width5"})])]),t._v(" "),a("el-col",{attrs:{span:17}},[a("div",{staticClass:"grid-content"},[a("el-date-picker",{staticClass:"my-date-picker",staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",size:"small"},model:{value:t.nextFollowDate2,callback:function(e){t.nextFollowDate2=e},expression:"nextFollowDate2"}})],1)])],1)],1)],1):t._e()}),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:24}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content-left content-left-remark"},[t._v("客户描述\n                              "),a("span",{staticClass:"red"},[t._v("*")])])]),t._v(" "),a("el-col",{attrs:{span:21}},[a("div",{staticClass:"grid-content"},[a("el-input",{staticStyle:{width:"98%",float:"right"},attrs:{placeholder:"请输入",type:"textarea",maxlength:"120",autosize:{minRows:4},"show-word-limit":""},model:{value:t.filters.remark,callback:function(e){t.$set(t.filters,"remark",e)},expression:"filters.remark"}})],1)])],1)],1),t._v(" "),a("el-col",{staticClass:"m-b-10",attrs:{span:24}},[a("el-row",{staticClass:"rowmbottom10"},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content-left",staticStyle:{width:"88.5px",height:"1px"}})]),t._v(" "),a("el-col",{attrs:{span:21}},[a("div",{staticClass:"grid-content"},[a("el-checkbox",{staticStyle:{width:"98%",float:"right"},model:{value:t.filters.addClue,callback:function(e){t.$set(t.filters,"addClue",e)},expression:"filters.addClue"}},[t._v("同时增加一条线索")])],1)])],1)],1)],2)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"w-90 plain-btn-style",attrs:{size:"small",type:"",round:""},on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),a("el-button",{staticClass:"w-90",attrs:{size:"small",type:"primary",round:"",disabled:t.loading},on:{click:t.save}},[t._v("完成")])],1)])],1)},staticRenderFns:[]};var v=a("VU/8")(d,u,!1,function(t){a("GJHQ")},"data-v-228dfc36",null);e.a=v.exports},"3j4B":function(t,e,a){"use strict";var i=a("Dd8w"),l=a.n(i),s=a("NYxO"),o={props:["callType","phone","dialogVisible","detectTelInfo"],data:function(){return{dialogWidth:"270px",isCalling:!1,val:"",options:[{value:"1",label:"是"},{value:"0",label:"否"}],checkboxGroup1:["1","2"],radio4:"1",percentage:80,items:["内饰","外观","舒适度"],activeName:"first",input1:"",PhoneState:6,callTime:"00:00:00",hour:0,minute:0,second:0,millisecond:0,int:"",toggleMuteInCallStatus:!0,dialogVisibleIncomeCall:!1,m7CallStateDescriptionStatus:"stInvalid",showEndTime:!1,endTime:"00:00:00",userTypeText:""}},created:function(){var t=this;eventBus.$off("clearTimer"),eventBus.$on("clearTimer",function(e){console.log("clearTimer2",t.int),window.clearInterval(t.int)}),1==this.detectTelInfo.userType?this.userTypeText="集团人员":3==this.detectTelInfo.userType&&(this.isCalling=!0),eventBus.$on("objectDeclareFunc",function(e){console.log("容联_code:",e),t.m7CallStateDescriptionStatus=e,console.log(t.m7CallStateDescriptionStatus),"onDialing"==e?(console.log("正在呼叫中..."),t.PhoneState=8,t.endTime="00:00:00",t.showEndTime=!1):"EvtConnected"==e?(console.log("已接通"),t.PhoneState=9,t.int=setInterval(t.timer,1e3)):"onHangup"==e&&(t.setTimer(""),console.log("结束通话时间",t.callTime),t.showEndTime=!0,t.endTime=t.callTime,t.PhoneState=6,window.clearInterval(t.int),t.millisecond=0,t.hour=0,t.minute=0,t.second=0,t.callTime="00时00分00秒")})},mounted:function(){},methods:l()({},Object(s.c)(["setTimer"]),{call:function(){var t={tel:this.phone,dccGroupId:this.dccGroupId};window.eventBus.$emit("diaLoutBus",t)},hangUp:function(){window.clearInterval(this.int),window.localStorage.setItem("objectDeclareFunc","onHangup"),window.eventBus.$emit("hangupBus","")},timer:function(){this.second++,this.second>=60&&(this.second=0,this.minute=this.minute+1),this.minute>=60&&(this.minute=0,this.hour=this.hour+1),this.callTime=this.formatZero(this.hour)+"时"+this.formatZero(this.minute)+"分"+this.formatZero(this.second)+"秒"},formatZero:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(t).length>e?t:(Array(e).join(0)+t).slice(-e)},handleClose:function(){this.$emit("callPhoneCloseFn")},toCluesDeal:function(){this.$router.push({path:"/work/cluesDeal",query:{tel:this.phone}})}}),beforeDestroy:function(){window.clearInterval(this.int)}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",[i("el-dialog",{staticClass:"call-phone-dialog",attrs:{visible:t.dialogVisible,width:t.dialogWidth,"before-close":t.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"}),t._v(" "),i("div",{staticClass:"dialog-center call-phone-dialog-center",class:{"call-coming-time":t.isCalling}},[i("div",{staticClass:"call-phone-title"},[t._v("容联-外呼电话\n          "),i("img",{staticClass:"call-phone-close-icon",attrs:{src:a("8eEq"),alt:""},on:{click:function(e){return t.handleClose()}}})]),t._v(" "),i("div",{staticClass:"call-info"},[i("div",{staticClass:"sf"},[t._v(t._s(t.detectTelInfo.userTypeName))]),t._v(" "),i("div",{staticClass:"phone"},[t._v(t._s(t.phone))]),t._v(" "),i("div",[t._v(t._s(t.detectTelInfo.nickname)+" "+t._s(t.detectTelInfo.role))])]),t._v(" "),i("div",{staticClass:"call-event"},[8==t.PhoneState||9==t.PhoneState||t.showEndTime?t._e():i("div",{staticClass:"before-coming"},[i("div",{staticClass:"temp-rl-style"}),t._v(" "),i("div",{on:{click:function(e){return t.call()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})])]),t._v(" "),8==t.PhoneState?i("div",{staticClass:"dialing-call"},[i("div",{staticClass:"temp-rl-style waiting-style"},[t._v("等待对方接听...")]),t._v(" "),i("div",{on:{click:function(e){return t.hangUp()}}},[i("img",{attrs:{src:a("4cN8"),alt:""}})])]):t._e(),t._v(" "),9==t.PhoneState?i("div",{staticClass:"in-the-call"},[i("div",{staticClass:"temp-rl-style calling-style"},[t._v("通话中 "+t._s(t.callTime))]),t._v(" "),i("div",{staticClass:"in-coming-btns"},[i("div",{on:{click:function(e){return t.hangUp()}}},[i("img",{attrs:{src:a("4cN8"),alt:""}})])])]):t._e(),t._v(" "),t.showEndTime?i("div",{staticClass:"end-call"},[i("div",{staticClass:"temp-rl-style waiting-style"},[t._v("通话结束 "+t._s(t.endTime))]),t._v(" "),i("div",{on:{click:function(e){return t.call()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})])]):t._e(),t._v(" "),t.isCalling?i("div",{staticClass:"set-clue-btn"},[i("el-button",{staticClass:"plain-btn-style",attrs:{size:"medium",round:""},on:{click:function(e){return t.toCluesDeal()}}},[t._v("建档")])],1):t._e()])])])],1)])},staticRenderFns:[]};var c=a("VU/8")(o,n,!1,function(t){a("IIzY"),a("rovM")},"data-v-2418f716",null);e.a=c.exports},"5B5k":function(module,__webpack_exports__,__webpack_require__){"use strict";(function($){var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__("fZjL"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__=__webpack_require__("Dd8w"),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_2__AddCluesDialog__=__webpack_require__("gNHg"),__WEBPACK_IMPORTED_MODULE_3__AddArchivesDialog__=__webpack_require__("2d3c"),__WEBPACK_IMPORTED_MODULE_4__CallDialog__=__webpack_require__("XcDm"),__WEBPACK_IMPORTED_MODULE_5__CallPhoneTemp__=__webpack_require__("77Ui"),__WEBPACK_IMPORTED_MODULE_6__CallPhoneTempAli__=__webpack_require__("gBeo"),__WEBPACK_IMPORTED_MODULE_7__CallPhoneTempRL__=__webpack_require__("3j4B"),__WEBPACK_IMPORTED_MODULE_8__CallPhoneTempTR__=__webpack_require__("T8Ge"),__WEBPACK_IMPORTED_MODULE_9_vuex__=__webpack_require__("NYxO");__webpack_exports__.a={components:{AddCluesDialog:__WEBPACK_IMPORTED_MODULE_2__AddCluesDialog__.a,AddArchivesDialog:__WEBPACK_IMPORTED_MODULE_3__AddArchivesDialog__.a,CallDialog:__WEBPACK_IMPORTED_MODULE_4__CallDialog__.a,CallPhoneTemp:__WEBPACK_IMPORTED_MODULE_5__CallPhoneTemp__.a,CallPhoneTempAli:__WEBPACK_IMPORTED_MODULE_6__CallPhoneTempAli__.a,CallPhoneTempRL:__WEBPACK_IMPORTED_MODULE_7__CallPhoneTempRL__.a,CallPhoneTempTR:__WEBPACK_IMPORTED_MODULE_8__CallPhoneTempTR__.a},computed:__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},Object(__WEBPACK_IMPORTED_MODULE_9_vuex__.d)(["loginType","agentInfo","menuObj"]),{roleId:function(){return this.currentTrans&&this.currentTrans.id}}),data:function(){return{isCallDialog:!1,dialogVisible:!1,dialogVisibleClues:!1,dialogVisibleArchive:!1,dialogVisibleCallPhone:!1,codeStatusText:"",statusVisible:!1,time:"",groupName:"",groupOptions:[],val:"",options:[{value:"1",label:"是"},{value:"0",label:"否"}],phone:"",visible:!1,callType:"",stateAction:"",visibleStatus:!1,lineTel:"",smallTel:"",detectTelInfo:"",authCall:!1,transferList:[{id:"3",name:"网页接听",way:"sip"},{id:"2",name:"SIP接听",way:"gateway"},{id:"1",name:"手机接听",way:"Local"},{id:"6",name:"网页接听",way:"sip"},{id:"5",name:"SIP接听",way:"gateway"},{id:"4",name:"手机接听",way:"Local"}],timerBusy:null,currentTrans:{id:"3",name:"网页接听",way:"sip"},showOutDialogVisible:!1,showTel:!1}},created:function(){var t=this;this.checkAuthCall();var e=this.agentInfo.thirdSeat;e&&"1"==e.platformType?this.callType="RL":e&&"3"==e.platformType&&(this.callType="cticloud");var a=window.sessionStorage.getItem("c_RLtransferStatus");if(this.handleRLStatusText(a),eventBus.$on("stateAction",function(e){console.log("获取stateAction值："+e),t.stateAction=e,t.handleStatusText(e)}),!this.codeStatusText){var i=sessionStorage.getItem("watchStorage");this.codeStatusText=i&&"-1"!=i&&"0"!=i&&"1"!=i?"4"==i?"忙碌":"在线":"离线"}this.initGroup()},mounted:function(){var t=this;this.$nextTick(function(){var e=window.localStorage.getItem("c_use_tel"),a=t.agentInfo,i=(a.admin,a.thirdSeat);t.lineTel=i&&(i.tel||i.plane)||"",t.smallTel=i&&(i.telNo||i.planeNo)||"","3"==e?t.currentTrans={id:"3",name:"网页接听",way:"sip"}:"2"==e?t.currentTrans={id:"2",name:"SIP接听",way:"gateway"}:"1"==e&&(t.currentTrans={id:"1",name:"手机接听",way:"Local"}),window.localStorage.setItem("smallTel",t.smallTel)}),window.eventBus.$on("c_RLtransferStatus",function(e){t.handleRLStatusText(e)})},methods:{initGroup:function(){this.groupName=this.agentInfo.group[0]&&this.agentInfo.group[0].title,this.groupOptions=this.agentInfo.group},changeGroup:function(t){console.log(t),this.groupName=t.title},handleStatusText:function(t){"idle"==t?(console.log("在线"),this.codeStatusText="在线"):"pause"==t?(console.log("忙碌"),this.codeStatusText="忙碌"):"offline"==t&&(console.log("离线"),this.codeStatusText="离线")},handleRLStatusText:function(t){var e=this;console.log("c_RLtransferStatus",t),"1"==t?(console.log("在线"),this.codeStatusText="在线",this.showTel=!0):"2"==t?(console.log("忙碌"),this.codeStatusText="忙碌",this.showTel=!0,this.timerBusy=setInterval(function(){phone&&(clearInterval(e.timerBusy),console.log("置忙碌，不可接听电话"),phone.destroy(),window.sessionStorage.setItem("c_show_RL",!1),window.eventBus.$emit("destroyRLBus",""))},1e3)):"3"==t&&(console.log("离线"),this.codeStatusText="离线",this.showTel=!1)},checkAuthCall:function(){this.authCall=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(this.menuObj).indexOf("/call/call-record")>-1},authTips:function(){this.$notify.warning({title:"操作提示",message:"无此功能权限(无此菜单)"})},showVisible:function(){"2"==window.sessionStorage.getItem("c_RLtransferStatus")&&window.eventBus.$emit("initRLSDKBus","Local");var t=this.agentInfo,e=t.thirdSeat;t.admin;"-1"==window.sessionStorage.getItem("rlZt")?(this.visible=!1,this.$message({message:"请先在插件（企话宝）登录",type:"warning",showClose:!0})):"3"==window.sessionStorage.getItem("c_RLtransferStatus")?(this.visible=!1,this.$message({message:"当前坐席为离线状态，暂不支持拨打电话",type:"warning",showClose:!0})):!e||e.tel||e.plane?this.visible=!0:(this.visible=!1,this.$message({message:"您还未设置坐席号，无法使用电话拨打功能，请联系管理员配置。",type:"warning",showClose:!0}))},callPhone:function(){console.log(this.phone),this.getDetectTel()},addClues:function(){this.dialogVisibleClues=!0},cluesCloseFn:function(){this.dialogVisibleClues=!1},cluesSuccessFn:function(){this.cluesCloseFn(),this.$eventHub.$emit("work-invite")},addArchive:function(){this.addressDefaultData={},this.dialogVisibleArchive=!0},archiveCloseFn:function(){this.dialogVisibleArchive=!1},save:function(){},callFn:function(){this.isCallDialog=!0},callCloseFn:function(){this.isCallDialog=!1},toCallRecord:function(){this.$router.push({path:"/call/call-record",query:{}})},callPhoneCloseFn:function(){this.dialogVisibleCallPhone=!1},getDetectTel:function(){var t=this;this.$fetch.dccSeat.detectTel({tel:this.phone},!0).then(function(e){t.$handleResponse(e,function(e){console.log(e),t.detectTelInfo=e,1==t.detectTelInfo.userType&&t.detectTelInfo.dccId==t.agentInfo.admin.id?t.toCustomerFollow({id:e.intentionId,userId:e.userId}):2==t.detectTelInfo.userType&&t.detectTelInfo.dccId==t.agentInfo.admin.id?t.toCluesDeal({id:e.clueId,userId:e.userId}):(console.log("弹窗",t.detectTelInfo),t.$eventHub.$emit("showDialogRL",t.detectTelInfo))},!0),t.loading=!1}).catch(function(e){t.loading=!1,t.$store.commit("closeLoading")})},toCluesDeal:function(t){this.$router.push({path:"/work/cluesDeal",query:{id:t.id,userId:t.userId}})},toCustomerFollow:function(t){this.$router.push({path:"/work/customerFollow",query:{id:t.id,type:this.followType,userId:t.userId}})},logIn:function(){workbench.logIn()},handleLogOut:function(){this.showOutDialogVisible=!0},logOut:function(){this.callAgentState(3),"cticloud"==this.callType?this.doLogout():"alicc"==this.callType?(console.log("当前状态",window.workbench.getStatus()),workbench.logOut()):"RL"==this.callType&&phone&&(phone.destroy(),window.sessionStorage.setItem("c_show_RL",!1),window.eventBus.$emit("destroyRLBus","")),this.codeStatusText="离线",window.sessionStorage.setItem("c_RLtransferStatus","3"),this.visibleStatus=!1},ready:function(){this.callAgentState(1),"cticloud"==this.callType?"offline"==this.stateAction?this.doLogin():this.doUnpause():"alicc"==this.callType?(console.log("当前状态",window.workbench.getStatus()),"off"==window.workbench.getStatus()?(workbench.register(),this.logIn()):workbench.ready()):"RL"==this.callType&&(phone&&"2"==window.sessionStorage.getItem("c_RLtransferStatus")?(console.log("直接置闲"),phone.m7SetBusy(!1,"0")):phone&&"3"!=window.sessionStorage.getItem("c_RLtransferStatus")||(console.log("初始化"),window.eventBus.$emit("initRLSDKBus","sip"),window.eventBus.$emit("destroyRLBus",""),window.sessionStorage.setItem("c_show_RL",!0))),this.codeStatusText="在线",window.sessionStorage.setItem("c_RLtransferStatus","1"),this.showTel=!0,this.visibleStatus=!1},applyForBreak:function(){this.callAgentState(2),"cticloud"==this.callType?this.doPause():"alicc"==this.callType?(console.log("当前状态",window.workbench.getStatus()),workbench.applyForBreak(1,"临时有事")):"RL"==this.callType&&phone&&(console.log("置忙碌，不可接听电话"),phone.destroy(),window.sessionStorage.setItem("c_show_RL",!1),window.eventBus.$emit("destroyRLBus","")),this.codeStatusText="忙碌",window.sessionStorage.setItem("c_RLtransferStatus","2"),this.showTel=!0,this.visibleStatus=!1},doLogout:function(){var t={logoutMode:1,removeBinding:0};CTILink.Agent.logout(t,function(t){t.code})},doPause:function(){var t={pauseType:1,pauseDescription:"置忙"};CTILink.Agent.pause(t)},doUnpause:function(){CTILink.Agent.unpause()},transferVisibleChange:function(t){},handletransferTel:function(t){this.showTel=!0,t.id!=this.currentTrans.id&&(this.currentTrans=t,this.transferTelFn(t))},transferTelFn:function(t){"1"==t.id||"4"==t.id?(window.localStorage.setItem("c_use_tel",1),"忙碌"!=this.codeStatusText&&window.eventBus.$emit("initRLSDKBus","Local"),console.log("Local ---    私人号码-手机")):"2"==t.id||"5"==t.id?(window.localStorage.setItem("c_use_tel",2),"忙碌"!=this.codeStatusText&&window.eventBus.$emit("initRLSDKBus","gateway"),console.log("gateway ---    sip电话")):"3"!=t.id&&"6"!=t.id||(window.localStorage.setItem("c_use_tel",3),"忙碌"!=this.codeStatusText&&window.eventBus.$emit("initRLSDKBus","sip"),console.log("sip ---    软电话-网页")),phone&&phone.destroy(),window.sessionStorage.setItem("c_show_RL",!1),window.eventBus.$emit("destroyRLBus","");var e=this.agentInfo.thirdSeat;t.id>3?(this.lineTel=e&&e.plane,this.smallTel=e&&e.planeNo):(this.lineTel=e&&e.tel,this.smallTel=e&&e.telNo),window.localStorage.setItem("smallTel",this.smallTel)},handleOut:function(){"1"!=window.localStorage.getItem("c_RLtransferStatus")&&(this.callAgentState(1),window.localStorage.setItem("c_use_tel",1),window.sessionStorage.setItem("c_RLtransferStatus","1"),phone&&phone.destroy(),window.eventBus.$emit("initRLSDKBus","Local"),window.eventBus.$emit("destroyRLBus",""));var t=this.agentInfo.thirdSeat;this.lineTel=t&&(t.tel||t.plane)||"",this.smallTel=t&&(t.telNo||t.planeNo)||"",this.showOutDialogVisible=!1,this.currentTrans={id:"1",name:"手机接听",way:"Local"},this.codeStatusText="离线",window.localStorage.setItem("smallTel",this.smallTel),this.showTel=!0,this.visibleStatus=!1},handleClose:function(){this.showOutDialogVisible=!1,this.showTel=!1,this.logOut()},doLogin:function doLogin(){var bindTel=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"100002",bindType=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,departmentId="BM3000527",crmId="0001",timestamp=parseInt((new Date).getTime()/1e3),token="acfd80b3a36bec1acd79da0710684687",sign=md5(departmentId+timestamp+token),url="https://api-test-2.cticloud.cn/interface/v10/agentLogin/authenticateJsonp";url+="?validateType=1&departmentId="+departmentId+"&crmId="+crmId+"&timestamp="+timestamp+"&sign="+sign,$.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",url:url,success:function success(r){var data=eval("("+r+")");if(void 0!=data&&"0"==data.result){var params={};params.sessionKey=data.sessionKey,params.enterpriseId=data.enterpriseId,params.cno=data.cno,params.bindTel=bindTel,params.bindType=bindType,params.loginStatus=1,params.webSocketUrl=data.agentGateWayUrl,params.qids=data.qids,CTILink.Agent.login(params,function(t){0==t.code?(console.log("登录成功"),console.log(t)):console.log(t)})}},error:function(t){}})},callAgentState:function(t){var e=this;this.$fetch.dccSeat.callAgentState({state:t},!1).then(function(t){e.$handleResponse(t,function(t){},!1)}).catch(function(t){e.$store.commit("closeLoading")})}},beforeDestroy:function(){console.log("listener was closed")}}}).call(__webpack_exports__,__webpack_require__("7t+N"))},"77Ui":function(t,e,a){"use strict";a("NYxO");var i={props:["callType","phone","dialogVisible"],data:function(){return{dialogWidth:"270px",isCalling:!1,val:"",options:[{value:"1",label:"是"},{value:"0",label:"否"}],checkboxGroup1:["1","2"],radio4:"1",percentage:80,items:["内饰","外观","舒适度"],activeName:"first",input1:"",PhoneState:6,callTime:"00:00:00",hour:0,minute:0,second:0,millisecond:0,int:"",toggleMuteInCallStatus:!0,dialogVisibleIncomeCall:!1,m7CallStateDescriptionStatus:"stInvalid",showEndTime:!1,endTime:"00:00:00"}},created:function(){var t=this;console.log("callType:",this.callType," 拨打的电话：",this.phone),"byaicc"==this.callType||(eventBus.$off("getCode"),eventBus.$on("getCode",function(e){console.log("获取code值："+e),t.PhoneState=e,console.log("获取_code值",t.PhoneState),6==e?(console.log("来电中、、、"),t.dialogVisibleIncomeCall=!0):9==e?(console.log("已接通"),t.dialogWidth="300px",t.isCalling=!0,t.int=setInterval(t.timer,1e3)):5==e?(console.log("结束通话时间",t.callTime),window.clearInterval(t.int),t.millisecond=0,t.hour=0,t.minute=0,t.second=0,t.callTime="00时00分00秒",t.dialogWidth="210px",t.isCalling=!1,t.toggleMuteInCallStatus=!0,t.dialogVisibleIncomeCall=!1):3==e&&(t.dialogVisibleIncomeCall=!1)}),eventBus.$off("caller"),eventBus.$on("caller",function(t){console.log("来电号码:",t)}))},methods:{initBySDK:function(){var t=this,e=document.getElementById("phone-slot");console.log(e),e&&(window.aiccSdk=new window.AiccSdk.default({companyId:"34590",mobile:"13168766000",client_id:"9vVgN0xsBFpSuz8W",client_secret:"c2lhuHLS0Z6beCFC07lPniiDEGSR1A",phoneRenderSlot:e,contact:"17322300397",autoCallOut:!0}),window.aiccSdk.onCallStateChange(function(e){console.log(e),4==e?(t.PhoneState=9,console.log("已接通"),t.dialogWidth="300px",t.isCalling=!0,t.int=setInterval(t.timer,1e3)):5==e&&(console.log("结束通话时间",t.callTime),t.PhoneState=3,window.clearInterval(t.int),t.millisecond=0,t.hour=0,t.minute=0,t.second=0,t.callTime="00时00分00秒",t.dialogWidth="210px",t.isCalling=!1,t.toggleMuteInCallStatus=!0)}))},hangUp:function(){window.workbench.hangUp(),console.log("挂机")},answer:function(){this.PhoneState=9,this.dialogWidth="300px",window.workbench.answer(),console.log("接听电话，通过该方法可接听来电，建立通话连接。")},toggleMuteInCall:function(){window.workbench.toggleMuteInCall(),this.toggleMuteInCallStatus=!this.toggleMuteInCallStatus,console.log("静音")},timer:function(){this.second++,this.second>=60&&(this.second=0,this.minute=this.minute+1),this.minute>=60&&(this.minute=0,this.hour=this.hour+1),this.callTime=this.formatZero(this.hour)+"时"+this.formatZero(this.minute)+"分"+this.formatZero(this.second)+"秒",this.setTimer({hour:this.hour,minute:this.minute,second:this.second})},formatZero:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(t).length>e?t:(Array(e).join(0)+t).slice(-e)},handleClick:function(t,e){console.log(t,e)},handleClose:function(){this.$emit("callPhoneCloseFn")},toCluesDeal:function(){this.$router.push({path:"/work/cluesDeal",query:{}})}},beforeDestroy:function(){clearInterval(this.int),console.log("listener was closed")}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",[i("el-dialog",{staticClass:"call-phone-dialog",attrs:{visible:t.dialogVisible,width:t.dialogWidth,"before-close":t.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"}),t._v(" "),i("div",{staticClass:"dialog-center call-phone-dialog-center",class:{"call-coming-time":t.isCalling}},[i("div",{staticClass:"call-phone-title"},[t._v("外呼电话\n          "),8!=t.PhoneState&&9!=t.PhoneState?i("img",{staticClass:"call-phone-close-icon",attrs:{src:a("8eEq"),alt:""},on:{click:function(e){return t.handleClose()}}}):t._e()]),t._v(" "),i("div",{staticClass:"call-info"},[i("div",{staticClass:"sf"},[t._v("线索")]),t._v(" "),i("div",{staticClass:"phone"},[t._v(t._s(t.phone))]),t._v(" "),t.isCalling?t._e():i("div",[t._v("张松 华南项目组 销售总监")])]),t._v(" "),i("div",[i("div",{attrs:{id:"phone-slot"}}),t._v(" "),i("div",{attrs:{id:"contact-sdk"}})]),t._v(" "),i("div",[8==t.PhoneState||9==t.PhoneState||t.showEndTime?t._e():i("div",{staticClass:"before-coming"},[i("div",{staticClass:"temp-rl-style"}),t._v(" "),"alicc"==t.callType?i("div",{on:{click:function(e){return t.answer()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})]):t._e(),t._v(" "),"byaicc"==t.callType?i("div",{on:{click:function(e){return t.initBySDK()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})]):t._e()]),t._v(" "),"alicc"==t.PhoneState&&9==t.PhoneState?i("div",{staticClass:"in-the-call"},[i("div",{staticClass:"temp-rl-style calling-style"},[t._v("通话中 "+t._s(t.callTime))]),t._v(" "),i("div",{staticClass:"in-coming-btns"},[i("div",{on:{click:function(e){return t.hangUp()}}},[i("img",{attrs:{src:a("4cN8"),alt:""}})])])]):t._e(),t._v(" "),"byaicc"==t.PhoneState&&9==t.PhoneState?i("div",{staticClass:"in-the-call"},[i("div",{staticStyle:{color:"#3bdaa4"}},[t._v("通话中 "+t._s(t.callTime))]),t._v(" "),i("div",{staticClass:"in-coming-btns"},[i("div",{on:{click:function(e){return t.hangUp()}}},[i("img",{attrs:{src:a("4cN8"),alt:""}})])])]):t._e(),t._v(" "),t.showEndTime?i("div",{staticClass:"end-call"},[i("div",{staticClass:"temp-rl-style waiting-style"},[t._v("通话结束 "+t._s(t.endTime))]),t._v(" "),i("div",{on:{click:function(e){return t.answer()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})])]):t._e(),t._v(" "),t.isCalling?i("div",{staticClass:"set-clue-btn"},[i("el-button",{staticClass:"plain-btn-style",attrs:{size:"medium",round:""},on:{click:function(e){return t.toCluesDeal()}}},[t._v("建档")])],1):t._e()])])])],1)])},staticRenderFns:[]};var s=a("VU/8")(i,l,!1,function(t){a("f/9b"),a("BVzR")},"data-v-2c9649aa",null);e.a=s.exports},"7wSb":function(t,e){},"8eEq":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZCRTAwRDgzNzk0NTExRUFBQkM1Qzk5OThBMTJBNDE5IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZCRTAwRDg0Nzk0NTExRUFBQkM1Qzk5OThBMTJBNDE5Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkJFMDBEODE3OTQ1MTFFQUFCQzVDOTk5OEExMkE0MTkiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkJFMDBEODI3OTQ1MTFFQUFCQzVDOTk5OEExMkE0MTkiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5m9aP9AAAAjUlEQVR42pSSMQ6AIAxFv8SNWQ/grKfxAJ7Nk7HjzIy/piYKZaDJI6T9nwYKcs4gK/G6t5DaJvsRwEp2cpGTJPzDk4NMJDsuQcWzFrwhnlUTBmlTFKJ2gpFLr8EyoRRL4msoTSjFEg6d4RqnR6V6CNcQn0plkjtY4tQ6SDosOpRoDC59Ok2Ptvdr3AIMAIBIexKUeBfuAAAAAElFTkSuQmCC"},"8o/+":function(t,e){},BVzR:function(t,e){},BWVD:function(t,e){},D3JZ:function(t,e){},GJHQ:function(t,e){},IIzY:function(t,e){},"LKe+":function(t,e){},O0Bc:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Dd8w"),l=a.n(i),s=a("/Pc9"),o=a("5B5k"),n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"top-bar"},[a("el-row",{staticClass:"work-top-bar-component",attrs:{type:"flex"}},[a("el-col",{staticClass:"top-bar-left",attrs:{span:7}},[a("span",[t._v(t._s(t.groupName))])]),t._v(" "),a("el-col",{staticClass:"text-right top-bar-right",attrs:{span:17}},[a("ul",["group"!=t.loginType?a("li",{staticClass:"li-item pointer"},[a("div",{on:{click:t.addClues}},[a("i",{staticClass:"img-icon icon-add-clue"})])]):t._e(),t._v(" "),"group"!=t.loginType?a("li",{staticClass:"li-item pointer"},[a("div",{on:{click:t.addArchive}},[a("i",{staticClass:"img-icon icon-add-archives"})])]):t._e(),t._v(" "),t.agentInfo.thirdSeat&&(t.agentInfo.thirdSeat.tel||t.agentInfo.thirdSeat.plane)?a("li",{staticClass:"li-item pointer"},[a("el-popover",{attrs:{placement:"bottom",trigger:"click","popper-class":"li-item-phone-popover"},on:{show:function(e){return t.showVisible()}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("div",{staticClass:"li-item-phone"},[a("div",{staticClass:"li-item-phone__header"},[a("span",{staticClass:"el-dialog__title"},[t._v("呼叫号码")]),t._v(" "),a("button",{staticClass:"el-dialog__headerbtn",staticStyle:{top:"15px"},attrs:{type:"button","aria-label":"Close"}},[a("i",{staticClass:"el-dialog__close el-icon el-icon-close",on:{click:function(e){t.visible=!1}}})])]),t._v(" "),a("div",{staticClass:"li-item-phone__body"},[a("el-input",{attrs:{placeholder:"请输入号码",size:"medium"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}},[a("el-button",{attrs:{slot:"suffix",type:"primary",round:"",size:"mini"},on:{click:function(e){return t.callPhone()}},slot:"suffix"},[t._v("确定")])],1)],1)]),t._v(" "),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("i",{staticClass:"img-icon icon-tel"})])])],1):t._e(),t._v(" "),a("li",{staticClass:"li-item pointer"},[t.authCall?a("router-link",{attrs:{tag:"a",target:"_blank",to:{path:"/call/call-record",query:{state:1}}}},[a("i",{staticClass:"img-icon icon-record"})]):a("a",{attrs:{href:"javascript:;"},on:{click:t.authTips}},[a("i",{staticClass:"img-icon icon-record"})])],1),t._v(" "),t.showTel&&t.agentInfo.thirdSeat&&(t.agentInfo.thirdSeat.tel||t.agentInfo.thirdSeat.plane)?a("el-dropdown",{attrs:{trigger:"click"},on:{"visible-change":t.transferVisibleChange}},[a("div",{staticClass:"avatar-wrapper pointer li-item"},[a("span",{staticClass:"user-role"},[t._v(t._s(t.lineTel))]),t._v(" "),"sip"==t.currentTrans.way?a("i",{staticClass:"img-icon call-local"}):t._e(),t._v(" "),"gateway"==t.currentTrans.way?a("i",{staticClass:"img-icon call-gateway"}):t._e(),t._v(" "),"Local"==t.currentTrans.way?a("i",{staticClass:"img-icon call-sip"}):t._e()]),t._v(" "),"离线"!=t.codeStatusText?a("el-dropdown-menu",{staticClass:"transfer-tel-dropdown li-item",attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.transferList,function(e,i){return a("div",{key:"log"+i,on:{click:function(a){return t.handletransferTel(e)}}},[a("el-dropdown-item",{class:{"is-active":t.roleId==e.id}},["3"==e.id&&t.agentInfo.thirdSeat.tel?a("div",{staticClass:"call-item"},[a("span",{staticClass:"item-tel"},[t._v(t._s(t.agentInfo.thirdSeat.tel))]),t._v(" "),a("span",[a("i",{staticClass:"img-icon call-local"}),t._v(" "+t._s(e.name))])]):t._e(),t._v(" "),"2"==e.id&&t.agentInfo.thirdSeat.tel?a("div",{staticClass:"call-item"},[a("span",{staticClass:"item-tel"},[t._v(t._s(t.agentInfo.thirdSeat.tel))]),t._v(" "),a("span",[a("i",{staticClass:"img-icon call-gateway"}),t._v(" "+t._s(e.name))])]):t._e(),t._v(" "),"1"==e.id&&t.agentInfo.thirdSeat.tel?a("div",{staticClass:"call-item"},[a("span",{staticClass:"item-tel"},[t._v(t._s(t.agentInfo.thirdSeat.tel)+"("+t._s(t.agentInfo.admin.tel)+")")]),t._v(" "),a("span",[a("i",{staticClass:"img-icon call-sip"}),t._v(" "+t._s(e.name))])]):t._e(),t._v(" "),"6"==e.id&&t.agentInfo.thirdSeat.plane?a("div",{staticClass:"call-item"},[a("span",{staticClass:"item-tel"},[t._v(t._s(t.agentInfo.thirdSeat.plane))]),t._v(" "),a("span",[a("i",{staticClass:"img-icon call-local"}),t._v(" "+t._s(e.name))])]):t._e(),t._v(" "),"5"==e.id&&t.agentInfo.thirdSeat.plane?a("div",{staticClass:"call-item"},[a("span",{staticClass:"item-tel"},[t._v(t._s(t.agentInfo.thirdSeat.plane))]),t._v(" "),a("span",[a("i",{staticClass:"img-icon call-gateway"}),t._v(" "+t._s(e.name))])]):t._e(),t._v(" "),"4"==e.id&&t.agentInfo.thirdSeat.plane?a("div",{staticClass:"call-item"},[a("span",{staticClass:"item-tel"},[t._v(t._s(t.agentInfo.thirdSeat.plane)+"("+t._s(t.agentInfo.admin.tel)+")")]),t._v(" "),a("span",[a("i",{staticClass:"img-icon call-sip"}),t._v(" "+t._s(e.name))])]):t._e()])],1)}),0):t._e()],1):t._e(),t._v(" "),t.agentInfo.thirdSeat&&(t.agentInfo.thirdSeat.tel||t.agentInfo.thirdSeat.plane)?a("li",{staticClass:"li-item work-des"},[a("el-popover",{attrs:{placement:"bottom",width:"200","popper-class":"work-des-popover"},model:{value:t.visibleStatus,callback:function(e){t.visibleStatus=e},expression:"visibleStatus"}},[a("div",{staticClass:"work-des-pop"},[a("div",{staticClass:"pop-items",on:{click:function(e){return t.ready()}}},[a("div",{staticClass:"status status-online"},[a("i",{staticClass:"status-icon i-online"}),t._v(" 坐席在线")]),t._v(" "),a("div",{staticClass:"desc"},[a("div",[t._v("可拨打、可接听")])])]),t._v(" "),a("div",{staticClass:"pop-items",on:{click:function(e){return t.applyForBreak()}}},[a("div",{staticClass:"status status-busy"},[a("i",{staticClass:"status-icon i-busy"}),t._v(" 坐席忙碌")]),t._v(" "),a("div",{staticClass:"desc"},[a("div",[t._v("可拨打电话、但不可接听电话")])])]),t._v(" "),a("div",{staticClass:"pop-items",on:{click:function(e){return t.handleLogOut()}}},[a("div",{staticClass:"status status-off"},[a("i",{staticClass:"status-icon i-off"}),t._v(" 坐席离线")]),t._v(" "),a("div",{staticClass:"desc"},[a("div",[t._v("不可拨打，可切换离线接听")])])])]),t._v(" "),a("div",{attrs:{slot:"reference"},on:{click:function(e){t.statusVisible=!t.statusVisible}},slot:"reference"},[a("span",{class:"在线"==t.codeStatusText?"status-online":"忙碌"==t.codeStatusText?"status-busy":"status-off"},[a("i",{staticClass:"status-icon"}),t._v("\n                            坐席"+t._s(t.codeStatusText)),a("span",{attrs:{id:"rlZt"}})]),t._v(" "),a("i",{staticClass:"el-icon-arrow-down",staticStyle:{"font-size":"14px"}})])])],1):t._e()],1)])],1),t._v(" "),t.dialogVisibleClues?a("AddCluesDialog",{on:{cluesCloseFn:t.cluesCloseFn,cluesSuccessFn:t.cluesSuccessFn}}):t._e(),t._v(" "),t.dialogVisibleArchive?a("AddArchivesDialog",{on:{archiveCloseFn:t.archiveCloseFn}}):t._e(),t._v(" "),t.isCallDialog?a("CallDialog",{on:{callCloseFn:t.callCloseFn}}):t._e(),t._v(" "),t.dialogVisibleCallPhone&&"byaicc"==t.callType?a("CallPhoneTemp",{attrs:{callType:t.callType,phone:t.phone}}):t._e(),t._v(" "),"alicc"==t.callType?a("CallPhoneTempAli",{attrs:{callType:t.callType,phone:t.phone,dialogVisible:t.dialogVisibleCallPhone},on:{callPhoneCloseFn:t.callPhoneCloseFn}}):t._e(),t._v(" "),"cticloud"==t.callType?a("CallPhoneTempTR",{attrs:{phone:t.phone,dialogVisible:t.dialogVisibleCallPhone},on:{callPhoneCloseFn:t.callPhoneCloseFn}}):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"切换离线接听",visible:t.showOutDialogVisible,"close-on-click-modal":!1,width:"471px","before-close":t.handleClose},on:{"update:visible":function(e){t.showOutDialogVisible=e}}},[a("div",{staticClass:"dialog-center",staticStyle:{"text-align":"center"}},[t._v("\n            切换到“坐席离线”后，使用个人手机 "),a("b",[t._v(" "+t._s(t.agentInfo.admin&&t.agentInfo.admin.tel)+" ")]),t._v(" 接听呼入电话\n        ")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"w-90 plain-btn-style",attrs:{size:"medium",type:"",round:""},on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),a("el-button",{staticClass:"w-90",attrs:{size:"medium",type:"primary",round:""},on:{click:t.handleOut}},[t._v("确定")])],1)])],1)},staticRenderFns:[]};var c=function(t){a("VSGy"),a("8o/+")},r=a("VU/8")(o.a,n,!1,c,"data-v-a00cc61c",null).exports,d=a("/Uby"),u=a("IaGi"),v={data:function(){return{todoStat:{cluePendingTotal:0,clueOvertimeTotal:0,archivePendingTotal:0,archiveOvertimeTotal:0},followStat:{clueHandleTotal:0,clueArchiveTotal:0,inviteTotal:0,inviteArrivalTotal:0,archiveDefeatedTotal:0,orderTotal:0},callStat:{callIn:0,callOut:0,talk:0,notTalk:0,talkTime:0}}},methods:{queryStatTodo:function(){var t=this;this.$fetch.work.getStatTodo().then(function(e){t.$handleResponse(e,function(e){e&&(t.todoStat=e)},!1)}).catch(function(t){console.log(t)})},queryStatFollow:function(t){var e=this;this.$fetch.work.getStatFollow(t).then(function(t){e.$handleResponse(t,function(t){t&&(e.followStat=t)},!1)}).catch(function(t){console.log(t)})},queryStatCall:function(t){var e=this;this.$fetch.work.getStatCall(t).then(function(t){e.$handleResponse(t,function(t){t&&(e.callStat=t)},!1)}).catch(function(t){console.log(t)})}}},_={render:function(){var t=this.$createElement;return(this._self._c||t)("div")},staticRenderFns:[]},m=a("VU/8")(v,_,!1,null,null,null).exports,h={mixins:[m],data:function(){return{callDate:"day",followDate:"day"}},created:function(){this.queryStatTodo(),this.getStatFollow(),this.getStatCall()},methods:{getStatCall:function(){this.queryStatCall({scope:this.callDate})},getStatFollow:function(){this.queryStatFollow({scope:this.followDate})}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"group-manage-stat-component"},[a("el-row",{staticClass:"card-stat",attrs:{gutter:10}},[a("el-col",{attrs:{span:3}},[a("div",{staticClass:"card-item clue"},[a("i"),t._v(" "),a("span",[t._v(t._s(t.todoStat.cluePendingTotal))]),t._v(" "),a("p",[t._v("待跟进线索")])])]),t._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"card-item overtime"},[a("i"),t._v(" "),a("span",[t._v(t._s(t.todoStat.clueOvertimeTotal))]),t._v(" "),a("p",[t._v("超时线索")])])]),t._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"card-item customer"},[a("i"),t._v(" "),a("span",[t._v(t._s(t.todoStat.archivePendingTotal))]),t._v(" "),a("p",[t._v("待跟进潜客")])])]),t._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"card-item overdue"},[a("i"),t._v(" "),a("span",[t._v(t._s(t.todoStat.archiveOvertimeTotal))]),t._v(" "),a("p",[t._v("逾期跟进潜客")])])]),t._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("通话数据")]),t._v(" "),a("el-radio-group",{staticClass:"reset-radio",attrs:{size:"small"},on:{change:t.getStatCall},model:{value:t.callDate,callback:function(e){t.callDate=e},expression:"callDate"}},[a("el-radio-button",{attrs:{label:"day"}},[t._v("日")]),t._v(" "),a("el-radio-button",{attrs:{label:"month"}},[t._v("月")])],1)],1),t._v(" "),a("el-row",{staticClass:"body-wrap",attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("el-col",{staticClass:"cell"},[a("div",{staticClass:"text-center"},[a("span",[t._v(t._s(t.callStat.callIn))]),t._v(" "),a("p",[t._v("呼入数")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("div",{staticClass:"text-center"},[a("span",[t._v(t._s(t.callStat.callOut))]),t._v(" "),a("p",[t._v("呼出数")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("div",{staticClass:"text-center"},[a("span",[t._v(t._s(t.callStat.talk))]),t._v(" "),a("p",[t._v("已接通")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("div",{staticClass:"text-center"},[a("span",[t._v(t._s(t.callStat.notTalk))]),t._v(" "),a("p",[t._v("未接通")])])])],1)],1)])],1),t._v(" "),a("div",{staticClass:"follow-data card-stat"},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("跟进数据")]),t._v(" "),a("el-radio-group",{staticClass:"reset-radio",attrs:{size:"small"},on:{change:t.getStatFollow},model:{value:t.followDate,callback:function(e){t.followDate=e},expression:"followDate"}},[a("el-radio-button",{attrs:{label:"day"}},[t._v("日")]),t._v(" "),a("el-radio-button",{attrs:{label:"month"}},[t._v("月")])],1)],1),t._v(" "),a("el-row",{staticClass:"body-wrap",attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-xss"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.followStat.clueHandleTotal))]),t._v(" "),a("p",[t._v("线索数")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-jds"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.followStat.clueArchiveTotal))]),t._v(" "),a("p",[t._v("建档数")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-yys"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.followStat.inviteTotal))]),t._v(" "),a("p",[t._v("邀约数")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-dds"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.followStat.inviteArrivalTotal))]),t._v(" "),a("p",[t._v("到店数")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-cjs"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.followStat.orderTotal))]),t._v(" "),a("p",[t._v("成交数")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-zbs"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.followStat.archiveDefeatedTotal))]),t._v(" "),a("p",[t._v("战败数")])])])],1)],1)])],1)},staticRenderFns:[]};var p=a("VU/8")(h,f,!1,function(t){a("kSDW")},"data-v-36a3eb15",null).exports,g=a("Gu7T"),C=a.n(g),w=a("woOf"),b=a.n(w),T={props:{auditType:{type:String,default:""},auditId:null,dccGroupId:null},data:function(){return{dialogVisible:!0,title:"",form:{dcc:"",remark:"",level:""},dccOptions:[],levelOptions:["H","A","B","C"],auditRules:{dcc:[{required:!0,message:"请选择分配DCC",trigger:"change"}],level:[{required:!0,message:"请勾选更改意向等级",trigger:"change"}]}}},created:function(){this.initData()},methods:{initData:function(){switch(this.auditType){case"defeat":this.title="拒绝战败",this.getDccSelect();break;case"invalid":this.title="驳回无效",this.getDccSelect();break;case"level":this.title="干预变更",this.getLevelSelect()}},getLevelSelect:function(){var t=this.$parent.auditInfo,e=this.levelOptions.filter(function(e){return e!=t.newLevel});this.levelOptions=e},getDccSelect:function(){var t=this;this.$fetch.common.commonDccList({dccGroupId:this.dccGroupId},!1,!1).then(function(e){t.$handleResponse(e,function(e){t.dccOptions=e},!1)})},handleNext:function(){var t=this;this.$refs.allotForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;var a=void 0,i=t.form,l=i.level,o=i.dcc,n=i.remark,c={id:t.auditId};"level"==t.auditType?(a="changeLevel",c.level=l):(a="invalid"==t.auditType?"clueInvalidRefuse":"defeatRefuse",c.dccId=o,c.remark=n),s[a](c).then(function(e){t.$handleResponse(e,function(e){t.$message.success("操作成功");var a={};e.level&&(a.level=e.level),t.$emit("successAudit",a)},!0)})})},handleCancel:function(){this.$emit("cancelAudit")}}},k={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:t.title,visible:t.dialogVisible,width:"450px","append-to-body":"","before-close":t.handleCancel},on:{"update:visible":function(e){t.dialogVisible=e}}},["level"!=t.auditType?a("el-form",{ref:"allotForm",staticClass:"required-right",attrs:{model:t.form,rules:t.auditRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"分配DCC",prop:"dcc"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.form.dcc,callback:function(e){t.$set(t.form,"dcc",e)},expression:"form.dcc"}},t._l(t.dccOptions,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.dccName}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入","show-word-limit":"",maxlength:"120",rows:"5"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1):t._e(),t._v(" "),"level"==t.auditType?a("el-form",{ref:"allotForm",attrs:{model:t.form,rules:t.auditRules}},[a("p",{staticClass:"m-b-10"},[t._v("更改意向等级至：")]),t._v(" "),a("el-form-item",{attrs:{prop:"level"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.form.level,callback:function(e){t.$set(t.form,"level",e)},expression:"form.level"}},t._l(t.levelOptions,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}),1)],1)],1):t._e(),t._v(" "),a("div",{staticClass:"p-b-20",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",round:""},on:{click:t.handleNext}},[t._v("确定")])],1)],1)},staticRenderFns:[]},y=a("VU/8")(T,k,!1,null,null,null).exports,I=a("WgXR"),S=a("pAne"),D=a("Y1jt"),A=a("NYxO"),L={components:{AuditAllotDialog:y,CallOutTempTR:I.a,CallOutTempRL:S.a,FollowRecord:D.a},props:{auditType:{type:String,default:"defeat"},auditTotal:{type:Number,default:0},auditId:{type:Number,default:null},currentId:{type:Number,default:null},followId:{type:Number,default:null},dataType:{type:Number,default:null}},data:function(){return{title:"",loading:!1,dialogVisible:!0,dialog:{auditAllot:!1,allotById:0},comments:"",auditInfo:{dccGroupId:"",nickname:"",tel:"",grade:0,level:"",followTimes:0,gender:0,wechatNumber:"",wechatAdded:0,buyType:1,buyQuota:0,isMortgage:0,provinceName:"",cityName:"",regionName:"",intentionInfo:[],reasonDefeatId:null,reasonDefeat:"",remark:""},followList:[],followPage:{totalCount:0,page:1,pageSize:10,totalPage:1},fromTotal:0,fromAuditId:null,fromCurrentId:null,fromFollowId:null,fromDataType:null,commentArr:[],commentData:{},sdkType:"",childAllotData:{}}},created:function(){this.fromAuditId=this.auditId,this.fromCurrentId=this.currentId,this.fromFollowId=this.followId,this.fromTotal=this.auditTotal,this.fromDataType=this.dataType,this.sdkType=window.localStorage.getItem("c_callSDKTools"),this.initData()},computed:l()({},Object(A.d)(["loginType"])),methods:{initData:function(){switch(this.auditType){case"defeat":this.title="战败审核",this.getAuditDetail("defeatDetail");break;case"invalid":this.title="无效审核",this.getAuditDetail("invaildDetail");break;case"level":this.title="降级监控",this.getAuditDetail("levelDownDetail");break;case"follow":this.title="跟进点评",1==this.fromDataType?this.getAuditDetail("followArchiveDetail"):2==this.fromDataType&&this.getAuditDetail("followClueDetail")}this.getFollowRecord("init")},getAuditDetail:function(t){var e=this,a={id:this.fromAuditId};s[t](a).then(function(t){e.$handleResponse(t,function(t){e.auditInfo=b()(e.auditInfo,t)},!0)})},getFollowRecord:function(t){var e=this;"init"==t&&(this.followList=[],this.followPage.page=1);var a=this.followPage,i=a.page,l=a.pageSize,s={id:this.fromFollowId,typeId:this.fromDataType,page:i,pageSize:l};this.$fetch.common.followListByType(s,!1).then(function(t){e.$handleResponse(t,function(t){var a=t.list,i=t.page;a&&a.length>0&&(e.followList=[].concat(C()(e.followList),C()(a))),e.followPage.totalCount=i.totalCount,e.followPage.totalPage=i.totalPage},!1)}).catch(function(t){console.log(t)})},handleFollowScroll:function(){this.followPage.page>=this.followPage.totalPage||(this.followPage.page++,this.getFollowRecord())},handleReject:function(){this.dialog.allotById=this.fromAuditId,this.dialog.auditAllot=!0},handleAgree:function(){var t=this,e="defeat"==this.auditType?"defeatAgree":"clueInvalidAgree";s[e]({id:this.fromAuditId}).then(function(e){t.$handleResponse(e,function(e){e&&(t.$message.success("操作成功"),t.fromTotal--,t.initData(),t.$emit("success"))},!0)})},commentSuccess:function(){this.fromTotal--,this.initData(),this.$emit("success")},handleNext:function(){this.handleFrom("next")},handlePrev:function(){this.handleFrom("prev")},handleFrom:function(t){var e=this;if("EvtConnected"!=window.localStorage.getItem("objectDeclareFunc")&&"EvtConnected"!=window.localStorage.getItem("stateActionRL")){this.childAllotData={};var a=this.$parent.todoList,i=a.findIndex(function(t){return t.id==e.fromCurrentId});if(console.log(i,this.fromCurrentId),"next"==t){if(i==a.length-1)return void this.handleConfirm("下");this.handleSetId(a[i+1])}else{if(0==i)return void this.handleConfirm("上");this.handleSetId(a[i-1])}this.initData()}else this.$message({message:"当前正在通话，请不要离开",type:"warning",showClose:!0})},handleComment:function(t,e){this.$set(this.commentArr,t,e)},handleSetId:function(t){console.log(t);var e=t.id,a=t.intentionId,i=t.clueId,l=t.dataType,s=t.objectId;switch(this.fromCurrentId=e,this.auditType){case"defeat":this.fromDataType=1,this.fromFollowId=a,this.fromAuditId=e;break;case"invalid":this.fromDataType=2,this.fromFollowId=i,this.fromAuditId=e;break;case"level":this.fromDataType=1,this.fromFollowId=a,this.fromAuditId=e;break;case"follow":this.fromDataType=l,this.fromFollowId=s,this.fromAuditId=s}},handleConfirm:function(t){var e=this;this.$confirm("无"+t+"一条数据，是否返回工作台？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$emit("cancel")}).catch(function(){})},cancelAudit:function(){this.dialog.auditAllot=!1},successAudit:function(t){this.dialog.auditAllot=!1,this.fromTotal--,t.level&&(this.childAllotData.level=t.level),this.initData(),this.$emit("success")},handleClose:function(){"EvtConnected"!=window.localStorage.getItem("objectDeclareFunc")&&"EvtConnected"!=window.localStorage.getItem("stateActionRL")?this.$emit("cancel"):this.$message({message:"当前正在通话，请不要离开",type:"warning",showClose:!0})}}},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"audit-follow-dialog"},[a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.dialogVisible,width:"900px","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[t._v(t._s(t.title)),a("span",[t._v("("+t._s(t.fromTotal)+")")])]),t._v(" "),"manage"!=t.loginType?a("div",{staticClass:"right-call-out"},["RL"==t.sdkType?a("CallOutTempRL",{attrs:{tel:t.auditInfo.tel,dccGroupId:t.auditInfo.dccGroupId}}):t._e()],1):t._e()]),t._v(" "),a("el-row",{staticClass:"audit-follow",attrs:{type:"flex",gutter:10}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"left-user"},[a("div",{staticClass:"user-head"},[a("div",{staticClass:"flex-a-center"},[a("span",{staticClass:"nickname",attrs:{title:t.auditInfo.nickname}},[t._v(t._s(t._f("filterBlank")(t.auditInfo.nickname)))]),t._v(" "),a("span",{staticClass:"tel"},[t._v(t._s(t.auditInfo.tel))])]),t._v(" "),a("div",{staticClass:"m-t-10"},[a("label",[t._v(t._s(0!=t.auditInfo.grade&&11!=t.auditInfo.grade?t.auditInfo.grade+"分":"--"))]),t._v(" "),t.auditInfo.followTimes?a("label",[t._v("跟进"+t._s(t.auditInfo.followTimes)+"次")]):t._e(),t._v(" "),t.auditInfo.level?a("label",[t._v(t._s(t.auditInfo.level))]):t._e(),t._v(" "),t.childAllotData.level?a("span",[a("label",{staticClass:"level"},[t._v(t._s(t.childAllotData.level)+"级")])]):a("span",[t.auditInfo.oldLevel?a("label",[t._v(t._s(t.auditInfo.oldLevel)+"级")]):t._e(),t._v(" "),t.auditInfo.oldLevel?a("i",{staticClass:"m-r-5"},[t._v(" → ")]):t._e(),t._v(" "),t.auditInfo.newLevel?a("label",[t._v(t._s(t.auditInfo.newLevel)+"级")]):t._e()])]),t._v(" "),"1"==t.fromDataType&&t.fromFollowId?a("router-link",{staticClass:"all-archives",attrs:{tag:"a",target:"_blank",to:{path:"/business/potential/detail",query:{id:t.fromFollowId}}}},[t._v("\n                            全部档案\n                        ")]):t._e()],1),t._v(" "),a("ul",{staticClass:"user-details"},[a("li",{staticClass:"row-item"},[a("label",[t._v("客户姓名")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(t.auditInfo.nickname)))]),t._v(" "),a("span",[t._v(t._s(1==t.auditInfo.gender?"男":2==t.auditInfo.gender?"女":"未知"))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("手机号码")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(t.auditInfo.tel)))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("微信号")]),t._v(" "),a("span",[t._v("\n                                "+t._s(t._f("filterBlank")(t.auditInfo.wechatNumber))+"\n                                "),t.auditInfo.wechatAdded?a("i",[t._v("(已加微信)")]):t._e()])]),t._v(" "),t._l(t.auditInfo.intentionInfo,function(e,i){return t.auditInfo.intentionInfo&&t.auditInfo.intentionInfo.length>0?a("ul",{key:i},[a("li",{staticClass:"row-item"},[a("label",[t._v("归属门店"+t._s(i+1))]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.areaName)))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("意向车型"+t._s(i+1))]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.model)))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("客户来源"+t._s(i+1))]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.fromTopName)))])])]):t._e()}),t._v(" "),"invalid"==t.auditType?a("ul",[a("li",{staticClass:"row-item"},[a("label",[t._v("归属门店")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(t.auditInfo.areaName)))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("意向车型 ")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(t.auditInfo.model)))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("客户来源1")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(t.auditInfo.fromTopName)))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("客户来源2")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(t.auditInfo.fromSecondName)))])])]):t._e(),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("购车区域")]),t._v(" "),a("span",[t._v(t._s(t.auditInfo.provinceName)+"-"+t._s(t.auditInfo.cityName)+"-"+t._s(t.auditInfo.regionName))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("购车指标")]),t._v(" "),a("span",[t._v(t._s(1==t.auditInfo.buyQuota?"有":2==t.auditInfo.buyQuota?"无":"未知"))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("购车类型")]),t._v(" "),a("span",[t._v(t._s(1==t.auditInfo.buyType?"首次购车":2==t.auditInfo.buyType?"增购":3==t.auditInfo.buyType?"置换":"其他"))])]),t._v(" "),a("li",{staticClass:"row-item"},[a("label",[t._v("是否贷款")]),t._v(" "),a("span",[t._v(t._s(1==t.auditInfo.isMortgage?"是":2==t.auditInfo.buyQuota?"否":"未知"))])])],2)])]),t._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"right-follow"},["defeat"==t.auditType?a("i",{staticClass:"audit-result",class:1==t.auditInfo.reviewStatus?"defeat-agree":2==t.auditInfo.reviewStatus?"defeat-reject":""}):t._e(),t._v(" "),"invalid"==t.auditType?a("i",{staticClass:"audit-result",class:1==t.auditInfo.reviewStatus?"invalid-agree":2==t.auditInfo.reviewStatus?"invalid-reject":""}):t._e(),t._v(" "),a("div",{staticClass:"follow-head"},[t._v("跟进记录")]),t._v(" "),a("follow-record",{staticClass:"follow-form",attrs:{"record-list":t.followList,scrollEvent:!0,showCommentBtn:!0},on:{"event-scroll":t.handleFollowScroll,commentSuccess:t.commentSuccess}})],1)])],1),t._v(" "),"defeat"==t.auditType?a("div",{staticClass:"p-b-10",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handlePrev}},[t._v("上一条")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{disabled:0!=t.auditInfo.reviewStatus,round:""},on:{click:t.handleReject}},[t._v("拒绝战败")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{disabled:0!=t.auditInfo.reviewStatus,round:""},on:{click:t.handleAgree}},[t._v("同意战败")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handleNext}},[t._v("下一条")])],1):t._e(),t._v(" "),"invalid"==t.auditType?a("div",{staticClass:"p-b-10",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handlePrev}},[t._v("上一条")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{disabled:0!=t.auditInfo.reviewStatus,round:""},on:{click:t.handleReject}},[t._v("驳回无效")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{disabled:0!=t.auditInfo.reviewStatus,round:""},on:{click:t.handleAgree}},[t._v("同意无效")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handleNext}},[t._v("下一条")])],1):t._e(),t._v(" "),"level"==t.auditType?a("div",{staticClass:"p-b-10",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handlePrev}},[t._v("上一条")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{disabled:t.childAllotData.level,round:""},on:{click:t.handleReject}},[t._v("干预变更")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handleNext}},[t._v("下一条")])],1):t._e(),t._v(" "),"follow"==t.auditType?a("div",{staticClass:"p-b-10",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handlePrev}},[t._v("上一条")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handleNext}},[t._v("下一条")])],1):t._e()],1),t._v(" "),t.dialog.auditAllot?a("audit-allot-dialog",{attrs:{auditId:t.dialog.allotById,auditType:t.auditType,dccGroupId:t.auditInfo.dccGroupId},on:{cancelAudit:t.cancelAudit,successAudit:t.successAudit}}):t._e()],1)},staticRenderFns:[]};var x=a("VU/8")(L,B,!1,function(t){a("yPam")},"data-v-2fece910",null).exports,P={props:{selectData:{type:Array,default:[]},selectAll:{type:Number,default:0},auditType:{type:String,default:"defeat"}},data:function(){return{dialogVisible:!0,title:"批量战败审核",radio:"",form:{dcc:""}}},created:function(){switch(this.auditType){case"defeat":this.title="批量战败审核";break;case"invalid":this.title="批量无效审核"}},methods:{handleEnsure:function(){this.radio?this.submitBatchType():this.$alert("请勾选 “全部同意” 或者 “全部拒绝” ","提示",{confirmButtonText:"确定",callback:function(t){}})},handleCancel:function(){this.$emit("cancelBatch")},submitBatchType:function(){var t=this,e="invalid"==this.auditType?"clueInvalidBatch":"defeatBatch",a={ids:this.selectAll>0?"all":this.selectData,type:1==this.radio?"agree":"refuse"};s[e](a).then(function(e){t.$handleResponse(e,function(e){e&&(t.$message.success("操作成功"),t.$emit("successBatch"))},!0)})}}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"batch-audit-dialog",attrs:{title:t.title,visible:t.dialogVisible,width:"450px","before-close":t.handleCancel},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("p",{staticClass:"tip"},[t._v("已选"+t._s(t.selectAll>0?t.selectAll:t.selectData.length)+"条数据")]),t._v(" "),a("el-radio-group",{staticClass:"radio-group",model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[a("el-radio",{attrs:{label:1}},[t._v("全部同意")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("全部拒绝"),a("span",{staticClass:"txt"},[t._v("(默认由潜客所属DCC邀约员继续跟进)")])])],1),t._v(" "),a("div",{staticClass:"p-b-20",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"blue_font_white_bg",attrs:{round:""},on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",round:""},on:{click:t.handleEnsure}},[t._v("确定")])],1)],1)},staticRenderFns:[]};var O=a("VU/8")(P,$,!1,function(t){a("o8l0")},"data-v-348fdec7",null).exports,R={props:{item:{type:Object,default:{}}}},E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"follow-action-component"},["1"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag H"},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"2"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag H"},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"3"==t.item.followAction||"2,3"==t.item.followAction||"4"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag H"},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),a("p",[t._v("邀约门店: "+t._s(t._f("filterBlank")(t.item.metadata.areaName)))]),t._v(" "),a("p",[t._v("到店时间: "+t._s(t._f("filterBlank")(t.item.metadata.invaiteDate||t.item.metadata.inviteDate)))]),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"5"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag H"},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),t.item.metadata.defeat?a("p",[t._v("战败类型: "+t._s(t._f("filterBlank")(t.item.metadata.defeat.reasonType)))]):t._e(),t._v(" "),t.item.metadata.defeat?a("p",[t._v("战败原因: "+t._s(t._f("filterBlank")(t.item.metadata.defeat.reasonDefeat)))]):t._e(),t._v(" "),t.item.metadata.defeat?a("p",[t._v("原因描述: "+t._s(t._f("filterBlank")(t.item.metadata.defeat.remark)))]):t._e()]):t._e(),t._v(" "),"6"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag H"},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),a("p",[t._v("邀约门店: "+t._s(t._f("filterBlank")(t.item.metadata.areaName)))]),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"7"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),t.item.metadata.level?a("p",[t._v("级别变更: \n        "),a("span",{staticClass:"tag",class:t.item.metadata.level.oldLevel},[t._v(t._s(t.item.metadata.level.oldLevel)+"级")]),t._v(" "),a("i",{staticClass:"el-icon-right"}),t._v(" "),a("span",{staticClass:"tag",class:t.item.metadata.level.newLevel},[t._v(t._s(t.item.metadata.level.newLevel)+"级")])]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"8"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),t.item.metadata.review?a("p",[t._v("干预人："+t._s(t.item.metadata.review.name))]):t._e(),t._v(" "),t.item.metadata.level?a("p",[t._v("级别变更: \n        "),a("span",{staticClass:"tag",class:t.item.metadata.level.oldLevel},[t._v(t._s(t.item.metadata.level.oldLevel)+"级")]),t._v(" "),a("i",{staticClass:"el-icon-right"}),t._v(" "),a("span",{staticClass:"tag",class:t.item.metadata.level.newLevel},[t._v(t._s(t.item.metadata.level.newLevel)+"级")])]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"9"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),a("p",[t._v("邀约门店: "+t._s(t._f("filterBlank")(t.item.metadata.areaName)))]),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"10"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),t.item.metadata.review?a("p",[t._v("审批人: "+t._s(t._f("filterBlank")(t.item.metadata.review.name)))]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"11"==t.item.followAction||"12"==t.item.followAction||"13"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),a("p",[t._v("邀约门店: "+t._s(t._f("filterBlank")(t.item.metadata.areaName)))]),t._v(" "),a("p",[t._v("销售顾问: "+t._s(t._f("filterBlank")(t.item.metadata.advisorName))+"("+t._s(t._f("filterBlank")(t.item.metadata.advisorTel))+")")]),t._v(" "),t.item.metadata.visitDate?a("p",[t._v("到店时间: "+t._s(t.item.metadata.visitDate||t.item.metadata.appointmentDate))]):t._e()]):t._e(),t._v(" "),"14"==t.item.followAction||"35"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),t.item.remark?a("p",[t._v(t._s(t._f("filterBlank")(t.item.remark)))]):t._e()]):t._e(),t._v(" "),"21"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e(),t._v(" "),t.item.metadata.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=t.item.metadata.grade&&11!=t.item.metadata.grade?t.item.metadata.grade+"分":"--"))]):t._e()]):t._e(),t._v(" "),a("p",[t._v("邀约门店: "+t._s(t._f("filterBlank")(t.item.metadata.areaName)))]),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"22"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e(),t._v(" "),t.item.metadata.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=t.item.metadata.grade&&11!=t.item.metadata.grade?t.item.metadata.grade+"分":"--"))]):t._e()]):t._e(),t._v(" "),a("p",[t._v("邀约门店: "+t._s(t._f("filterBlank")(t.item.metadata.areaName)))]),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"23"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),a("p",[t._v("无效原因: "+t._s(t._f("filterBlank")(t.item.metadata.invalid.reasonInvalid)))])]):t._e(),t._v(" "),"24"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=t.item.metadata.grade&&11!=t.item.metadata.grade?t.item.metadata.grade+"分":"--"))]):t._e()]):t._e(),t._v(" "),a("p",[t._v("邀约门店: "+t._s(t._f("filterBlank")(t.item.metadata.intention.areaName)))]),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"25"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"26"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"27"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e(),t._v(" "),t.item.metadata.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=t.item.metadata.grade&&11!=t.item.metadata.grade?t.item.metadata.grade+"分":"--"))]):t._e()]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"28"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e(),t._v(" "),t.item.metadata.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=t.item.metadata.grade&&11!=t.item.metadata.grade?t.item.metadata.grade+"分":"--"))]):t._e()]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"31"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"32"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n    ")]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"33"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"34"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e()]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e(),t._v(" "),"36"==t.item.followAction||"37"==t.item.followAction?a("div",[t.item.metadata?a("p",[t._v("\n        客户名称: "+t._s(t._f("filterBlank")(t.item.metadata.customer&&t.item.metadata.customer.nickname))+"\n        "),t.item.metadata.level?a("span",{staticClass:"tag",class:t.item.metadata.level},[t._v(t._s(t.item.metadata.level)+"级")]):t._e(),t._v(" "),t.item.metadata.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=t.item.metadata.grade&&11!=t.item.metadata.grade?t.item.metadata.grade+"分":"--"))]):t._e()]):t._e(),t._v(" "),a("p",[t._v("继续跟进: "+t._s(t._f("filterBlank")(t.item.remark)))])]):t._e()])},staticRenderFns:[]};var F={components:{AuditFollowDialog:x,BatchAuditDialog:O,FollowAction:a("VU/8")(R,E,!1,function(t){a("TOVE")},"data-v-dac14a48",null).exports},data:function(){return{currentTodo:0,checkAll:!1,dataType:null,todoTabs:[{id:1,title:"战败审核",count:0},{id:2,title:"无效审核",count:0},{id:3,title:"降级监控",count:0},{id:4,title:"跟进点评",count:0}],dialog:{auditFollow:!1,auditId:null,followId:null,currentId:null,batchAudit:!1,selectAuditData:[]},checkArr:[],auditType:"defeat",auditTotal:0,todoList:[],allAuditCount:0,todoDom:null,todoPage:{totalCount:0,page:1,pageSize:20,totalPage:1}}},computed:l()({},Object(A.d)(["loginType"])),created:function(){this.initData()},mounted:function(){this.todoDom=document.querySelector(".audit-list"),this.todoDom&&this.todoDom.addEventListener("scroll",this.onTodoDomScroll,!0)},methods:{initData:function(){this.getTodoDataStat(),this.getTodoDataList("init")},handleTodoTabs:function(t){switch(this.currentTodo=t,t){case 1:this.auditType="invalid";break;case 2:this.auditType="level";break;case 3:this.auditType="follow";break;default:this.auditType="defeat"}this.getTodoDataList("init")},getTodoDataStat:function(){var t=this;s.getReviewTodoStat().then(function(e){t.$handleResponse(e,function(e){e&&(t.todoTabs[0].count=e.defeatReviewTotal,t.todoTabs[1].count=e.clueInvalidReviewTotal,t.todoTabs[2].count=e.levelDownReviewTotal,t.todoTabs[3].count=e.followReviewTotal)},!1)}).catch(function(t){console.log(t)})},getTodoDataList:function(t){var e=this,a="";switch(this.currentTodo){case 1:a="clueInvalidList";break;case 2:a="levelDownList";break;case 3:a="followReviewList";break;default:a="getDefeatList"}"init"==t&&(this.todoList=[],this.todoPage.page=1);var i=this.todoPage,l={page:i.page,pageSize:i.pageSize};s[a](l,!0).then(function(t){e.$handleResponse(t,function(t){var a=t.list,i=t.page;a&&(e.todoList=[].concat(C()(e.todoList),C()(a))),e.todoPage.totalCount=i.totalCount,e.todoPage.totalPage=i.totalPage,e.todoTabs[e.currentTodo].count=i.totalCount},!0)}).catch(function(t){e.$store.commit("closeLoading")})},handleBatch:function(){var t=this,e=this.checkArr.filter(function(t){return 1==t});this.checkAll||0!=e.length?(this.checkAll?this.dialog.allAuditCount=this.todoPage.totalCount:e.length>0&&this.checkArr.forEach(function(e,a){if(e){var i=t.todoList[a].id;t.dialog.selectAuditData.push(i)}}),this.dialog.batchAudit=!0):this.$alert("请勾选审核项","提示",{confirmButtonText:"确定",callback:function(t){}})},handleAudioDetais:function(t,e){switch(this.auditTotal=this.todoPage.totalCount,this.auditType=t,t){case"defeat":this.dataType=1,this.dialog.auditId=e.id,this.dialog.followId=e.intentionId,this.dialog.currentId=e.id;break;case"invalid":this.dataType=2,this.dialog.auditId=e.id,this.dialog.followId=e.clueId,this.dialog.currentId=e.id;break;case"level":this.dataType=1,this.dialog.auditId=e.id,this.dialog.followId=e.intentionId,this.dialog.currentId=e.id;break;case"follow":this.dataType=e.dataType,this.dialog.auditId=e.objectId,this.dialog.followId=e.objectId,this.dialog.currentId=e.id}this.dialog.auditFollow=!0},handleSuccessBatch:function(){this.dialog.batchAudit=!1,this.initData(),this.checkReset()},handleCancelBatch:function(){this.dialog.batchAudit=!1,this.checkReset()},successAuditFollow:function(){this.initData()},cancelAuditFollow:function(){this.dialog.auditFollow=!1},checkAllAudit:function(){var t=this;this.todoList.forEach(function(e,a){t.checkArr[a]=t.checkAll})},onTodoDomScroll:function(){var t=this.todoDom.scrollTop,e=this.todoDom.clientHeight,a=this.todoDom.scrollHeight;if(a>e&&t+e===a){if(this.todoPage.page>=this.todoPage.totalPage)return;this.todoPage.page++,this.getTodoDataList()}},checkReset:function(){var t=this;this.checkAll=!1,this.dialog.selectAuditData=[],this.dialog.allAuditCount=0,this.checkArr.forEach(function(e,a){t.checkArr[a]=!1})}},beforeDestroy:function(){this.todoDom&&this.todoDom.removeEventListener("scroll",this.onTodoDomScroll,!0)}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"group-manage-todo-component"},[a("div",{staticClass:"card-box"},[t._m(0),t._v(" "),a("div",{staticClass:"todo-num",class:"cook"+t.currentTodo},t._l(t.todoTabs,function(e,i){return a("div",{key:i,staticClass:"piece",class:{current:t.currentTodo==i},on:{click:function(e){return t.handleTodoTabs(i)}}},[a("span",[t._v(t._s(e.count))]),t._v(" "),a("p",[t._v(t._s(e.title))])])}),0),t._v(" "),0==t.todoList.length?a("div",{staticClass:"no-data"},[t._v("\n          暂无数据\n        ")]):t._e(),t._v(" "),(0==t.currentTodo||1==t.currentTodo)&&t.todoList.length>0?a("div",{staticClass:"audio-handle"},[a("el-checkbox",{on:{change:t.checkAllAudit},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleBatch}},[t._v("批量审核")])],1):t._e(),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.todoList.length>0,expression:"todoList.length > 0"}],staticClass:"audit-list"},[0==t.currentTodo?a("div",t._l(t.todoList,function(e,i){return a("div",{key:i,staticClass:"audio-item"},[a("el-checkbox",{model:{value:t.checkArr[i],callback:function(e){t.$set(t.checkArr,i,e)},expression:"checkArr[index]"}}),t._v(" "),a("div",{staticClass:"user-info",on:{click:function(a){return t.handleAudioDetais("defeat",e)}}},[a("p",{staticClass:"date"},[a("i",{staticClass:"el-icon-time"}),t._v("\n                          "+t._s(e.createdAt)+"\n                      ")]),t._v(" "),"manage"==t.loginType?a("p",[t._v("坐席组: "+t._s(t._f("filterBlank")(e.dccGroupName)))]):t._e(),t._v(" "),a("p",[t._v("DCC邀约员: "+t._s(t._f("filterBlank")(e.dccName)))]),t._v(" "),a("p",[t._v("\n                          客户名称: "+t._s(t._f("filterBlank")(e.nickname))+"\n                          "),e.level?a("span",{staticClass:"tag H"},[t._v(t._s(e.level)+"级")]):t._e(),t._v(" "),e.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=e.grade&&11!=e.grade?e.grade+"分":"--"))]):t._e()]),t._v(" "),a("p",[t._v("战败原因: "+t._s(t._f("filterBlank")(e.reasonDefeat)))])])],1)}),0):t._e(),t._v(" "),1==t.currentTodo?a("div",t._l(t.todoList,function(e,i){return a("div",{key:i,staticClass:"audio-item"},[a("el-checkbox",{model:{value:t.checkArr[i],callback:function(e){t.$set(t.checkArr,i,e)},expression:"checkArr[index]"}}),t._v(" "),a("div",{staticClass:"user-info",on:{click:function(a){return t.handleAudioDetais("invalid",e)}}},[a("p",{staticClass:"date"},[a("i",{staticClass:"el-icon-time"}),t._v("\n                          "+t._s(e.createdAt)+"\n                      ")]),t._v(" "),"manage"==t.loginType?a("p",[t._v("坐席组: "+t._s(t._f("filterBlank")(e.dccGroupName)))]):t._e(),t._v(" "),a("p",[t._v("DCC邀约员: "+t._s(t._f("filterBlank")(e.dccName)))]),t._v(" "),a("p",[t._v("\n                          客户名称: "+t._s(t._f("filterBlank")(e.nickname))+"\n                          "),e.level?a("span",{staticClass:"tag H"},[t._v(t._s(e.level)+"级")]):t._e(),t._v(" "),e.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=e.grade&&11!=e.grade?e.grade+"分":"--"))]):t._e()]),t._v(" "),a("p",[t._v("无效原因: "+t._s(t._f("filterBlank")(e.reasonInvalid)))])])],1)}),0):t._e(),t._v(" "),2==t.currentTodo?a("div",t._l(t.todoList,function(e,i){return a("div",{key:i,staticClass:"audio-item",on:{click:function(a){return t.handleAudioDetais("level",e)}}},[a("div",{staticClass:"user-info"},[a("p",{staticClass:"date"},[a("i",{staticClass:"el-icon-time"}),t._v("\n                          "+t._s(e.createdAt)+"\n                      ")]),t._v(" "),"manage"==t.loginType?a("p",[t._v("坐席组: "+t._s(t._f("filterBlank")(e.dccGroupName)))]):t._e(),t._v(" "),a("p",[t._v("DCC邀约员: "+t._s(t._f("filterBlank")(e.dccName)))]),t._v(" "),a("p",[t._v("\n                          客户名称: "+t._s(t._f("filterBlank")(e.nickname))+"\n                          "),e.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=e.grade&&11!=e.grade?e.grade+"分":"--"))]):t._e()]),t._v(" "),a("p",[a("span",{staticClass:"tag",class:e.oldLevel},[t._v(t._s(e.oldLevel)+"级")]),t._v(" "),a("i",{staticClass:"el-icon-right"}),t._v(" "),a("span",{staticClass:"tag",class:e.oldLevel},[t._v(t._s(e.newLevel)+"级")])])])])}),0):t._e(),t._v(" "),3==t.currentTodo?a("div",t._l(t.todoList,function(e,i){return a("div",{key:i,staticClass:"audio-item",on:{click:function(a){return t.handleAudioDetais("follow",e)}}},[a("div",{staticClass:"user-info"},[a("p",{staticClass:"date"},[a("i",{staticClass:"el-icon-time"}),t._v("\n                          "+t._s(e.createdAt)+"\n                      ")]),t._v(" "),"manage"==t.loginType?a("p",[t._v("坐席组: "+t._s(t._f("filterBlank")(e.dccGroupName)))]):t._e(),t._v(" "),a("p",[t._v("DCC邀约员: "+t._s(t._f("filterBlank")(e.followUserName)))]),t._v(" "),a("follow-action",{attrs:{item:e}})],1)])}),0):t._e()])]),t._v(" "),t.dialog.auditFollow?a("audit-follow-dialog",{attrs:{auditType:t.auditType,dataType:t.dataType,auditTotal:t.auditTotal,auditId:t.dialog.auditId,followId:t.dialog.followId,currentId:t.dialog.currentId},on:{success:t.successAuditFollow,cancel:t.cancelAuditFollow}}):t._e(),t._v(" "),t.dialog.batchAudit?a("batch-audit-dialog",{attrs:{selectData:t.dialog.selectAuditData,selectAll:t.dialog.allAuditCount,auditType:t.auditType},on:{successBatch:t.handleSuccessBatch,cancelBatch:t.handleCancelBatch}}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"head-wrap"},[e("span",[this._v("待办事项")])])}]};var N=a("VU/8")(F,M,!1,function(t){a("D3JZ")},"data-v-49cb4d13",null).exports,V={components:{TopBar:r,SearchBar:d.a,SearchCol:u.a,GroupManageStat:p,GroupManageTodo:N},computed:{countLen:function(){return function(t){return String(t).length}}},data:function(){return{monitorStat:{agentOnline:0,agentTotal:0},search:{list:[{type:"select",label:"坐席状态",currentVal:"",selectOptions:[],optionLabel:"title",optionValue:"id"},{type:"select",label:"通话状态",currentVal:"",selectOptions:[],optionLabel:"title",optionValue:"id"}],atState:0,callState:1},monitorList:[]}},created:function(){this.initData()},methods:l()({},Object(A.c)(["openLoading","closeLoading"]),{initData:function(){this.initSearch(),this.queryMonitor(),this.getMonitorNum()},initSearch:function(){this.getAgentState(),this.getCallState()},getAgentState:function(){var t=this;this.$fetch.common.agentState().then(function(e){t.$handleResponse(e,function(e){var a=t.search.atState;t.search.list[a].selectOptions=e,t.search.list[a].selectOptions.unshift({id:"",title:"全部"})})})},getCallState:function(){var t=this;this.$fetch.common.callState().then(function(e){t.$handleResponse(e,function(e){var a=t.search.callState;t.search.list[a].selectOptions=e,t.search.list[a].selectOptions.unshift({id:"",title:"全部"})})})},queryMonitor:function(){var t=this,e=this.search,a=e.list,i=e.atState,l=e.callState,o={state:a[i].currentVal,callState:a[l].currentVal};Object(s.monitorEmployeesList)(o).then(function(e){t.$handleResponse(e,function(e){e&&(t.monitorList=e)})}).catch(function(e){t.closeLoading()})},getMonitorNum:function(){var t=this;Object(s.getMonitorStat)({status:0}).then(function(e){t.$handleResponse(e,function(e){e&&(t.monitorStat=e)},!0)}).catch(function(e){t.$store.commit("closeLoading")})},clearQuery:function(){this.search&&this.search.list.forEach(function(t){t.currentVal=""}),this.queryMonitor()}})},z={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dcc-group-component"},[a("top-bar"),t._v(" "),a("div",{staticStyle:{"padding-top":"40px"}},[a("group-manage-stat"),t._v(" "),a("el-row",{attrs:{gutter:15,type:"flex"}},[a("el-col",{attrs:{span:8}},[a("group-manage-todo")],1),t._v(" "),a("el-col",{staticClass:"staff-monitor",attrs:{span:16}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("员工监控")]),t._v(" "),a("div",{staticClass:"service-num"},[a("span",[t._v("全部坐席："+t._s(t.monitorStat.agentTotal))]),t._v(" "),a("span",[t._v("今日在线："+t._s(t.monitorStat.agentOnline))])])]),t._v(" "),a("search-bar",{staticClass:"search-box search-flex",attrs:{size:"medium",needSeparate:!1},on:{find:t.queryMonitor,clear:t.clearQuery}},[a("search-col",{attrs:{info:t.search.list[t.search.atState],colWidth:7}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.callState],colWidth:7}})],1)],1),t._v(" "),a("div",{staticClass:"monitor-table"},[a("div",{staticClass:"table-head"},[a("span",[t._v("坐席监控")]),t._v(" "),a("span",[t._v("线索处理")]),t._v(" "),a("span",[t._v("潜客跟进")]),t._v(" "),a("span",[t._v("邀约计划")]),t._v(" "),a("span",[t._v("开口任务")])]),t._v(" "),a("div",{staticClass:"table-body"},[t._l(t.monitorList,function(e,i){return t.monitorList.length>0?a("div",{key:i,staticClass:"row",class:1==e.agent.callState?"free":2==e.agent.callState?"call":3==e.agent.callState?"leave":""},[a("div",{staticClass:"service-info"},[a("div",[a("p",[t._v("\n                                        "+t._s(t._f("filterBlank")(e.agent.dccName))+"\n                                        (分机: "+t._s(t._f("filterBlank")(e.agent.tel))+")\n                                    ")]),t._v(" "),a("p",[1==e.agent.state?a("i",{staticClass:"icon-online"},[t._v("在线")]):t._e(),t._v(" "),2==e.agent.state?a("i",{staticClass:"icon-busy"},[t._v("忙碌")]):t._e(),t._v(" "),3==e.agent.state?a("i",{staticClass:"icon-offline"},[t._v("离线")]):t._e(),t._v(" "),1==e.agent.callState?a("i",{staticClass:"icon-free"},[t._v("空闲")]):t._e(),t._v(" "),2==e.agent.callState?a("i",{staticClass:"icon-call"},[t._v("通话中")]):t._e(),t._v(" "),3==e.agent.callState?a("i",{staticClass:"icon-leave"},[t._v("离开")]):t._e()])]),t._v(" "),a("div",[a("p",[a("label",[t._v("通话时长: ")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.call.dialTime)))])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("外呼数")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.call.dialTotal)))])]),t._v(" "),a("p",[a("label",[t._v("已接通")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.call.callAnswer)))])])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("待处理")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.clue.wait)))])]),t._v(" "),a("p",[a("label",[t._v("已处理")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.clue.have)))])]),t._v(" "),a("p",[a("label",[t._v("超时")]),t._v(" "),a("span",{staticClass:"overtime"},[t._v(t._s(t._f("filterBlank")(e.clue.overtime)))])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("待跟进")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.intention&&e.intention.wait)))])]),t._v(" "),a("p",[a("label",[t._v("已跟进")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.intention&&e.intention.have)))])]),t._v(" "),a("p",[a("label",[t._v("逾期")]),t._v(" "),a("span",{staticClass:"pl20"},[t._v(t._s(t._f("filterBlank")(e.intention&&e.intention.overtime)))])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("邀约数")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.invite&&e.invite.total)))])]),t._v(" "),a("p",[a("label",[t._v("到店数")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.invite&&e.invite.arrival)))])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("已完成")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.openTask&&e.openTask.completed)))])]),t._v(" "),a("p",[a("label",[t._v("未完成")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.openTask.undone)))])])])]):t._e()}),t._v(" "),0==t.monitorList.length?a("div",{staticClass:"no-data"},[t._v("\n                            暂无数据\n                        ")]):t._e()],2)])])],1)],1)],1)},staticRenderFns:[]};var U=a("VU/8")(V,z,!1,function(t){a("BWVD")},"data-v-b167fc36",null).exports,j=a("//Fk"),G=a.n(j),W=a("kZ4T"),q=a("PJh5"),Y=a.n(q),Q=a("oFuF"),H=a("3j4B"),Z=a("T8Ge"),K={mixins:[m],components:{TopBar:r,TabsScrm:W.a,CallPhoneTempRL:H.a,CallPhoneTempTR:Z.a},data:function(){return{followDate:"day",clueSort:"2",clueOptions:[{label:"下发时间正序",value:"2"},{label:"下发时间倒序",value:"3"},{label:"高分线索优先",value:"1"}],clueList:[],followTabStyle:{customColor:"inherit",height:"5px"},followTabs:[{name:"0",title:"逾期跟进",count:0},{name:"1",title:"今日待跟进",count:0},{name:"2",title:"明日待跟进",count:0},{name:"3",title:"后日待跟进",count:0}],followType:"0",followList:[],tabStyle:{customColor:"inherit",line:"bottom"},shopTabs:[{name:"0",title:"未到店",count:0},{name:"1",title:"已到店",count:0}],shopTotal:0,shopList:[],shopType:"0",listHeight:"345px",cluePage:{totalCount:0,page:1,pageSize:20,totalPage:1},followPage:{totalCount:0,page:1,pageSize:40,totalPage:1},shopPage:{totalCount:0,page:1,pageSize:20,totalPage:1},clueDom:null,followDom:null,shopDom:null,initTimer:null,lockTimer:null,qiankeQuery:{overtime:1},dialogVisibleCallPhone:!1,phone:"",callType:"",detectTelInfo:"",time:"",flag:!0}},computed:l()({},Object(A.d)(["loginType","agentInfo"]),{countLen:function(){return function(t){return String(t).length}}}),mounted:function(){var t=this;window.addEventListener("resize",this.onWindowResize,!0),this.clueDom=document.querySelector(".clue-list"),this.clueDom&&this.clueDom.addEventListener("scroll",this.onClueDomScroll,!0),this.followDom=document.querySelector(".follow-panel"),this.followDom&&this.followDom.addEventListener("scroll",this.onFollowDomScroll,!0),this.shopDom=document.querySelector(".shop-list"),this.shopDom&&this.shopDom.addEventListener("scroll",this.onShopDomScroll,!0),this.$eventHub.$on("work-invite",function(){t.initData("init")})},created:function(){this.onWindowResize(),this.initData("init"),this.intervalQuery(),this.agentInfo.thirdSeat&&"1"==this.agentInfo.thirdSeat.platformType?this.callType="RL":this.agentInfo.thirdSeat&&"3"==this.agentInfo.thirdSeat.platformType&&(this.callType="cticloud")},methods:{initData:function(t){var e=this;G.a.all([this.$fetch.work.getStatTodo(),this.$fetch.work.getStatFollow(this.getParams("statFollow")),this.$fetch.work.getStatCall(),this.$fetch.work.getCluePending(this.getParams("cluePending","init")),this.$fetch.work.getIntentionStat(),this.$fetch.work.getIntentionList(this.getParams("intentionList","init")),this.$fetch.work.getInviteStat(),this.$fetch.work.getTodayList(this.getParams("inviteList","init"))]).then(function(a){if(a[0]){var i=a[0].data,l=i.code,s=i.data;200==l&&(e.todoStat=s)}if(a[1]){var o=a[1].data,n=o.code,c=o.data;200==n&&(e.followStat=c)}if(a[2]){var r=a[2].data,d=r.code,u=r.data;200==d&&(e.callStat=u)}if(a[3]){var v=a[3].data,_=v.code,m=v.data;200==_&&e.listDataMerge(m,"clueList","cluePage","id")}if(a[4]){var h=a[4].data,f=h.code,p=h.data;200==f&&p&&(e.followTabs[0].count=p.overtimeTotal,e.followTabs[1].count=p.dayTotal1,e.followTabs[2].count=p.dayTotal2,e.followTabs[3].count=p.dayTotal3)}if(a[5]){var g=a[5].data,C=g.code,w=g.data;200==C&&e.listDataMerge(w,"followList","followPage","id")}if(a[6]){var b=a[6].data,T=b.code,k=b.data;200==T&&k&&(e.shopTotal=k.todayInviteExpectTotal,e.shopTabs[0].count=k.todayInviteNoArrivalTotal,e.shopTabs[1].count=k.todayInviteArriveTotal)}if(a[7]){var y=a[7].data,I=y.code,S=y.data;200==I&&e.listDataMerge(S,"shopList","shopPage","id")}t||e.intervalQuery()})},intervalQuery:function(){console.log(this.flag),this.flag&&(this.initTimer=setTimeout(this.initData,5e3))},getParams:function(t,e){if("statFollow"==t)return{scope:this.followDate};if("cluePending"==t){var a=this.cluePage,i=a.page,l=a.pageSize;return{sort:this.clueSort,page:e?1:i,pageSize:l}}if("intentionList"==t){var s=this.followPage,o=s.page,n=s.pageSize,c={page:e?1:o,pageSize:n};switch(this.followType){case"0":c.sort=1,c.overtime="yes";break;case"1":c.sort=2,c.nextFollowDateStartTime=Y()(new Date).format("YYYY-MM-DD 00:00:00"),c.nextFollowDateEndTime=Y()(new Date).format("YYYY-MM-DD 23:59:59");break;case"2":c.sort=2,c.nextFollowDateStartTime=Y()().add(1,"days").format("YYYY-MM-DD 00:00:00"),c.nextFollowDateEndTime=Y()().add(1,"days").format("YYYY-MM-DD 23:59:59");break;case"3":c.sort=2,c.nextFollowDateStartTime=Y()().add(2,"days").format("YYYY-MM-DD 00:00:00"),c.nextFollowDateEndTime=Y()().add(2,"days").format("YYYY-MM-DD 23:59:59")}return c}if("inviteList"==t){var r=this.shopPage,d=r.page,u=r.pageSize,v=Y()(new Date).format("YYYY-MM-DD"),_={page:e?1:d,pageSize:u};switch(this.shopType){case"0":_.appointmentDateStartTime=v+" 00:00:00",_.appointmentDateEndTime=v+" 23:59:59",_.status=[0,3],_.sort=1;break;case"1":_.visitDateStartTime=v+" 00:00:00",_.visitDateEndTime=v+" 23:59:59",_.sort=2,_.status=[1,2]}return _}},listDataMerge:function(t,e,a,i,l){var s=t.list,o=t.page;if(s.length>0){var n=[].concat(C()(this[e]),C()(s));this[e]=Object(Q.d)(n,i)}this[a].totalCount=o.totalCount,this[a].totalPage=o.totalPage},getStatFollow:function(){this.queryStatFollow(this.getParams("statFollow"))},getCluePending:function(t){var e=this;this.lockFlag(),"init"==t&&(this.clueList=[],this.cluePage.page=1),s.getCluePending(this.getParams("cluePending"),!0).then(function(t){e.$handleResponse(t,function(t){e.listDataMerge(t,"clueList","cluePage","id")},!0)}).catch(function(t){console.log(t)})},getFollowStat:function(){var t=this;s.getIntentionStat().then(function(e){t.$handleResponse(e,function(e){e&&(t.followTabs[0].count=e.overtimeTotal,t.followTabs[1].count=e.dayTotal1,t.followTabs[2].count=e.dayTotal2,t.followTabs[3].count=e.dayTotal3)},!1)}).catch(function(t){console.log(t)})},getFollowList:function(t){var e=this;this.lockFlag(),"init"==t&&(this.followList=[],this.followPage.page=1),s.getIntentionList(this.getParams("intentionList"),!0).then(function(t){e.$handleResponse(t,function(t){e.listDataMerge(t,"followList","followPage","id")},!0)}).catch(function(t){console.log(t)})},getToShopList:function(t){var e=this;this.lockFlag(),"init"==t&&(this.shopList=[],this.shopPage.page=1),s.getTodayList(this.getParams("inviteList"),!0).then(function(t){e.$handleResponse(t,function(t){e.listDataMerge(t,"shopList","shopPage","id")},!0)}).catch(function(t){console.log(t)})},getToShopStat:function(){var t=this;s.getInviteStat().then(function(e){t.$handleResponse(e,function(e){e&&(t.shopTotal=e.todayInviteExpectTotal,t.shopTabs[0].count=e.todayInviteNoArrivalTotal,t.shopTabs[1].count=e.todayInviteArriveTotal)},!1)}).catch(function(t){console.log(t)})},onClueDomScroll:function(){var t=this.clueDom.scrollTop,e=this.clueDom.clientHeight,a=this.clueDom.scrollHeight;if(a>e&&t+e===a){if(this.cluePage.page>=this.cluePage.totalPage)return;this.cluePage.page++,this.getCluePending()}},onFollowDomScroll:function(){var t=this.followDom.scrollTop,e=this.followDom.clientHeight,a=this.followDom.scrollHeight;if(a>e&&t+e===a){if(this.followPage.page>=this.followPage.totalPage)return;this.followPage.page++,this.getFollowList()}},onShopDomScroll:function(){var t=this.shopDom.scrollTop,e=this.shopDom.clientHeight,a=this.shopDom.scrollHeight;if(a>e&&t+e===a){if(this.shopPage.page>=this.shopPage.totalPage)return;this.shopPage.page++,this.getToShopList()}},toCluesDeal:function(t){t.intentionId&&t.intentionId>0?this.$router.push({path:"/work/customerFollow",query:{back:!0,id:t.intentionId,userId:t.userId}}):this.$router.push({path:"/work/cluesDeal",query:{back:!0,total:this.cluePage.totalCount,id:t.id,userId:t.userId,sort:this.clueSort}})},toCustomerFollow:function(t){this.$router.push({path:"/work/customerFollow",query:{back:!0,id:t.id,total:this.followTabs[parseInt(this.followType)].count,type:this.followType,userId:t.userId}})},lockFlag:function(){var t=this;this.flag=!1,this.initTimer&&clearTimeout(this.initTimer),this.lockTimer&&clearTimeout(this.lockTimer),this.lockTimer=setTimeout(function(){t.flag=!0,t.intervalQuery()},6e3)},handleFollowTabs:function(t){switch(t){case"0":this.qiankeQuery={overtime:1};break;case"1":this.qiankeQuery={follow_day:1};break;case"2":this.qiankeQuery={follow_day:2};break;case"3":this.qiankeQuery={follow_day:3}}this.followType=t,this.followList=[],this.getFollowList("init")},handleShopTabs:function(t){this.shopType=t,this.shopList=[],this.getToShopList("init")},onWindowResize:function(){var t=window.innerHeight;this.listHeight=t-310+"px"},callPhoneCloseFn:function(){this.dialogVisibleCallPhone=!1},getDetectTel:function(t){var e=this;if("-1"!=window.sessionStorage.getItem("rlZt"))if("3"!=window.sessionStorage.getItem("c_RLtransferStatus")){var a=this.agentInfo.thirdSeat;!a||a.tel||a.plane?(this.phone=t,this.$fetch.dccSeat.detectTel({tel:t},!0).then(function(t){e.$handleResponse(t,function(t){e.detectTelInfo=t,1==e.detectTelInfo.userType?e.toCustomerFollow({id:t.intentionId,userId:t.userId}):2==e.detectTelInfo.userType?e.toCluesDeal({id:t.clueId,userId:t.userId}):(console.log("弹窗",e.detectTelInfo),e.$eventHub.$emit("showDialogRL",e.detectTelInfo))},!0),e.loading=!1}).catch(function(t){e.loading=!1,e.$store.commit("closeLoading")})):this.$message({message:"您还未设置坐席号，无法使用电话拨打功能，请联系管理员配置。",type:"warning",showClose:!0})}else this.$message({message:"当前坐席为离线状态，暂不支持拨打电话",type:"warning",showClose:!0});else this.$message({message:"请先在插件（企话宝）登录",type:"warning",showClose:!0})}},beforeDestroy:function(){window.removeEventListener("resize",this.onWindowResize,!0),this.clueDom&&this.clueDom.removeEventListener("scroll",this.onClueDomScroll,!0),this.followDom&&this.followDom.removeEventListener("scroll",this.onFollowDomScroll,!0),this.shopDom&&this.shopDom.removeEventListener("scroll",this.onShopDomScroll,!0),clearTimeout(this.initTimer),clearTimeout(this.lockTimer),this.$eventHub.$off("work-invite")}},J={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dcc-invite-component"},[a("top-bar"),t._v(" "),a("div",{staticClass:"dcc-invite-content"},[a("el-row",{staticClass:"card-stat",attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("待办事项")])]),t._v(" "),a("el-row",{staticClass:"body-wrap",attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-clue"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.countLen(t.todoStat.cluePendingTotal)>4?"999+":t.todoStat.cluePendingTotal))]),t._v(" "),a("p",[t._v("待处理线索")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-overtime"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.countLen(t.todoStat.clueOvertimeTotal)>4?"999+":t.todoStat.clueOvertimeTotal))]),t._v(" "),a("p",[t._v("超时线索")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-customer"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.countLen(t.todoStat.archivePendingTotal)>4?"999+":t.todoStat.archivePendingTotal))]),t._v(" "),a("p",[t._v("待跟进潜客")])])]),t._v(" "),a("el-col",{staticClass:"cell"},[a("i",{staticClass:"icon-overdue"}),t._v(" "),a("div",[a("span",[t._v(t._s(t.countLen(t.todoStat.archiveOvertimeTotal)>4?"999+":t.todoStat.archiveOvertimeTotal))]),t._v(" "),a("p",[t._v("逾期跟进潜客")])])])],1)],1)]),t._v(" "),a("el-col",{attrs:{span:7}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("跟进数据")]),t._v(" "),a("el-radio-group",{staticClass:"reset-radio",attrs:{size:"small"},on:{change:t.getStatFollow},model:{value:t.followDate,callback:function(e){t.followDate=e},expression:"followDate"}},[a("el-radio-button",{attrs:{label:"day"}},[t._v("日")]),t._v(" "),a("el-radio-button",{attrs:{label:"month"}},[t._v("月")])],1)],1),t._v(" "),a("el-row",{staticClass:"body-wrap",attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("el-col",[a("span",[t._v(t._s(t.countLen(t.followStat.clueHandleTotal)>4?"999+":t.followStat.clueHandleTotal))]),t._v(" "),a("p",[t._v("线索数")])]),t._v(" "),a("el-col",[a("span",[t._v(t._s(t.countLen(t.followStat.clueArchiveTotal)>4?"999+":t.followStat.clueArchiveTotal))]),t._v(" "),a("p",[t._v("建档数")])]),t._v(" "),a("el-col",[a("span",[t._v(t._s(t.countLen(t.followStat.inviteTotal)>4?"999+":t.followStat.inviteTotal))]),t._v(" "),a("p",[t._v("邀约数")])]),t._v(" "),a("el-col",[a("span",[t._v(t._s(t.countLen(t.followStat.inviteArrivalTotal)>4?"999+":t.followStat.inviteArrivalTotal))]),t._v(" "),a("p",[t._v("到店数")])]),t._v(" "),a("el-col",[a("span",[t._v(t._s(t.countLen(t.followStat.archiveDefeatedTotal)>4?"999+":t.followStat.archiveDefeatedTotal))]),t._v(" "),a("p",[t._v("战败数")])])],1)],1)]),t._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("通话数据")]),t._v(" "),a("div",{staticClass:"duration"},[t._v("通话时长："),a("span",[t._v(t._s(t.callStat.talkTime))])])]),t._v(" "),a("el-row",{staticClass:"body-wrap",attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("el-col",[a("span",[t._v(t._s(t.countLen(t.callStat.callIn)>4?"999+":t.callStat.callIn))]),t._v(" "),a("p",[t._v("呼入数")])]),t._v(" "),a("el-col",[a("span",[t._v(t._s(t.countLen(t.callStat.callOut)>4?"999+":t.callStat.callOut))]),t._v(" "),a("p",[t._v("呼出数")])]),t._v(" "),a("el-col",[a("span",[t._v(t._s(t.countLen(t.callStat.talk)>4?"999+":t.callStat.talk))]),t._v(" "),a("p",[t._v("已接通")])]),t._v(" "),a("el-col",[a("span",[t._v(t._s(t.countLen(t.callStat.notTalk)>4?"999+":t.callStat.notTalk))]),t._v(" "),a("p",[t._v("未接通")])])],1)],1)])],1),t._v(" "),a("el-row",{staticClass:"card-list",style:{height:t.listHeight},attrs:{gutter:10}},[a("el-col",{staticClass:"todo-clue",attrs:{span:5}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("待处理线索("+t._s(t.cluePage.totalCount)+")")]),t._v(" "),a("router-link",{attrs:{tag:"a",target:"_blank",to:{path:"/business/clue",query:{state:1}}}},[t._v("查看全部")])],1),t._v(" "),a("div",{staticClass:"clue-panel"},[a("div",{staticClass:"sort-box"},[a("a",{staticClass:"left-sort",attrs:{href:"javascript:;"}},[a("i",{staticClass:"el-icon-sort"})]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){return t.getCluePending("init")}},model:{value:t.clueSort,callback:function(e){t.clueSort=e},expression:"clueSort"}},t._l(t.clueOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"clue-list"},[t._l(t.clueList,function(e,i){return t.clueList.length>0?a("div",{key:i,staticClass:"clue-item",on:{click:function(a){return t.toCluesDeal(e)}}},[a("div",{staticClass:"user-info"},[a("span",{staticClass:"nickname",attrs:{title:e.nickname}},[t._v(t._s(e.nickname))]),t._v(" "),a("span",[t._v(t._s(e.tel))])]),t._v(" "),a("div",{staticClass:"flex-center-between"},[a("div",[e.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=e.grade&&11!=e.grade?e.grade+"分":"--"))]):t._e(),t._v(" "),e.fromSecondName||e.fromTopName?a("span",{staticClass:"tag source"},[t._v(t._s(e.fromSecondName||e.fromTopName))]):t._e(),t._v(" "),e.clueTypeName?a("span",{staticClass:"tag clue"},[t._v(t._s(e.clueTypeName))]):t._e(),t._v(" "),3==e.momentStatus?a("span",{staticClass:"tag follow"},[t._v(t._s(e.momentStatusName))]):t._e()]),t._v(" "),a("div",{staticClass:"time"},[t._v("\n                                        "+t._s(e.followDate)+"\n                                    ")])]),t._v(" "),1==e.momentStatus&&1!=e.clueType?a("span",{staticClass:"pos-state"},[t._v("\n                                    即将超时\n                                ")]):t._e(),t._v(" "),2==e.momentStatus&&1!=e.clueType?a("span",{staticClass:"pos-state err"},[t._v("\n                                    超时\n                                ")]):t._e()]):t._e()}),t._v(" "),0==t.clueList.length?a("div",{staticClass:"no-data"},[t._v("\n                                暂无数据\n                            ")]):t._e()],2)])])]),t._v(" "),a("el-col",{staticClass:"follow-task",attrs:{span:14}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"pos-rel"},[a("tabs-scrm",{attrs:{tabs:t.followTabs,tabStyle:t.followTabStyle},on:{change:t.handleFollowTabs}}),t._v(" "),a("router-link",{attrs:{tag:"a",target:"_blank",to:{path:"/business/potential",query:t.qiankeQuery}}},[t._v("查看全部")])],1),t._v(" "),a("div",{staticClass:"follow-panel"},[t.followList.length>0?a("el-row",{staticClass:"follow-list",attrs:{type:"flex",gutter:10}},t._l(t.followList,function(e,i){return a("el-col",{key:i,staticClass:"m-t-5 m-b-5",attrs:{span:6}},[a("div",{staticClass:"follow-item",on:{click:function(a){return t.toCustomerFollow(e)}}},[a("div",{staticClass:"user-info"},[a("span",{staticClass:"nickname",attrs:{title:e.nickname}},[t._v(t._s(e.nickname))]),t._v(" "),1==e.wechatAdded?a("i",{staticClass:"wechat",attrs:{"data-wechat":e.wechatNumber}}):t._e()]),t._v(" "),a("p",{staticClass:"tel"},[t._v(t._s(e.tel))]),t._v(" "),a("div",[e.level?a("span",{staticClass:"tag score",class:e.level},[t._v(t._s(e.level)+"级")]):t._e(),t._v(" "),e.grade?a("span",{staticClass:"tag score"},[t._v(t._s(0!=e.grade&&11!=e.grade?e.grade+"分":"--"))]):t._e(),t._v(" "),e.followTimes?a("span",{staticClass:"tag follow"},[t._v("跟进"+t._s(e.followTimes)+"次")]):t._e(),t._v(" "),e.momentTag?a("span",{staticClass:"tag recycle"},[t._v(t._s(e.momentTag))]):t._e()])])])}),1):t._e(),t._v(" "),0==t.followList.length?a("div",{staticClass:"no-data"},[t._v("暂无数据")]):t._e()],1)])]),t._v(" "),a("el-col",{staticClass:"today-shop",attrs:{span:5}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("今日预计到店("+t._s(t.shopTotal)+")")]),t._v(" "),a("router-link",{attrs:{tag:"a",target:"_blank",to:{path:"/business/invite",query:{state:t.shopType}}}},[t._v("查看全部")])],1),t._v(" "),a("tabs-scrm",{attrs:{tabs:t.shopTabs,tabStyle:t.tabStyle},on:{change:t.handleShopTabs}}),t._v(" "),a("div",{staticClass:"shop-list"},[t._l(t.shopList,function(e,i){return t.shopList.length>0?a("div",{key:i,staticClass:"shop-item"},["1"==t.shopType&&1==e.status?a("span",{staticClass:"pos-state"},[t._v("已登记")]):t._e(),t._v(" "),"1"!=t.shopType||2!=e.status&&3!=e.status?t._e():a("span",{staticClass:"pos-state win"},[t._v("未登记")]),t._v(" "),a("div",{staticClass:"row"},[a("div",[a("span",{staticClass:"nickname",attrs:{title:e.nickname}},[t._v(t._s(t._f("filterBlank")(e.nickname)))]),t._v(" "),e.level?a("label",{staticClass:"tag score",class:e.level},[t._v(t._s(e.level)+"级")]):t._e()]),t._v(" "),a("span",[t._v(t._s(e.tel))])]),t._v(" "),a("div",{staticClass:"row"},[a("span",[t._v(t._s("0"==t.shopType?"预计到店时间":"实际到店时间"))]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")("0"==t.shopType?e.appointmentDate:e.visitDate)))])]),t._v(" "),a("div",{staticClass:"row"},[a("span",[t._v("归属门店")]),t._v(" "),a("span",[t._v(t._s(e.areaName||"--"))])]),t._v(" "),a("div",{staticClass:"row"},[a("span",[t._v("销售顾问")]),t._v(" "),a("span",[t._v(t._s(e.advisorName||"--"))])]),t._v(" "),a("div",{staticClass:"row"},[a("span",[t._v("销售顾问手机号")]),t._v(" "),a("div",[a("span",[t._v(t._s(e.advisorTel||"--"))]),t._v(" "),e.advisorTel?a("i",{staticClass:"icon-tel",on:{click:function(a){return t.getDetectTel(e.advisorTel)}}}):t._e()])])]):t._e()}),t._v(" "),0==t.shopList.length?a("div",{staticClass:"no-data"},[t._v("暂无数据")]):t._e()],2)],1)])],1)],1)],1)},staticRenderFns:[]};var X={components:{TopBar:r,GroupManageStat:p,GroupManageTodo:N},computed:{countLen:function(){return function(t){return String(t).length}}},data:function(){return{monitorStat:{agentOnline:0,agentTotal:0},monitorList:[]}},created:function(){this.initData()},methods:{initData:function(){this.queryMonitor(),this.getMonitorNum()},queryMonitor:function(){var t=this;Object(s.groupMonitorList)().then(function(e){t.$handleResponse(e,function(e){e&&(t.monitorList=e)},!0)})},getMonitorNum:function(){var t=this;Object(s.getMonitorStat)({status:0}).then(function(e){t.$handleResponse(e,function(e){e&&(t.monitorStat=e)},!0)})}}},tt={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dcc-manage-component"},[a("group-manage-stat"),t._v(" "),a("el-row",{attrs:{gutter:10,type:"flex"}},[a("el-col",{attrs:{span:7}},[a("group-manage-todo")],1),t._v(" "),a("el-col",{staticClass:"staff-monitor",attrs:{span:17}},[a("div",{staticClass:"card-box"},[a("div",{staticClass:"head-wrap"},[a("span",[t._v("员工监控")]),t._v(" "),a("div",{staticClass:"service-num"},[a("span",[t._v("全部坐席："+t._s(t.monitorStat.agentTotal))]),t._v(" "),a("span",[t._v("今日在线："+t._s(t.monitorStat.agentOnline))])])])]),t._v(" "),a("div",{staticClass:"monitor-table m-t-10"},[a("div",{staticClass:"table-head"},[a("span",[t._v("坐席监控")]),t._v(" "),a("span",[t._v("线索处理")]),t._v(" "),a("span",[t._v("潜客跟进")]),t._v(" "),a("span",[t._v("邀约计划")]),t._v(" "),a("span",[t._v("开口任务")])]),t._v(" "),a("div",{staticClass:"table-body"},[t._l(t.monitorList,function(e,i){return t.monitorList.length>0?a("div",{key:i,staticClass:"row",class:1==e.agent.callState?"free":2==e.agent.callState?"call":3==e.agent.callState?"leave":""},[a("div",{staticClass:"service-info"},[a("div",[t._v(t._s(t._f("filterBlank")(e.agent&&e.agent.dccGroupName)))]),t._v(" "),a("div",[a("p",[a("label",[t._v("通话时长: ")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.call&&e.call.dialTime)))])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("外呼数")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.call&&e.call.dialTotal)))])]),t._v(" "),a("p",[a("label",[t._v("已接通")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.call&&e.call.callAnswer)))])])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("待处理")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.clue&&e.clue.wait)))])]),t._v(" "),a("p",[a("label",[t._v("已处理")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.clue&&e.clue.have)))])]),t._v(" "),a("p",[a("label",[t._v("超时")]),t._v(" "),a("span",{staticClass:"overtime"},[t._v(t._s(t._f("filterBlank")(e.clue&&e.clue.overtime)))])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("待跟进")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.intention&&e.intention.wait)))])]),t._v(" "),a("p",[a("label",[t._v("已跟进")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.intention&&e.intention.have)))])]),t._v(" "),a("p",[a("label",[t._v("逾期")]),t._v(" "),a("span",{staticClass:"pl20"},[t._v(t._s(t._f("filterBlank")(e.intention&&e.intention.overtime)))])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("邀约数")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.invite&&e.invite.total)))])]),t._v(" "),a("p",[a("label",[t._v("到店数")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.invite&&e.invite.arrival)))])])]),t._v(" "),a("div",[a("p",[a("label",[t._v("已完成")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.openTask&&e.openTask.completed)))])]),t._v(" "),a("p",[a("label",[t._v("未完成")]),t._v(" "),a("span",[t._v(t._s(t._f("filterBlank")(e.openTask&&e.openTask.undone)))])])])]):t._e()}),t._v(" "),0==t.monitorList.length?a("div",{staticClass:"no-data"},[t._v("\n                        暂无数据\n                    ")]):t._e()],2)])])],1)],1)},staticRenderFns:[]};var et={components:{DccGroup:U,DccInvite:a("VU/8")(K,J,!1,function(t){a("vDyI")},"data-v-1e2ee4bc",null).exports,DccManage:a("VU/8")(X,tt,!1,function(t){a("X7u6")},"data-v-29e34dba",null).exports},computed:l()({},Object(A.d)(["loginType"]))},at={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"web-work"},["invite"==t.loginType?a("dcc-invite"):t._e(),t._v(" "),"group"==t.loginType?a("dcc-group"):t._e(),t._v(" "),"manage"==t.loginType?a("dcc-manage"):t._e()],1)},staticRenderFns:[]};var it=a("VU/8")(et,at,!1,function(t){a("l9jf")},"data-v-26a328d3",null);e.default=it.exports},T8Ge:function(t,e,a){"use strict";var i=a("Dd8w"),l=a.n(i),s=a("NYxO"),o={props:["callType","phone","dialogVisible"],data:function(){return{dialogWidth:"270px",isCalling:!1,val:"",options:[{value:"1",label:"是"},{value:"0",label:"否"}],checkboxGroup1:["1","2"],radio4:"1",percentage:80,items:["内饰","外观","舒适度"],activeName:"first",input1:"",PhoneState:6,callTime:"00:00:00",hour:0,minute:0,second:0,millisecond:0,int:"",toggleMuteInCallStatus:!0,dialogVisibleIncomeCall:!1,m7CallStateDescriptionStatus:"stInvalid",showEndTime:!1,endTime:"00:00:00"}},created:function(){var t=this;eventBus.$off("clearTimer"),eventBus.$on("clearTimer",function(e){window.clearInterval(t.int)}),this.isCalling=!0,this.showEndTime=!1,eventBus.$on("stateAction",function(e){console.log("stateAction:",e),"busyAgentOb"==e?(console.log("正在呼叫中..."),t.showEndTime=!1,t.PhoneState=8,t.endTime="00:00:00"):"busyOb"==e?(console.log("已接通"),t.PhoneState=9,t.int=setInterval(t.timer,1e3)):"ACW"==e&&(console.log("结束通话时间",t.callTime),t.setTimer(""),t.showEndTime=!0,t.endTime=t.callTime,t.PhoneState=6,window.clearInterval(t.int),t.millisecond=0,t.hour=0,t.minute=0,t.second=0,t.callTime="00时00分00秒")})},mounted:function(){},methods:l()({},Object(s.c)(["setTimer"]),{answer:function(){var t={};t.tel=this.phone||"17322300397",CTILink.Agent.previewOutcall(t)},hangUp:function(){CTILink.Session.isSessionAlive()&&CTILink.Session.unlink()},timer:function(){this.second++,this.second>=60&&(this.second=0,this.minute=this.minute+1),this.minute>=60&&(this.minute=0,this.hour=this.hour+1),this.callTime=this.formatZero(this.hour)+"时"+this.formatZero(this.minute)+"分"+this.formatZero(this.second)+"秒"},formatZero:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(t).length>e?t:(Array(e).join(0)+t).slice(-e)},handleClose:function(){this.$emit("callPhoneCloseFn")},toCluesDeal:function(){this.$router.push({path:"/work/cluesDeal",query:{}})}}),beforeDestroy:function(){window.clearInterval(this.int),console.log("listener was closed")}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",[i("el-dialog",{staticClass:"call-phone-dialog",attrs:{visible:t.dialogVisible,width:t.dialogWidth,"before-close":t.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"}),t._v(" "),i("div",{staticClass:"dialog-center call-phone-dialog-center",class:{"call-coming-time":t.isCalling}},[i("div",{staticClass:"call-phone-title"},[t._v("外呼电话\n          "),8!=t.PhoneState&&9!=t.PhoneState?i("img",{staticClass:"call-phone-close-icon",attrs:{src:a("8eEq"),alt:""},on:{click:function(e){return t.handleClose()}}}):t._e()]),t._v(" "),i("div",{staticClass:"call-info"},[i("div",{staticClass:"sf"},[t._v("线索")]),t._v(" "),i("div",{staticClass:"phone"},[t._v(t._s(t.phone))]),t._v(" "),t.isCalling?t._e():i("div",[t._v("张松 华南项目组 销售总监")])]),t._v(" "),i("div",{staticClass:"call-event"},[8==t.PhoneState||9==t.PhoneState||t.showEndTime?t._e():i("div",{staticClass:"before-coming"},[i("div",{staticClass:"temp-rl-style"}),t._v(" "),i("div",{on:{click:function(e){return t.answer()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})])]),t._v(" "),8==t.PhoneState?i("div",{staticClass:"dialing-call"},[i("div",{staticClass:"temp-rl-style waiting-style"},[t._v("等待对方接听...")]),t._v(" "),i("div",{on:{click:function(e){return t.hangUp()}}},[i("img",{attrs:{src:a("4cN8"),alt:""}})])]):t._e(),t._v(" "),9==t.PhoneState?i("div",{staticClass:"in-the-call"},[i("div",{staticClass:"temp-rl-style calling-style"},[t._v("通话中 "+t._s(t.callTime))]),t._v(" "),i("div",{staticClass:"in-coming-btns"},[i("div",{on:{click:function(e){return t.hangUp()}}},[i("img",{attrs:{src:a("4cN8"),alt:""}})])])]):t._e(),t._v(" "),t.showEndTime?i("div",{staticClass:"end-call"},[i("div",{staticClass:"temp-rl-style waiting-style"},[t._v("通话结束 "+t._s(t.endTime))]),t._v(" "),i("div",{on:{click:function(e){return t.answer()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})])]):t._e(),t._v(" "),t.isCalling?i("div",{staticClass:"set-clue-btn"},[i("el-button",{staticClass:"plain-btn-style",attrs:{size:"medium",round:""},on:{click:function(e){return t.toCluesDeal()}}},[t._v("建档")])],1):t._e()])])])],1)])},staticRenderFns:[]};var c=a("VU/8")(o,n,!1,function(t){a("Yk5n"),a("LKe+")},"data-v-60b3f753",null);e.a=c.exports},TOVE:function(t,e){},U9VJ:function(t,e){},VSGy:function(t,e){},X7u6:function(t,e){},XcDm:function(t,e,a){"use strict";var i={data:function(){return{dialogVisible:!0,val:"",options:[{value:"1",label:"是"},{value:"0",label:"否"}],checkboxGroup1:["1","2"],radio4:"1",percentage:80,items:["内饰","外观","舒适度"],activeName:"first",input1:""}},methods:{handleClick:function(t,e){console.log(t,e)},add:function(){this.addressDefaultData={},this.dialogVisible=!0},handleClose:function(){this.dialogVisible=!1,this.$emit("callCloseFn")},save:function(){}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-dialog",{staticClass:"call-dialog",attrs:{visible:t.dialogVisible,width:"400px","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"}),t._v(" "),a("div",{staticClass:"dialog-center call-dialog-center"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{staticClass:"tab-content",attrs:{label:"拨号键盘",name:"first"}},[a("div",{staticClass:"call-input"},[a("el-input",{attrs:{placeholder:"请输入号码"},model:{value:t.input1,callback:function(e){t.input1=e},expression:"input1"}},[a("el-button",{attrs:{slot:"suffix",type:"primary",icon:"el-icon-phone",circle:""},slot:"suffix"})],1)],1),t._v(" "),a("div",{staticClass:"call-number"},[a("div",{staticClass:"call-number-items"},[a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("1")]),t._v(" "),a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("2")]),t._v(" "),a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("3")])],1),t._v(" "),a("div",{staticClass:"call-number-items"},[a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("4")]),t._v(" "),a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("5")]),t._v(" "),a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("6")])],1),t._v(" "),a("div",{staticClass:"call-number-items"},[a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("7")]),t._v(" "),a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("8")]),t._v(" "),a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("9")])],1),t._v(" "),a("div",{staticClass:"call-number-items"},[a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("*")]),t._v(" "),a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("0")]),t._v(" "),a("el-button",{staticClass:"call-btn",attrs:{round:""}},[t._v("#")])],1)])]),t._v(" "),a("el-tab-pane",{attrs:{label:"通话记录",name:"second"}},[a("div",{staticClass:"call-record-tab"},[a("div",{staticClass:"call-input"},[a("el-input",{attrs:{placeholder:"请输入号码"},model:{value:t.input1,callback:function(e){t.input1=e},expression:"input1"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},slot:"suffix"})])],1),t._v(" "),a("div",{staticClass:"record-list"},[a("div",{staticClass:"record-item"},[a("div",{staticClass:"phone"},[t._v("13388887777")]),t._v(" "),a("div",{staticClass:"record-info"},[a("span",[t._v("刚刚")]),t._v(" "),a("span",[t._v("呼入40秒")]),t._v(" "),a("span",[t._v("广东深圳")]),t._v(" "),a("span",[t._v("移动")])])]),t._v(" "),a("div",{staticClass:"record-item"},[a("div",{staticClass:"phone"},[t._v("13388887777")]),t._v(" "),a("div",{staticClass:"record-info"},[a("span",[t._v("刚刚")]),t._v(" "),a("span",[t._v("呼入40秒")]),t._v(" "),a("span",[t._v("广东深圳")]),t._v(" "),a("span",[t._v("移动")])])]),t._v(" "),a("div",{staticClass:"record-item"},[a("div",{staticClass:"phone"},[t._v("13388887777")]),t._v(" "),a("div",{staticClass:"record-info"},[a("span",[t._v("刚刚")]),t._v(" "),a("span",[t._v("呼入40秒")]),t._v(" "),a("span",[t._v("广东深圳")]),t._v(" "),a("span",[t._v("移动")])])]),t._v(" "),a("div",{staticClass:"record-item"},[a("div",{staticClass:"phone"},[t._v("13388887777")]),t._v(" "),a("div",{staticClass:"record-info"},[a("span",[t._v("刚刚")]),t._v(" "),a("span",[t._v("呼入40秒")]),t._v(" "),a("span",[t._v("广东深圳")]),t._v(" "),a("span",[t._v("移动")])])]),t._v(" "),a("div",{staticClass:"record-item"},[a("div",{staticClass:"phone"},[t._v("13388887777")]),t._v(" "),a("div",{staticClass:"record-info"},[a("span",[t._v("刚刚")]),t._v(" "),a("span",[t._v("呼入40秒")]),t._v(" "),a("span",[t._v("广东深圳")]),t._v(" "),a("span",[t._v("移动")])])]),t._v(" "),a("div",{staticClass:"record-item"},[a("div",{staticClass:"phone"},[t._v("13388887777")]),t._v(" "),a("div",{staticClass:"record-info"},[a("span",[t._v("刚刚")]),t._v(" "),a("span",[t._v("呼入40秒")]),t._v(" "),a("span",[t._v("广东深圳")]),t._v(" "),a("span",[t._v("移动")])])])])])])],1)],1)])],1)},staticRenderFns:[]};var s=a("VU/8")(i,l,!1,function(t){a("7wSb")},"data-v-9e2f3c0c",null);e.a=s.exports},Yk5n:function(t,e){},YkQk:function(t,e){},"f/9b":function(t,e){},gBeo:function(t,e,a){"use strict";var i=a("Dd8w"),l=a.n(i),s=a("NYxO"),o={props:["callType","phone","dialogVisible"],data:function(){return{dialogWidth:"270px",isCalling:!1,val:"",options:[{value:"1",label:"是"},{value:"0",label:"否"}],checkboxGroup1:["1","2"],radio4:"1",percentage:80,items:["内饰","外观","舒适度"],activeName:"first",input1:"",PhoneState:6,callTime:"00:00:00",hour:0,minute:0,second:0,millisecond:0,int:"",toggleMuteInCallStatus:!0,dialogVisibleIncomeCall:!1,m7CallStateDescriptionStatus:"stInvalid",showEndTime:!1,endTime:"00:00:00"}},created:function(){var t=this;eventBus.$off("clearTimer"),eventBus.$on("clearTimer",function(e){window.clearInterval(t.int)}),this.isCalling=!0,this.showEndTime=!1,eventBus.$off("getAliCode"),eventBus.$on("getAliCode",function(e){console.log("获取code值："+e),t.PhoneState=e,console.log("获取_code值",t.PhoneState),8==e?(console.log("正在呼叫中..."),t.showEndTime=!1,t.endTime="00:00:00"):9==e?(console.log("已接通"),t.int=setInterval(t.timer,1e3)):5==e?(console.log("结束通话时间",t.callTime),t.setTimer(""),t.showEndTime=!0,t.endTime=t.callTime,window.clearInterval(t.int),t.millisecond=0,t.hour=0,t.minute=0,t.second=0,t.callTime="00时00分00秒"):3==e&&(t.dialogVisibleIncomeCall=!1)}),eventBus.$off("caller"),eventBus.$on("caller",function(t){console.log("来电号码:",t)})},mounted:function(){},methods:l()({},Object(s.c)(["setTimer"]),{hangUp:function(){window.workbench.hangUp(),console.log("挂机")},call:function(){var t=this.phone||"17322300397";window.workbench.call(t)},answer:function(){window.workbench.answer(),console.log("接听电话，通过该方法可接听来电，建立通话连接。")},toggleMuteInCall:function(){window.workbench.toggleMuteInCall(),this.toggleMuteInCallStatus=!this.toggleMuteInCallStatus,console.log("静音")},timer:function(){this.second++,this.second>=60&&(this.second=0,this.minute=this.minute+1),this.minute>=60&&(this.minute=0,this.hour=this.hour+1),this.callTime=this.formatZero(this.hour)+"时"+this.formatZero(this.minute)+"分"+this.formatZero(this.second)+"秒"},formatZero:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(t).length>e?t:(Array(e).join(0)+t).slice(-e)},handleClick:function(t,e){console.log(t,e)},handleClose:function(){this.$emit("callPhoneCloseFn")},toCluesDeal:function(){this.$router.push({path:"/work/cluesDeal",query:{}})}}),beforeDestroy:function(){window.clearInterval(this.int),console.log("listener was closed")}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",[i("el-dialog",{staticClass:"call-phone-dialog",attrs:{visible:t.dialogVisible,width:t.dialogWidth,"before-close":t.handleClose,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"}),t._v(" "),i("div",{staticClass:"dialog-center call-phone-dialog-center",class:{"call-coming-time":t.isCalling}},[i("div",{staticClass:"call-phone-title"},[t._v("外呼电话-阿里\n          "),8!=t.PhoneState&&9!=t.PhoneState?i("img",{staticClass:"call-phone-close-icon",attrs:{src:a("8eEq"),alt:""},on:{click:function(e){return t.handleClose()}}}):t._e()]),t._v(" "),i("div",{staticClass:"call-info"},[i("div",{staticClass:"sf"},[t._v("线索")]),t._v(" "),i("div",{staticClass:"phone"},[t._v(t._s(t.phone))]),t._v(" "),t.isCalling?t._e():i("div",[t._v("张松 华南项目组 销售总监")])]),t._v(" "),i("div",{staticClass:"call-event"},[8==t.PhoneState||9==t.PhoneState||t.showEndTime?t._e():i("div",{staticClass:"before-coming"},[i("div",{staticClass:"temp-rl-style"}),t._v(" "),i("div",{on:{click:function(e){return t.call()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})])]),t._v(" "),8==t.PhoneState?i("div",{staticClass:"dialing-call"},[i("div",{staticClass:"temp-rl-style waiting-style"},[t._v("等待对方接听...")]),t._v(" "),i("div",{on:{click:function(e){return t.hangUp()}}},[i("img",{attrs:{src:a("4cN8"),alt:""}})])]):t._e(),t._v(" "),9==t.PhoneState?i("div",{staticClass:"in-the-call"},[i("div",{staticClass:"temp-rl-style calling-style"},[t._v("通话中 "+t._s(t.callTime))]),t._v(" "),i("div",{staticClass:"in-coming-btns"},[i("div",{on:{click:function(e){return t.hangUp()}}},[i("img",{attrs:{src:a("4cN8"),alt:""}})])])]):t._e(),t._v(" "),t.showEndTime?i("div",{staticClass:"end-call"},[i("div",{staticClass:"temp-rl-style waiting-style"},[t._v("通话结束 "+t._s(t.endTime))]),t._v(" "),i("div",{on:{click:function(e){return t.call()}}},[i("img",{attrs:{src:a("QNcc"),alt:""}})])]):t._e(),t._v(" "),t.isCalling?i("div",{staticClass:"set-clue-btn"},[i("el-button",{staticClass:"plain-btn-style",attrs:{size:"medium",round:""},on:{click:function(e){return t.toCluesDeal()}}},[t._v("建档")])],1):t._e()])])])],1)])},staticRenderFns:[]};var c=a("VU/8")(o,n,!1,function(t){a("U9VJ"),a("YkQk")},"data-v-6dfdb372",null);e.a=c.exports},kSDW:function(t,e){},l9jf:function(t,e){},o8l0:function(t,e){},rovM:function(t,e){},vDyI:function(t,e){},yPam:function(t,e){}});
//# sourceMappingURL=6.2049fe5e2f31452a9255.js.map