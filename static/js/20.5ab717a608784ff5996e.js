webpackJsonp([20],{QeVz:function(t,e){},cnCQ:function(t,e){},lSat:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=a("woOf"),o=a.n(l),i=a("/Uby"),c=a("IaGi"),s=a("ufHF"),n=a("Gu7T"),r=a.n(n),d={components:{FollowRecord:a("Y1jt").a},props:{row:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:!0,recordList:[],followPage:{totalCount:0,page:1,pageSize:10,totalPage:1}}},created:function(){this.getFollowList("init")},methods:{cancel:function(){this.$emit("cancel")},getFollowList:function(t){var e=this;"init"==t&&(this.followList=[],this.followPage.page=1);var a=this.followPage,l=a.page,o=a.pageSize,i={typeId:this.row.dataType,id:this.row.dataId,page:l,pageSize:o};this.$fetch.common.followListByType(i).then(function(t){e.$handleResponse(t,function(t){var a=t.list,l=t.page;a&&a.length>0&&(e.recordList=[].concat(r()(e.recordList),r()(a))),e.followPage.totalCount=l.totalCount,e.followPage.totalPage=l.totalPage},!0)}).catch(function(){e.$store.commit("closeLoading")})},handleFollowScroll:function(){this.followPage.page>=this.followPage.totalPage||(this.followPage.page++,this.getFollowList())}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"right-side-dialog call-follow-dialog",attrs:{title:"跟进记录",visible:t.dialogVisible,width:"450px","append-to-body":"","close-on-click-modal":!1,"before-close":t.cancel},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("follow-record",{staticClass:"m-t-20 p-20 clue-follow-record reset-scrollbar",attrs:{"record-list":t.recordList,scrollEvent:!0},on:{"event-scroll":t.handleFollowScroll}})],1)},staticRenderFns:[]};var p=a("VU/8")(d,u,!1,function(t){a("QeVz")},"data-v-5f504890",null).exports,h=a("F+dp"),f=a("RbfQ"),b=a("CKy9"),g=a("PdD4"),w={components:{SearchBar:i.a,SearchCol:c.a,DataTable:s.a,CallFollow:p,AudioPlayer:h.a,ExportLog:f.a,CommonExport:b.a},mixins:[g.a],data:function(){return{search:{},dataTable:{},showFollow:!1,showAudio:!1,voiceFile:""}},created:function(){this.initData(),this.queryData()},methods:{initData:function(){this.row={},this.initExport(),this.initSearch(),this.initTable(),this.getDccList()},initExport:function(){this.exportConfig={fileName:"通话记录导出",ext:"csv",idName:"id",select:[],taskType:"",url:"business.exportClueExcel",other:{}}},initSearch:function(){this.search={list:[{type:"select",label:"DCC邀约员",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[],optionLabel:"dccName",optionValue:"id"},{type:"select",label:"通话方式",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[{title:"呼出",id:1},{title:"呼入",id:2}],optionLabel:"title",optionValue:"id"},{type:"select",label:"通话结果",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[{title:"成功",id:1},{title:"失败",id:2},{title:"未接通",id:3}],optionLabel:"title",optionValue:"id"},{type:"datePicker",label:"通话时间",currentVal:""},{type:"select",label:"坐席组",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[],optionLabel:"dccGroupName",optionValue:"id"}],dccId:0,type:1,result:2,time:3,dccGroup:4}},initTable:function(){this.dataTable={tr:[{id:"1",label:"操作",prop:"caozuo",show:"template",width:"170"},{id:"2",label:"DCC邀约员",prop:"dccName",tooltip:!0},{id:"3",label:"坐席组",prop:"dccGroupName",tooltip:!0},{id:"4",label:"通话时间",prop:"createDate",tooltip:!0},{id:"5",label:"客户姓名",prop:"customerName",tooltip:!0},{id:"6",label:"客户手机号",prop:"customerTel",tooltip:!0},{id:"7",label:"通话方式",prop:"callTypeTitle",tooltip:!0},{id:"8",label:"通过结果",prop:"callResultTitle",tooltip:!0},{id:"9",label:"通话时长",prop:"duration",tooltip:!0}],data:[],page:{totalCount:0,pageSize:20,currentPage:1},border:!1,hasSelect:!0,hasExpand:!1,hasFirstPagination:!0,search:{value:"",show:!0,keyword:"kwd",url:"callCenter.dccCallList",width:"300",placeholder:"客户名称、客户手机号",displayCol:["customerName","customerTel"],parma:{id:""}}}},getDccList:function(){var t=this;this.$fetch.common.commonDccList({},!1,!1).then(function(e){t.$handleResponse(e,function(e){t.search.list[t.search.dccGroup].selectOptions=t.$hasArrContent(e)?e:[];var a=[];t.$hasArrContent(e)&&(e.forEach(function(e){t.$hasArrContent(e.dccList)&&(a=a.concat(e.dccList))}),t.search.list[t.search.dccId].selectOptions=a)},!1)})},getParams:function(){var t=this.dataTable.page,e=t.currentPage,a=t.pageSize,l=this.search,o=l.dccId,i=l.type,c=l.result,s=l.time,n=l.dccGroup,r=l.list;return{dccId:r[o].currentVal,callType:r[i].currentVal,callResult:r[c].currentVal,dateStart:r[s].currentVal&&r[s].currentVal[0],dateEnd:r[s].currentVal&&r[s].currentVal[1],dccGroupId:r[n].currentVal,pageSize:a,page:e}},queryData:function(){var t=this,e=this,a=this.getParams();this.exportConfig.other=o()({},a),this.$fetch.callCenter.dccCallList(a).then(function(a){t.$handleResponse(a,function(t){e.dataTable.data=t.list?t.list:[],e.dataTable.page=t.page?t.page:e.dataTable.page},!0)}).catch(function(){t.$store.commit("closeLoading")})},seeFollow:function(t){this.showFollow=!0,this.row=t},showAudioFn:function(t){this.showAudio=!0,this.voiceFile=t.voiceFile}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"call-record-page m-20 common-box"},[a("search-bar",{staticClass:"m-t-10 p-20",attrs:{size:"medium"},on:{clear:t.clear,find:t.find}},[a("div",{staticClass:"search-flex"},[a("search-col",{attrs:{info:t.search.list[t.search.dccId],filterable:""}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.type]}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.result]}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.time],type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.dccGroup],filterable:""}})],1)]),t._v(" "),a("div",{staticClass:"p-20"},[a("data-table",{ref:"DataTableRef",attrs:{table:t.dataTable},on:{searchTable:t.searchTable,onHandleSelectionChange:t.handleSelectionChange},scopedSlots:t._u([{key:"caozuo",fn:function(e){return[a("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"mini",disabled:0==e.obj.row.dataId},on:{click:function(a){return t.seeFollow(e.obj.row)}}},[t._v("查看跟进")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"mini",disabled:!e.obj.row.voiceFile},on:{click:function(a){return t.showAudioFn(e.obj.row)}}},[t._v("录音")])]}}])},[a("div",{attrs:{slot:"buttons"},slot:"buttons"})])],1),t._v(" "),t.showFollow?a("call-follow",{attrs:{row:t.row},on:{cancel:function(e){t.showFollow=!1}}}):t._e(),t._v(" "),t.showAudio?a("audio-player",{attrs:{url:t.voiceFile},on:{cancel:function(e){t.showAudio=!1}}}):t._e()],1)},staticRenderFns:[]};var v=a("VU/8")(w,m,!1,function(t){a("vwTC"),a("cnCQ")},"data-v-0e519f15",null);e.default=v.exports},vwTC:function(t,e){}});
//# sourceMappingURL=20.5ab717a608784ff5996e.js.map