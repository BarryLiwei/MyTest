{"version":3,"sources":["webpack:///src/pages/setting/org/AddOrg.vue","webpack:///./src/pages/setting/org/AddOrg.vue?496c","webpack:///./src/pages/setting/org/AddOrg.vue"],"names":["AddOrg","components","BreadCrumb","ScrmFormItem","data","type","parentData","info","name","id","transProps","key","label","dataAreas","selectedAreas","labelTitle","created","this","$route","query","path","getDetialOrg","getShopList","methods","cancel","$router","push","_this","params","pagination","parentId","$fetch","setting","queryOrgShopList","then","res","$handleResponse","areas","list","getRightShop","catch","response","$store","commit","_this2","expand","orgId","queryAreasList","$hasArrContent","forEach","item","err","_this3","orgInfo","org","addManager","getParams","createFn","updateFn","_info","areaIds","pid","$message","error","_this4","orgCreate","success","_this5","orgUpdate","filterMethod","val","org_AddOrg","render","_vm","_h","$createElement","_c","_self","staticClass","_v","_s","ref","attrs","label-width","itemLabel","itemType","itemRequired","itemClass","itemInfo","itemKey","subClass","placeholder","maxlength","filterable","filter-placeholder","titles","props","model","value","callback","$$v","expression","round","size","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/5.12f8d4373741eb9f7998.js","sourcesContent":["<template>\r\n    <div class=\"add-org-page m-20\">\r\n        <bread-crumb></bread-crumb>\r\n\r\n        <div class=\"common-box p-b-20 m-t-20\">\r\n            <div class=\"group-title\">上层组织: <span class=\"m-l-5\">{{ parentData['parentName']?parentData['parentName']:'广汽集团'}}</span></div>\r\n\r\n            <el-form class=\"m-t-20\" ref=\"form\" label-width=\"150px\">\r\n                <scrm-form-item \r\n                    :itemLabel=\"labelTitle\" itemType=\"input\"  :itemRequired=\"true\" itemClass=\"form_required_after\" \r\n                    :itemInfo=\"info\" itemKey=\"name\" subClass=\"w-350\"  placeholder=\"限20个字符\" :maxlength=\"20\">\r\n                </scrm-form-item>\r\n\r\n                <el-form-item label=\"选择门店\" >\r\n                    <el-transfer\r\n                      class=\"transfer-class\"\r\n                      filterable\r\n                      filter-placeholder=\"请输入选项名称\"\r\n                      v-model=\"selectedAreas\"\r\n                      :data=\"dataAreas\"\r\n                      :titles=\"['待选选择：', '已选列表：']\"\r\n                      :props=\"transProps\"\r\n                    ></el-transfer>\r\n                </el-form-item>\r\n            \r\n                <el-form-item label=\"\" class=\"m-t-50\">\r\n                    <el-button round size=\"small\" class=\"w-90\" @click=\"cancel\">取 消</el-button>\r\n                    <el-button round size=\"small\" class=\"w-90\" @click=\"addManager\" type=\"primary\">保 存</el-button>\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport BreadCrumb from '@/components/bread/BreadCrumb';\r\nimport ScrmFormItem from '@/components/form/ScrmFormItem'\r\nexport default {\r\n    components: {\r\n       BreadCrumb,\r\n       ScrmFormItem,\r\n    },\r\n    data(){\r\n        return{\r\n            type: 'add', // 编辑类型\r\n            parentData: {},   // 传进来的参数\r\n            info: {\r\n                name: '',\r\n                id: '',\r\n            },\r\n            transProps: {\r\n                key: 'id',\r\n                label: 'short_name'\r\n            },\r\n            dataAreas: [], // 待选列表\r\n            selectedAreas: [], // 已选\r\n            labelTitle:'子组织名称',\r\n        }\r\n    },\r\n    created(){\r\n        this.parentData = this.$route.query;\r\n        if(this.$route.path == '/setting/org-structure/edit'){\r\n            // 编辑的时候，当前组织为当前，上一级组件\r\n            this.type = 'edit';\r\n            this.labelTitle = '当前组织名称'\r\n            this.getDetialOrg(this.parentData.id);\r\n        };\r\n\r\n        this.getShopList(); // 获取左侧门店列表\r\n    },\r\n    methods: {\r\n        cancel(){\r\n            this.$router.push('/setting/org-structure');\r\n        },\r\n        getShopList(){ // 新建，编辑的时候左侧shop都调这个接口\r\n            let params = {\r\n                // page: 1,\r\n                // pageSize: 3000,\r\n                pagination: 0\r\n            }\r\n            let id = this.type=='edit'?this.parentData.id :this.parentData.parentId;\r\n            params['mode'] = this.type=='edit'?'update':'add';\r\n            this.$fetch.setting.queryOrgShopList(id, params).then(res => {\r\n                this.$handleResponse(res, (data) => {\r\n                    this.dataAreas= data.areas && data.areas.list; //表格所需数据\r\n                },true);\r\n\r\n                if(this.type=='edit'){\r\n                    this.getRightShop();\r\n                }\r\n            }).catch(response => {\r\n                this.$store.commit('closeLoading');\r\n            });\r\n        },\r\n        getRightShop(){ // 右边的shop expand=brands&name=&orgId=1, 编辑才调\r\n            let params={\r\n                expand:'brands',\r\n                orgId: this.parentData.id\r\n            }\r\n            this.$fetch.setting.queryAreasList(params).then((res)=>{\r\n                this.$handleResponse(res, res => {\r\n                    if(this.$hasArrContent(res.list)){\r\n                        res.list.forEach((item)=>{\r\n                            this.selectedAreas.push(item.id);\r\n                            this.dataAreas.push(item); // 由于左边已经过滤掉重复的，所以需要新增进来\r\n                        })\r\n                    }\r\n                },true);\r\n            }).catch((err)=>{\r\n                this.$store.commit('closeLoading');\r\n            })\r\n        },\r\n        getDetialOrg(id){\r\n            this.$fetch.setting.orgInfo(id,{}).then((res)=>{\r\n                this.$handleResponse(res, res => {\r\n                    this.info = res.org;\r\n                },true);\r\n            }).catch((err)=>{\r\n                this.$store.commit('closeLoading');\r\n            })\r\n        },\r\n        addManager(){\r\n            let params = this.getParams();\r\n            if(!params){\r\n                return;\r\n            }\r\n            this.type == 'add'? this.createFn(params): this.updateFn(params);\r\n        },\r\n        getParams(){\r\n            let { areaIds, name} = this.info;\r\n            let params = {\r\n                areaIds: this.selectedAreas, \r\n                name,\r\n                pid:  this.parentData.parentId\r\n            }\r\n            if(!name){\r\n                this.$message.error('组织名称不能为空');\r\n                return false;\r\n            }\r\n            return params;\r\n        },\r\n        createFn(params){\r\n            this.$fetch.setting.orgCreate(params).then((res)=>{\r\n                this.$handleResponse(res, res => {\r\n                    this.$message.success('新增成功');\r\n                    this.$router.push('/setting/org-structure');\r\n                },true);\r\n            }).catch((err)=>{\r\n                this.$store.commit('closeLoading');\r\n            })\r\n        },\r\n        updateFn(params){\r\n            this.$fetch.setting.orgUpdate(this.parentData.id, params).then((res)=>{\r\n                this.$handleResponse(res, res => {\r\n                    this.$message.success('更新成功');\r\n                    this.$router.push('/setting/org-structure');\r\n                },true);\r\n            }).catch((err)=>{\r\n                this.$store.commit('closeLoading');\r\n            })\r\n        },\r\n        filterMethod(val){\r\n            \r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.group-title {\r\n    color: #444;\r\n    font-size: 16px;\r\n    padding-left: 20px;\r\n    font-weight: 600;\r\n    height: 60px;\r\n    line-height: 60px;\r\n    background-color: #fafcff;\r\n    border-bottom: solid 1px #eaebf0;\r\n}\r\n\r\n.add-org-page /deep/.transfer-class .el-transfer__button {\r\n    display: block;\r\n    margin: 0 auto 10px;\r\n    padding: 10px;\r\n    border-radius: 50%;\r\n    color: #FFF;\r\n    background-color: #409EFF;\r\n    font-size: 0;\r\n}\r\n\r\n.add-org-page /deep/.transfer-class .el-transfer__button.is-disabled, \r\n.add-org-page /deep/.transfer-class .el-transfer__button.is-disabled:hover{\r\n    border: 1px solid #DCDFE6;\r\n    background-color: #F5F7FA;\r\n    color: #C0C4CC;\r\n}\r\n\r\n.add-org-page /deep/.transfer-class .el-transfer-panel{\r\n  width: 350px;\r\n}\r\n.add-org-page /deep/.transfer-class input.el-input__inner {\r\n  width: 100%!important;\r\n}\r\n\r\n.add-org-page /deep/.transfer-class .el-transfer-panel__body{\r\n  height: 286px;\r\n}\r\n\r\n.add-org-page /deep/ .el-transfer-panel__item {\r\n    display: block;\r\n}\r\n</style>\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/setting/org/AddOrg.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"add-org-page m-20\"},[_c('bread-crumb'),_vm._v(\" \"),_c('div',{staticClass:\"common-box p-b-20 m-t-20\"},[_c('div',{staticClass:\"group-title\"},[_vm._v(\"上层组织: \"),_c('span',{staticClass:\"m-l-5\"},[_vm._v(_vm._s(_vm.parentData['parentName']?_vm.parentData['parentName']:'广汽集团'))])]),_vm._v(\" \"),_c('el-form',{ref:\"form\",staticClass:\"m-t-20\",attrs:{\"label-width\":\"150px\"}},[_c('scrm-form-item',{attrs:{\"itemLabel\":_vm.labelTitle,\"itemType\":\"input\",\"itemRequired\":true,\"itemClass\":\"form_required_after\",\"itemInfo\":_vm.info,\"itemKey\":\"name\",\"subClass\":\"w-350\",\"placeholder\":\"限20个字符\",\"maxlength\":20}}),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"选择门店\"}},[_c('el-transfer',{staticClass:\"transfer-class\",attrs:{\"filterable\":\"\",\"filter-placeholder\":\"请输入选项名称\",\"data\":_vm.dataAreas,\"titles\":['待选选择：', '已选列表：'],\"props\":_vm.transProps},model:{value:(_vm.selectedAreas),callback:function ($$v) {_vm.selectedAreas=$$v},expression:\"selectedAreas\"}})],1),_vm._v(\" \"),_c('el-form-item',{staticClass:\"m-t-50\",attrs:{\"label\":\"\"}},[_c('el-button',{staticClass:\"w-90\",attrs:{\"round\":\"\",\"size\":\"small\"},on:{\"click\":_vm.cancel}},[_vm._v(\"取 消\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"w-90\",attrs:{\"round\":\"\",\"size\":\"small\",\"type\":\"primary\"},on:{\"click\":_vm.addManager}},[_vm._v(\"保 存\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-e6d202cc\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/setting/org/AddOrg.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-e6d202cc\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./AddOrg.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./AddOrg.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./AddOrg.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-e6d202cc\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./AddOrg.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-e6d202cc\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/setting/org/AddOrg.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}