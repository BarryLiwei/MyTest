webpackJsonp([18],{"1GUu":function(n,e,t){var a=t("z06c");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("FIqI")("dcc1cba4",a,!1,{})},"2W8H":function(n,e,t){var a=t("Q4J1");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("FIqI")("0ce163b6",a,!1,{})},"7M/F":function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("aA9S"),i=t.n(a),r=t("/Uby"),s=t("IaGi"),o=t("ufHF"),l=t("kfhN"),c=t("oFuF"),d={components:{ScrmFormItem:l.a},props:{info:{type:Object,default:function(){return{}}},type:{type:String,default:"add"},shopList:{type:Array,default:function(){return[]}},mediaOptions:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisible:!0,showView:!1,title:"新增垂媒账号",media:{id:""},dialogType:"",mediaTable:[{type_text:"",type:"",id:"",account_name:"",account_pwd:"",options:[]}],selectId:[],loading:!1,shopOptions:[]}},created:function(){this.dialogType=this.type,"add"==this.type?(this.title="新增垂媒账号",this.shopOptions=this.$deepCopyContent(this.shopList),this.shopOptions&&this.shopOptions.length&&(this.info.short_name=this.shopOptions[0].short_name,this.info.shopId=this.shopOptions[0].id),this.mediaTable[0].options=this.$deepCopyContent(this.mediaOptions)):"view"==this.type&&(this.showView=!0,this.title="查看详情",this.media=this.$deepCopyContent(this.info))},computed:{btnName:function(){return"add"==this.dialogType?"确定":"view"==this.dialogType?"编辑":"保存"}},methods:{addFn:function(){var n=this;if("view"==this.dialogType)return this.dialogType="edit",this.showView=!1,this.title="编辑",this.mediaTable=this.$deepCopyContent(this.media.account),this.mediaTable.length&&(this.mediaTable.forEach(function(e){n.$set(e,"options",n.$deepCopyContent(n.mediaOptions))}),this.selectChange()),this.shopOptions=this.$deepCopyContent(this.shopList),void(this.shopOptions=Object(c.a)([this.info],"id","short_name",this.shopOptions,"id","title"));this.updateMedia()},getParams:function(){var n=[];if(this.mediaTable.length)for(var e=0,t=this.mediaTable.length;e<t;e++)n.push({id:this.mediaTable[e].id,type:this.mediaTable[e].type,account_name:this.mediaTable[e].account_name,account_pwd:this.mediaTable[e].account_pwd});return{area_id:this.media.id,accounts:n}},updateMedia:function(){var n=this,e=this.getParams();this.loading=!0,this.$fetch.callCenter.mediaAccountEdit(e).then(function(e){n.loading=!1,n.$handleResponse(e,function(e){n.$message.success(("add"==n.dialogType?"新增":"编辑")+"成功"),n.$emit("close","success")},!0)}).catch(function(){n.loading=!1,n.$store.commit("closeLoading")})},cancel:function(){if("edit"==this.dialogType)return this.dialogType="view",this.title="查看详情",this.showView=!0,void(this.media=this.$deepCopyContent(this.info));this.$emit("close","cancel")},addCount:function(){var n={type_text:"",type:"",id:"",account_name:"",account_pwd:"",options:this.$deepCopyContent(this.mediaOptions)};this.mediaTable.push(n),this.selectChange()},selectChange:function(){this.getSelectId(),this.checkDisabled()},getSelectId:function(){var n=this;this.selectId=[],this.mediaTable.forEach(function(e){e.type&&n.selectId.push(e.type)})},checkDisabled:function(){var n=this;this.$hasArrContent(this.selectId)&&this.$hasArrContent(this.mediaTable)&&this.mediaTable.forEach(function(e){e.options&&e.options.length&&(e.options=n.$deepCopyContent(n.mediaOptions),n.contrast(e))})},contrast:function(n){this.selectId&&this.selectId.forEach(function(e){for(var t=0;t<n.options.length;t++)if(e!=n.id&&e==n.options[t].val){n.options[t].disabled=!0;break}})},deleteFn:function(n){this.mediaTable.splice(n,1),this.selectChange()},changeArea:function(n){var e=this;this.loading=!0,this.$fetch.callCenter.getAccountByArea({id:n}).then(function(n){e.loading=!1,e.$handleResponse(n,function(n){e.mediaTable=e.$hasArrContent(n)?n:[],e.mediaTable.length&&(e.mediaTable.forEach(function(n){e.$set(n,"options",e.$deepCopyContent(e.mediaOptions))}),e.selectChange())},!1)}).catch(function(){e.loading=!1})}}},p=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("el-dialog",{staticClass:"add-media-dialog",attrs:{title:n.title,visible:n.dialogVisible,width:"870px","append-to-body":"","close-on-click-modal":!1,"before-close":n.cancel},on:{"update:visible":function(e){n.dialogVisible=e}}},[n.showView?n._e():t("div",{directives:[{name:"loading",rawName:"v-loading",value:n.loading,expression:"loading"}]},[t("el-form",{ref:"form",attrs:{"label-width":"80px"}},[t("scrm-form-item",{attrs:{itemLabel:"门店",itemType:"select",itemRequired:!0,itemClass:"form_required_after",subClass:"w-250",placeholder:"请选择门店",itemInfo:n.media,itemKey:"id",filterable:!0,selectOptions:n.shopOptions,optionLabel:"title",optionValue:"id",editable:"add"==n.dialogType,isTransfer:!0},on:{change:n.changeArea}}),n._v(" "),t("scrm-form-item",{staticClass:"add-item",attrs:{itemLabel:"垂媒账号",itemRequired:!0,itemClass:"form_required_after",itemInfo:{}}},[t("template",{slot:"custom"},[t("el-button",{staticClass:"m-b-20",attrs:{type:"primary",icon:"el-icon-plus",round:"",size:"small"},on:{click:n.addCount}},[n._v("新增垂媒账号")])],1)],2)],1),n._v(" "),t("el-form",{ref:"form",attrs:{"label-width":"80px"}},[t("table",{staticClass:"custom-table",attrs:{width:"100%",cellpadding:"0",cellspacing:"0",border:"0"}},n._l(n.mediaTable,function(e,a){return t("tr",{key:a,staticClass:"tr-item"},[t("td",{staticClass:"td-item",attrs:{width:"30%"}},[t("scrm-form-item",{attrs:{itemLabel:"垂媒"+(a+1),itemType:"select",itemRequired:!0,itemClass:"form_required_after",subClass:"w-100-percent",placeholder:"请选择垂媒",itemInfo:e,itemKey:"type",filterable:!0,selectOptions:e.options,optionLabel:"text",optionValue:"val"},on:{change:function(t){return n.selectChange(e)}}})],1),n._v(" "),t("td",{staticClass:"td-item",attrs:{width:"30%"}},[t("scrm-form-item",{attrs:{itemLabel:"账号",itemType:"input",itemRequired:!0,itemClass:"form_required_after",subClass:"w-100-percent",placeholder:"请输入",itemInfo:e,itemKey:"account_name"}})],1),n._v(" "),t("td",{staticClass:"td-item",attrs:{width:"30%"}},[t("scrm-form-item",{attrs:{itemLabel:"密码",itemType:"input",type:"password",itemRequired:!0,itemClass:"form_required_after",subClass:"w-100-percent",placeholder:"请输入",itemInfo:e,itemKey:"account_pwd"}})],1),n._v(" "),t("td",{staticClass:"td-item",attrs:{width:"10%"}},[a?t("i",{staticClass:"el-icon-delete m-l-15 pointer",on:{click:function(e){return n.deleteFn(a)}}}):n._e()])])}),0)])],1),n._v(" "),n.showView?t("div",{staticClass:"view"},[t("h3",{staticClass:"title m-b-20"},[n._v(n._s(n._f("filterBlank")(n.info.short_name)))]),n._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{data:n.media.account,border:""}},[t("el-table-column",{attrs:{prop:"type_text",label:"垂媒",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("div",{staticClass:"media-wrap"},[t("span",{staticClass:"dot",class:[1==e.row.status?"green":"red"]}),n._v("\n                        "+n._s(e.row.type_text)+"\n                    ")])]}}],null,!1,1505534498)}),n._v(" "),t("el-table-column",{attrs:{prop:"account_name",label:"账号",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"account_pwd",label:"密码",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",{staticStyle:{"font-size":"20px","font-weight":"700"}},[n._v(n._s(n._f("filterBlank")(n._f("changePwd")(e.row.account_pwd))))])]}}],null,!1,1919784761)})],1)],1):n._e(),n._v(" "),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"w-90",attrs:{round:"",size:"small"},on:{click:n.cancel}},[n._v("取 消")]),n._v(" "),t("el-button",{staticClass:"w-90",attrs:{round:"",size:"small",type:"primary"},on:{click:n.addFn}},[n._v(" "+n._s(n.btnName))])],1)])};p._withStripped=!0;var h={render:p,staticRenderFns:[]},m=h;var u=!1;var f=t("C7Lr")(d,m,!1,function(n){u||t("QCNg")},"data-v-5375657d",null);f.options.__file="src/pages/call-center/media/AddMedia.vue";var A=f.exports,g=t("PdD4"),b={components:{SearchBar:r.a,SearchCol:s.a,DataTable:o.a,AddMedia:A},mixins:[g.a],data:function(){return{showMedia:!1,showType:"add",mediaInfo:{}}},created:function(){this.initData(),this.queryData()},methods:{initData:function(){this.initSearch(),this.initTable(),this.initMediaOptions()},initSearch:function(){this.search={list:[{type:"select",label:"门店",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[],optionLabel:"title",optionValue:"id"},{type:"select",label:"垂媒",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[],optionLabel:"text",optionValue:"val"},{type:"select",label:"状态",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[],optionLabel:"text",optionValue:"val"},{type:"datePicker",label:"更新时间",currentVal:""}],shop:0,media:1,state:2,time:3}},initMediaOptions:function(){var n=this;this.$fetch.callCenter.mediaAccountOptions({}).then(function(e){n.$handleResponse(e,function(e){n.search.list[n.search.media].selectOptions=n.$hasArrContent(e.type)?e.type:[],n.search.list[n.search.state].selectOptions=n.$hasArrContent(e.status)?e.status:[]},!1)}),this.$fetch.common.commonAreaList({},!1).then(function(e){n.$handleResponse(e,function(e){n.$hasArrContent(e)&&(e.forEach(function(n){n.id=parseInt(n.id?n.id:0)}),n.search.list[n.search.shop].selectOptions=e)},!1)})},initTable:function(){this.dataTable={tr:[{id:"1",label:"门店",prop:"short_name",tooltip:!0,align:"center"},{id:"2",label:"垂媒",prop:"account",show:"template",tooltip:!0,align:"center"},{id:"3",label:"更新时间",prop:"last_update",tooltip:!0,align:"center"},{id:"4",label:"操作",prop:"caozuo",show:"template",minWidth:"130",align:"center"}],data:[],page:{totalCount:0,pageSize:20,currentPage:1},border:!0,hasSelect:!1,hasExpand:!1,hasFirstPagination:!1,search:{value:"",show:!1,width:"300",placeholder:"请输入手机号、客户微信",displayCol:["name","tel"],parma:{id:""}}}},getParams:function(){var n=this.dataTable.page,e=n.currentPage,t=n.pageSize,a=this.search,i=a.shop,r=a.media,s=a.state,o=a.time,l=a.list;return{area_id:l[i].currentVal,type:l[r].currentVal,status:l[s].currentVal,update_date_start:l[o].currentVal&&l[o].currentVal[0],update_date_end:l[o].currentVal&&l[o].currentVal[1],pre_page:t,page:e}},queryData:function(){var n=this,e=this,t=this.getParams();this.$fetch.callCenter.mediaAccountList(t).then(function(t){n.$handleResponse(t,function(n){e.dataTable.data=n.list?n.list:[],e.dataTable.page=n.page?n.page:e.dataTable.page},!0)}).catch(function(){n.$store.commit("closeLoading")})},deleteMedia:function(n){var e=this;this.$confirm("删除账号后，垂媒的线索无法同步至系统,是否确定要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"needCenterStyle mediaDeleteWidth",cancelButtonClass:"big cancel",confirmButtonClass:"big",roundButton:!0}).then(function(){e.$fetch.callCenter.mediaAccountDel({id:n.id}).then(function(n){e.$handleResponse(n,function(n){e.$message.success("删除成功"),e.queryData()},!0)}).catch(function(){e.$store.commit("closeLoading")})})},addFn:function(){this.showType="add",this.mediaInfo={},this.showMedia=!0},view:function(n){this.showType="view",this.mediaInfo=i()({},n),this.showMedia=!0},closeMedieFn:function(n){this.showMedia=!1,"success"==n&&this.queryData()}}},C=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"media-manage-page m-20 common-box"},[t("search-bar",{staticClass:"m-t-10 p-20",attrs:{size:"medium"},on:{clear:n.clear,find:n.find}},[t("div",{staticClass:"search-flex"},[t("search-col",{attrs:{info:n.search.list[n.search.shop],filterable:""}}),n._v(" "),t("search-col",{attrs:{info:n.search.list[n.search.media],filterable:""}}),n._v(" "),t("search-col",{attrs:{info:n.search.list[n.search.state]}}),n._v(" "),t("search-col",{attrs:{info:n.search.list[n.search.time],type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"}})],1)]),n._v(" "),t("div",{staticClass:"p-20"},[t("el-button",{staticClass:"m-b-20",attrs:{type:"primary",icon:"el-icon-plus",round:"",size:"small"},on:{click:n.addFn}},[n._v("新增垂媒账号")]),n._v(" "),t("data-table",{ref:"DataTableRef",attrs:{table:n.dataTable},on:{searchTable:n.searchTable,onHandleSelectionChange:n.handleSelectionChange},scopedSlots:n._u([{key:"account",fn:function(e){return n._l(e.obj.row.account,function(e,a){return t("div",{key:a,staticClass:"media-wrap"},[t("span",{staticClass:"dot",class:[1==e.status?"green":"red"]}),n._v("\n                    "+n._s(n._f("filterBlank")(e.type_text))+"\n                ")])})}},{key:"caozuo",fn:function(e){return[t("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(t){return n.view(e.obj.row)}}},[n._v("查看详情")]),n._v(" "),t("el-button",{staticClass:"red_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(t){return n.deleteMedia(e.obj.row)}}},[n._v("删除")])]}}])})],1),n._v(" "),n.showMedia?t("add-media",{attrs:{info:n.mediaInfo,type:n.showType,shopList:n.search.list[n.search.shop].selectOptions,mediaOptions:n.search.list[n.search.media].selectOptions},on:{close:n.closeMedieFn}}):n._e()],1)};C._withStripped=!0;var y={render:C,staticRenderFns:[]},v=y;var _=!1;var w=t("C7Lr")(b,v,!1,function(n){_||(t("2W8H"),t("1GUu"))},"data-v-30e31ec2",null);w.options.__file="src/pages/call-center/media/MediaManage.vue";e.default=w.exports},Q4J1:function(n,e,t){(n.exports=t("UTlt")(!0)).push([n.i,"\n.media-wrap[data-v-30e31ec2]{display:inline-block;margin-right:15px\n}\n.dot[data-v-30e31ec2]{display:inline-block;width:10px;height:10px;border:1px solid #eee;border-radius:50%\n}\n.red[data-v-30e31ec2]{background-color:#ea5a54\n}\n.green[data-v-30e31ec2]{background-color:#34b572\n}\n","",{version:3,sources:["D:/liu/vue-project/MyTest/src/pages/call-center/media/D:/liu/vue-project/MyTest/src/pages/call-center/media/MediaManage.vue"],names:[],mappings:";AA2PA,6BACI,qBACA,iBAAkB;CACrB;AAAA,sBAEG,qBACA,WACA,YACA,sBACA,iBAAkB;CACrB;AAAA,sBAEG,wBAAyB;CAC5B;AAAA,wBAEG,wBAAyB;CAC5B",file:"MediaManage.vue",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.media-wrap {\r\n    display:inline-block;\r\n    margin-right: 15px;\r\n}\r\n.dot {\r\n    display: inline-block;\r\n    width: 10px;\r\n    height: 10px;\r\n    border: 1px solid #eee;\r\n    border-radius: 50%;\r\n}\r\n.red {\r\n    background-color: #ea5a54;\r\n}\r\n.green {\r\n    background-color: #34b572;\r\n}\r\n\r\n\r\n"],sourceRoot:""}])},QCNg:function(n,e,t){var a=t("VQn5");"string"==typeof a&&(a=[[n.i,a,""]]),a.locals&&(n.exports=a.locals);t("FIqI")("20961c4d",a,!1,{})},VQn5:function(n,e,t){(n.exports=t("UTlt")(!0)).push([n.i,"\n.add-media-dialog[data-v-5375657d] .el-dialog__body{margin-top:8px;padding:25px 30px 33px;min-height:250px\n}\n.add-media-dialog[data-v-5375657d] .el-dialog__footer{padding:10px 0 30px\n}\n.el-form-item[data-v-5375657d]{margin-bottom:15px\n}\n.el-form-item.add-item[data-v-5375657d]{margin-bottom:0\n}\n.el-form-item[data-v-5375657d] .el-form-item__label{padding-right:20px\n}\n.view .title[data-v-5375657d]{font-size:18px;color:#444\n}\n.media-wrap[data-v-5375657d]{display:inline-block;margin-right:15px\n}\n.dot[data-v-5375657d]{display:inline-block;width:10px;height:10px;border:1px solid #eee;border-radius:50%\n}\n.red[data-v-5375657d]{background-color:#ea5a54\n}\n.green[data-v-5375657d]{background-color:#34b572\n}\n.custom-table[data-v-5375657d]{border-left:1px solid #EBEEF5;border-bottom:1px solid #EBEEF5\n}\n.custom-table .tr-item[data-v-5375657d]{height:75px;line-height:75px\n}\n.custom-table .td-item[data-v-5375657d]{border-right:1px solid #EBEEF5;border-top:1px solid #EBEEF5;padding:0 20px 0 0\n}\n.custom-table .tr-item .el-form-item[data-v-5375657d]{margin-bottom:0\n}\n.el-icon-delete[data-v-5375657d]{color:#3d7eff;font-size:20px\n}\n","",{version:3,sources:["D:/liu/vue-project/MyTest/src/pages/call-center/media/D:/liu/vue-project/MyTest/src/pages/call-center/media/AddMedia.vue"],names:[],mappings:";AAqRA,oDACI,eACA,uBACA,gBAAiB;CACpB;AAAA,sDAGG,mBAAoB;CACvB;AAAA,+BAGG,kBAAmB;CACtB;AAAA,wCAEG,eAAgB;CACnB;AAAA,oDAEG,kBAAmB;CACtB;AAAA,8BAIA,eACG,UAAW;CACd;AAAA,6BAGG,qBACA,iBAAkB;CACrB;AAAA,sBAEG,qBACA,WACA,YACA,sBACA,iBAAkB;CACrB;AAAA,sBAEG,wBAAyB;CAC5B;AAAA,wBAEG,wBAAyB;CAC5B;AAAA,+BAGG,8BACA,+BAAgC;CACnC;AAAA,wCAEG,YACA,gBAAiB;CACpB;AAAA,wCAGG,+BACA,6BACA,kBAAmB;CACtB;AAAA,sDAGG,eAAgB;CACnB;AAAA,iCAEG,cACA,cAAe;CAClB",file:"AddMedia.vue",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.add-media-dialog /deep/.el-dialog__body {\r\n    margin-top: 8px;\r\n    padding: 25px 30px 33px;\r\n    min-height: 250px;\r\n}\r\n\r\n.add-media-dialog /deep/.el-dialog__footer {\r\n    padding: 10px 0 30px;\r\n}\r\n\r\n.el-form-item {\r\n    margin-bottom: 15px;\r\n}\r\n.el-form-item.add-item{\r\n    margin-bottom: 0;\r\n}\r\n.el-form-item /deep/.el-form-item__label{\r\n    padding-right: 20px;\r\n}\r\n\r\n.view .title {\r\n    // font-family: PingFang-SC-Bold;\r\n\tfont-size: 18px;\r\n    color: #444;\r\n}\r\n\r\n.media-wrap {\r\n    display:inline-block;\r\n    margin-right: 15px;\r\n}\r\n.dot {\r\n    display: inline-block;\r\n    width: 10px;\r\n    height: 10px;\r\n    border: 1px solid #eee;\r\n    border-radius: 50%;\r\n}\r\n.red {\r\n    background-color: #ea5a54;\r\n}\r\n.green {\r\n    background-color: #34b572;\r\n}\r\n\r\n.custom-table {\r\n    border-left: 1px solid #EBEEF5;\r\n    border-bottom: 1px solid #EBEEF5;\r\n}\r\n.custom-table .tr-item {\r\n    height: 75px;\r\n    line-height: 75px;\r\n} \r\n\r\n.custom-table .td-item {\r\n    border-right: 1px solid #EBEEF5;\r\n    border-top: 1px solid #EBEEF5;\r\n    padding: 0 20px 0 0;\r\n} \r\n\r\n.custom-table .tr-item .el-form-item {\r\n    margin-bottom: 0;\r\n}\r\n.el-icon-delete {\r\n    color: #3d7eff;\r\n    font-size: 20px;\r\n}\r\n"],sourceRoot:""}])},z06c:function(n,e,t){(n.exports=t("UTlt")(!0)).push([n.i,"\n.mediaDeleteWidth.needCenterStyle .el-message-box__status+.el-message-box__message {\r\n    width: 260px;\r\n    margin: 0 auto;\n}\r\n","",{version:3,sources:["D:/liu/vue-project/MyTest/src/pages/call-center/media/src/pages/call-center/media/MediaManage.vue"],names:[],mappings:";AAgRA;IACA,aAAA;IACA,eAAA;CACA",file:"MediaManage.vue",sourcesContent:['<template>\r\n    <div class="media-manage-page m-20 common-box">\r\n        <search-bar size="medium" class="m-t-10 p-20" @clear="clear" @find="find">\r\n            <div class="search-flex">\r\n                \x3c!-- search-col通过search.key来判断是哪个选项；search-col用for循环，需要自定义的可以通过 search.key == index 来确定自定义的那一列，如<search-col><div slot="custom" v-if="search.key==index"></div></search-col>--\x3e\r\n                <search-col :info="search.list[search.shop]" filterable></search-col>\r\n                <search-col :info="search.list[search.media]" filterable></search-col>\r\n                <search-col :info="search.list[search.state]"></search-col>\r\n                <search-col :info="search.list[search.time]" type="daterange" range-separator="至" start-placeholder="开始日期" end-placeholder="结束日期" value-format="yyyy-MM-dd"></search-col>\r\n            </div>\r\n        </search-bar>\r\n\r\n        <div class="p-20">\r\n            <el-button type="primary" icon="el-icon-plus" round size="small" @click="addFn" class="m-b-20">新增垂媒账号</el-button>\r\n            <data-table ref="DataTableRef" :table="dataTable" @searchTable=\'searchTable\' @onHandleSelectionChange="handleSelectionChange"> \r\n                <template slot-scope="props" slot="account">\r\n                    <div class="media-wrap" v-for="(item, index) in props.obj.row.account" :key="index">\r\n                        <span class="dot" :class="[item.status ==1?\'green\':\'red\']"></span>\r\n                        {{ item.type_text | filterBlank }}\r\n                    </div>\r\n                </template> \r\n\r\n                <template slot-scope="props" slot="caozuo">\r\n                    <el-button class="blue_font_white_bg" plain round size="mini" @click="view(props.obj.row)">查看详情</el-button>\r\n                    <el-button class="red_font_white_bg"  plain round size="mini" @click="deleteMedia(props.obj.row)">删除</el-button>\r\n                </template> \r\n            </data-table>\r\n        </div>\r\n\r\n        <add-media \r\n            v-if="showMedia" \r\n            :info="mediaInfo" \r\n            :type="showType" \r\n            :shopList="search.list[search.shop].selectOptions" \r\n            :mediaOptions="search.list[search.media].selectOptions"\r\n            @close="closeMedieFn">\r\n        </add-media>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport SearchBar from \'@/components/SearchBar\';\r\nimport SearchCol from \'@/components/form/SearchCol\';\r\nimport DataTable from "@/components/dataTable/table";\r\nimport AddMedia  from \'./AddMedia\'\r\nimport SearchMixins from \'@/pages/mixins/SearchMixins\'\r\nexport default {\r\n    components: {\r\n        SearchBar,\r\n        SearchCol,\r\n        DataTable,\r\n        AddMedia\r\n    },\r\n    mixins: [SearchMixins],\r\n    data(){\r\n        return{\r\n            showMedia: false, // 新增弹窗\r\n            showType: \'add\',\r\n            mediaInfo: {},\r\n        }\r\n    },\r\n    created(){\r\n        this.initData();\r\n        this.queryData();\r\n    },\r\n    methods: {\r\n        initData(){\r\n            this.initSearch(); // 初始化搜索列\r\n            this.initTable();\r\n            this.initMediaOptions();\r\n        },\r\n        initSearch(){\r\n            // 使用key防止在数组中间插入一列后，只要改变key的下标值就可以\r\n            this.search = { \r\n                list: [\r\n                    {\r\n                        type: \'select\', \r\n                        label: \'门店\', \r\n                        currentVal: \'\', \r\n                        isAll:true,\r\n                        isAllTitle: \'全部\',\r\n                        selectOptions:[], \r\n                        optionLabel:\'title\', \r\n                        optionValue:"id", \r\n                    },{\r\n                        type: \'select\', \r\n                        label: \'垂媒\', \r\n                        currentVal: \'\', \r\n                        isAll:true,\r\n                        isAllTitle: \'全部\',\r\n                        selectOptions:[], \r\n                        optionLabel:\'text\', \r\n                        optionValue:"val", \r\n                    },{\r\n                        type: \'select\', \r\n                        label: \'状态\', \r\n                        currentVal: \'\',\r\n                        isAll:true,\r\n                        isAllTitle: \'全部\', \r\n                        selectOptions:[], \r\n                        optionLabel:\'text\', \r\n                        optionValue:"val", \r\n                    },{\r\n                        type: \'datePicker\', \r\n                        label: \'更新时间\', \r\n                        currentVal: \'\', \r\n                    }\r\n                ],\r\n                shop: 0, // 任务名称\r\n                media: 1, // 任务内容\r\n                state: 2, // 状态\r\n                time: 3, // 任务技术时间\r\n            }\r\n        },\r\n        initMediaOptions(){\r\n            this.$fetch.callCenter.mediaAccountOptions({}).then((res)=>{\r\n                this.$handleResponse(res, res=>{\r\n                    this.search.list[this.search.media].selectOptions = this.$hasArrContent(res.type)?res.type:[];\r\n                    this.search.list[this.search.state].selectOptions = this.$hasArrContent(res.status)?res.status:[];\r\n                }, false);\r\n            })\r\n\r\n            this.$fetch.common.commonAreaList({},false).then((res)=>{\r\n                this.$handleResponse(res, res=>{\r\n                    if(this.$hasArrContent(res)){\r\n                        res.forEach((item)=>{ item.id = parseInt(item.id?item.id:0)}); // 把字符串改为数字\r\n                        this.search.list[this.search.shop].selectOptions =res;\r\n                    }\r\n                }, false);\r\n            })\r\n        },\r\n        initTable(){\r\n            this.dataTable = {\r\n                tr: [{\r\n                      id: \'1\',\r\n                      label: \'门店\',\r\n                      prop: \'short_name\',\r\n                      tooltip:true,\r\n                      align: \'center\'\r\n                    },{\r\n                      id: \'2\',\r\n                      label: \'垂媒\',\r\n                      prop: \'account\',\r\n                      show:\'template\',\r\n                      tooltip:true,\r\n                      align: \'center\'\r\n                    },{\r\n                      id: \'3\',\r\n                      label: \'更新时间\',\r\n                      prop: \'last_update\',\r\n                      tooltip: true,\r\n                      align: \'center\'\r\n                    },{\r\n                      id: \'4\',\r\n                      label: \'操作\',\r\n                      prop: \'caozuo\',\r\n                      show:\'template\',\r\n                      minWidth: \'130\',\r\n                      align: \'center\'\r\n                    },\r\n                ],\r\n                data: [],\r\n                page: {\r\n                    totalCount: 0,\r\n                    pageSize: 20,\r\n                    currentPage: 1\r\n                },\r\n                border: true, // 是否带边框\r\n                hasSelect: false, //是否有复选框\r\n                hasExpand: false, //是否有收缩功能\r\n                hasFirstPagination: false, //是否有第一条分页条\r\n                search: {\r\n                    value:\'\',\r\n                    show: false,\r\n                    width: "300", //快捷搜索输入框宽度\r\n                    placeholder: "请输入手机号、客户微信", //快捷搜索输入框提示文字\r\n                    displayCol: ["name","tel"], //弹出需要显示的列\r\n                    parma: {\r\n                      id: ""\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        getParams(){\r\n            const { currentPage, pageSize } = this.dataTable.page;\r\n            const { shop, media, state, time,  list } = this.search;\r\n            let params = {\r\n                area_id: list[shop].currentVal,      // 门店id\r\n                type: list[media].currentVal,        // 垂媒账号类型 1懂车帝 2太平洋 3易车 4汽车之家\'\r\n                status: list[state].currentVal,      // 账号状态 0异常，1正常\r\n                update_date_start: list[time].currentVal && list[time].currentVal[0], // 线索获取开始时间\r\n                update_date_end: list[time].currentVal && list[time].currentVal[1],  // 线索获取结束时间\r\n                pre_page: pageSize,     // 每页数量\r\n                page: currentPage,          // 当前页\r\n            }\r\n            return params;\r\n        },\r\n        queryData(){\r\n            let that = this;\r\n            let params = this.getParams();\r\n            this.$fetch.callCenter.mediaAccountList(params).then((res)=>{\r\n                this.$handleResponse(res, res=>{\r\n                    that.dataTable.data = res.list?res.list:[]; //表格所需数据\r\n                    that.dataTable.page = res.page?res.page:that.dataTable.page; //表格所需页面\r\n                },true);\r\n            }).catch(()=>{\r\n                this.$store.commit(\'closeLoading\');\r\n            })\r\n        },\r\n        deleteMedia(item){\r\n            let that = this;\r\n            this.$confirm("删除账号后，垂媒的线索无法同步至系统,是否确定要删除?", "提示", {\r\n                confirmButtonText: "确定",\r\n                cancelButtonText: "取消",\r\n                type: "warning",\r\n                customClass: "needCenterStyle mediaDeleteWidth",\r\n                cancelButtonClass: "big cancel",\r\n                confirmButtonClass: "big",\r\n                roundButton: true,\r\n            }).then(() => {\r\n                this.$fetch.callCenter.mediaAccountDel({\'id\': item.id}).then((res)=>{\r\n                    this.$handleResponse(res, res=>{\r\n                        this.$message.success(\'删除成功\');\r\n                        this.queryData();\r\n                    },true);\r\n                }).catch(()=>{\r\n                    this.$store.commit(\'closeLoading\');\r\n                })\r\n            })\r\n        },\r\n        addFn(){\r\n            this.showType = \'add\';\r\n            this.mediaInfo = {};\r\n            this.showMedia = true;\r\n        },\r\n        view(item){\r\n            this.showType = \'view\';\r\n            this.mediaInfo = Object.assign({},item);\r\n            this.showMedia = true;\r\n        },\r\n        closeMedieFn(type){\r\n            this.showMedia = false;\r\n            if(type == \'success\'){\r\n                this.queryData();\r\n            }\r\n        }\r\n    }\r\n}\r\n<\/script>\r\n\r\n<style lang="scss" scoped>\r\n.media-wrap {\r\n    display:inline-block;\r\n    margin-right: 15px;\r\n}\r\n.dot {\r\n    display: inline-block;\r\n    width: 10px;\r\n    height: 10px;\r\n    border: 1px solid #eee;\r\n    border-radius: 50%;\r\n}\r\n.red {\r\n    background-color: #ea5a54;\r\n}\r\n.green {\r\n    background-color: #34b572;\r\n}\r\n\r\n\r\n</style>\r\n<style>\r\n.mediaDeleteWidth.needCenterStyle .el-message-box__status+.el-message-box__message {\r\n    width: 260px;\r\n    margin: 0 auto;\r\n}\r\n</style>\r\n\r\n'],sourceRoot:""}])}});
//# sourceMappingURL=18.9aad4031c56da0db615d.js.map