webpackJsonp([29],{kZda:function(t,e){},ruhI:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={components:{ScrmFormItem:s("kfhN").a},data:function(){return{sourceList:[],defaultProps:{children:"children",label:"title"},dialog:{show:!1,title:"新增",label:"一级线索",value:"",row:{}},expandKeys:[]}},created:function(){this.queryData()},methods:{initTestData:function(){this.sourceList=[{name:"微信",parent_id:0,status:1,id:1,showSub:!0,sub:[{name:"个人二维码地方嘎达",parent_id:1,id:12,status:0},{name:"客流二维码",parent_id:1,id:13,status:0},{name:"推广二维码",parent_id:1,status:0,id:14}]},{name:"自行添加",parent_id:0,status:1,id:2}]},queryData:function(){var t=this;this.$fetch.callCenter.clueFrom({}).then(function(e){t.$handleResponse(e,function(e){t.sourceList=e,t.statusBoolean(t.sourceList)},!0)}).catch(function(){t.$store.commit("closeLoading")})},statusBoolean:function(t){var e=this;this.$hasArrContent(t)&&t.forEach(function(t){t.status=!!t.status,t.children&&e.statusBoolean(t.children)})},addFn:function(t){this.dialog.title="新增",this.dialog.value="",this.dialog.label=t&&t.id?"二级来源":"一级来源",this.dialog.row=this.$deepCopyContent(t),this.dialog.show=!0},edit:function(t){this.dialog.title="编辑",this.dialog.value=t.title,this.dialog.label=t.pid?"二级来源":"一级来源",this.dialog.row=this.$deepCopyContent(t),this.dialog.show=!0},saveFn:function(){var t=this;this.dialog.value?"新增"==this.dialog.title?this.$fetch.callCenter.createClueFrom({title:this.dialog.value,pid:this.dialog.row.id}).then(function(e){t.$handleResponse(e,function(e){t.dialog.show=!1,t.$message.success("新增成功"),t.queryData()},!0)}).catch(function(){t.$store.commit("closeLoading")}):this.$fetch.callCenter.updateClueFrom({title:this.dialog.value,id:this.dialog.row.id}).then(function(e){t.$handleResponse(e,function(e){t.dialog.show=!1,t.$message.success("编辑成功"),t.queryData()},!0)}).catch(function(){t.$store.commit("closeLoading")}):this.$message.error("请输入内容")},changeState:function(t){var e=this;this.$fetch.callCenter.toggleClueFrom({status:t.status?1:0,id:t.id}).then(function(t){e.$handleResponse(t,function(t){e.dialog.show=!1,e.$message.success("编辑成功"),e.queryData()},!0)}).catch(function(){e.$store.commit("closeLoading")})},deleteFn:function(t){var e=this,s="你确定要删除该"+(t.pid?"二级":"一级")+"来源吗";this.$confirm(s,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"needCenterStyle",cancelButtonClass:"big cancel",confirmButtonClass:"big",roundButton:!0}).then(function(){e.$fetch.callCenter.deleteClueFrom({id:t.id}).then(function(t){e.$handleResponse(t,function(t){e.$message.success("删除成功"),e.queryData()},!0)}).catch(function(){e.$store.commit("closeLoading")})})},cancel:function(){this.dialog.show=!1},nodeExpandFn:function(t){this.expandKeys.push(t.id)},nodeCollapseFn:function(t){this.expandKeys=this.expandKeys.filter(function(e){return e!=t.id})}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"param-source-setting m-20 common-box min-h-750"},[s("div",{staticClass:"title line"},[t._v("线索/客户来源设置")]),t._v(" "),s("div",{staticClass:"p-30"},[s("el-button",{staticClass:"m-b-30 w-90",attrs:{round:"",icon:"el-icon-plus",size:"small",type:"primary"},on:{click:function(e){return t.addFn({})}}},[t._v("新增")]),t._v(" "),s("div",{staticClass:"box-wrap"},[s("el-tree",{ref:"tagTree",attrs:{data:t.sourceList,props:t.defaultProps,"default-expanded-keys":t.expandKeys,"node-key":"id","expand-on-click-node":!1,"icon-class":"el-icon-arrow-right"},on:{"node-expand":t.nodeExpandFn,"node-collapse":t.nodeCollapseFn},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node,i=e.data;return s("div",{staticClass:"custom-tree-node flex-1 flex"},[s("div",{staticClass:"flex-1 p-r-20"},[t._v(t._s(a.label))]),t._v(" "),s("div",{staticClass:"w-300"},[s("el-switch",{staticClass:"switch-scrm",attrs:{disabled:!!i.isSystem,"active-text":"ON","inactive-text":"OFF"},on:{change:function(e){return t.changeState(i)}},model:{value:i.status,callback:function(e){t.$set(i,"status",e)},expression:"data.status"}})],1),t._v(" "),s("div",{staticClass:"w-250"},[s("el-button",{attrs:{type:"text",disabled:!!i.isSystem},on:{click:function(e){return t.edit(i)}}},[t._v("编辑")]),t._v(" "),0==i.pid?s("el-button",{staticClass:"btn-split",attrs:{type:"text"},on:{click:function(e){return t.addFn(i)}}},[t._v("新增二级来源")]):t._e(),t._v(" "),s("el-button",{staticClass:"btn-split",class:{red_font:!i.isSystem},attrs:{type:"text",disabled:!!i.isSystem},on:{click:function(e){return t.deleteFn(i)}}},[t._v("删除")])],1)])}}])})],1)],1),t._v(" "),s("el-dialog",{staticClass:"add-source-dialog",attrs:{title:t.dialog.title,visible:t.dialog.show,width:"470px","append-to-body":"","close-on-click-modal":!1,"before-close":t.cancel},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[s("el-form",{ref:"form",attrs:{"label-width":"80px"}},[s("scrm-form-item",{attrs:{itemLabel:t.dialog.label,itemType:"input",subClass:"w-100-percent",maxlength:"16",placeholder:"请输入内容，最多16个字符",itemInfo:t.dialog,itemKey:"value"}})],1),t._v(" "),s("span",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"w-90",attrs:{round:"",size:"small"},on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),s("el-button",{staticClass:"w-90",attrs:{round:"",size:"small",type:"primary"},on:{click:t.saveFn}},[t._v(" 确定")])],1)],1)],1)},staticRenderFns:[]};var n=s("VU/8")(a,i,!1,function(t){s("kZda")},"data-v-f4bde81a",null);e.default=n.exports}});
//# sourceMappingURL=29.9438df384bf6f8ae02cb.js.map