webpackJsonp([26],{ifev:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("IaGi"),i=a("ufHF"),n=a("kfhN"),o={props:{rowItem:{type:Object,default:function(){return{}}}},components:{ScrmFormItem:n.a},data:function(){return{loading:!1,dialogVisible:!0,title:"添加坐席",seatOptions:[],form:{dccId:"",dccTel:"",seatId:"",roleName:""},userOptions:[]}},created:function(){if("edit"==this.rowItem.type){this.title="编辑坐席";var e=this.rowItem.row;this.form.id=e.id,this.form.dccId=e.dccId,this.form.dccTel=e.dccTel,this.form.roleName=e.roleName,this.form.seatId=e.seatNumberId}this.initAdd()},methods:{initAdd:function(){var e=this,t=this.rowItem,a=t.type,s=t.row;this.$fetch.callCenter.initFormSeat().then(function(t){e.$handleResponse(t,function(t){e.seatOptions=e.$hasArrContent(t.seatNumber)?t.seatNumber:[],"edit"==a&&e.seatOptions.unshift({id:s.seatNumberId,tel:s.seatTel?s.seatTel:"--"})},!0)}).catch(function(){e.$store.commit("closeLoading")}),this.getUserList()},getUserList:function(){var e=this;this.loading=!0,this.$fetch.callCenter.seatDccSelectList().then(function(t){e.loading=!1,e.$handleResponse(t,function(t){var a=e.$hasArrContent(t)?t:[],s=e.rowItem,i=s.type,n=s.row;"edit"==i&&(e.checkOptionsHasId(n.dccId,a,"id")||e.userOptions.push({id:n.dccId,nickname:n.dccName?n.dccName:"--",tel:n.dccTel,roleName:n.roleName})),e.userOptions=e.userOptions.concat(a),e.userObj={},e.userOptions&&e.userOptions.length&&e.userOptions.forEach(function(t){e.userObj[t.id]=t})},!1)}).catch(function(t){e.loading=!1})},checkOptionsHasId:function(e,t,a){var s=!1;if(e>-1)for(var i=0;i<t.length;i++)if(t[i][a]==e){s=!0;break}return s},dccChange:function(){this.form.dccTel=this.userObj[this.form.dccId].tel,this.form.roleName=this.userObj[this.form.dccId].roleName},getParams:function(){var e=this.form,t=e.dccId,a=e.seatId,s=e.id;return t?a?{dccId:t,seatNumberId:a,id:s}:(this.$message.error("绑定坐席号码不为空"),!1):(this.$message.error("DCC邀约员不为空"),!1)},addFn:function(){var e=this,t=this.getParams();if(t){this.loading=!0;var a="add"==this.rowItem.type?"createSeat":"updateSeat";this.$fetch.callCenter[a](t).then(function(t){e.loading=!1,e.$handleResponse(t,function(t){e.$message.success(("add"==e.rowItem.type?"新增":"编辑")+"成功"),e.$emit("close","success")},!0)}).catch(function(){e.loading=!1,e.$store.commit("closeLoading")})}},cancel:function(){this.$emit("close","cancel")}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"add-seat-dialog",attrs:{title:e.title,visible:e.dialogVisible,width:"550px","append-to-body":"","close-on-click-modal":!1,"before-close":e.cancel},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{"label-width":"120px"}},[a("scrm-form-item",{attrs:{itemLabel:"姓名",itemType:"select",itemRequired:!0,itemClass:"form_required_after",subClass:"w-100-percent",placeholder:"请选择",itemInfo:e.form,itemKey:"dccId",filterable:!0,selectOptions:e.userOptions,optionLabel:"nickname",optionValue:"id"},on:{change:e.dccChange}}),e._v(" "),a("scrm-form-item",{attrs:{itemLabel:"手机号",itemType:"input",itemRequired:!0,itemClass:"form_required_after",subClass:"w-100-percent",placeholder:"请选择",itemInfo:e.form,itemKey:"dccTel",disabled:!0}}),e._v(" "),a("el-form-item",{staticClass:"form_required_after",attrs:{label:"角色",required:!0}},[e._v("\n            "+e._s(e._f("filterBlank")(e.form.roleName))+"\n        ")]),e._v(" "),a("scrm-form-item",{attrs:{itemLabel:"绑定坐席号码",itemType:"select",itemRequired:!0,itemClass:"form_required_after",subClass:"w-100-percent",placeholder:"请选择",itemInfo:e.form,itemKey:"seatId",filterable:!0,selectOptions:e.seatOptions,optionLabel:"tel",optionValue:"id"}})],1),e._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"w-90",attrs:{round:"",size:"small"},on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"w-90",attrs:{round:"",size:"small",type:"primary",disabled:e.loading},on:{click:e.addFn}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var c=a("VU/8")(o,r,!1,function(e){a("qN1r")},"data-v-5a410bc4",null).exports,l=a("PdD4"),d={components:{SearchCol:s.a,DataTable:i.a,AddSeat:c},mixins:[l.a],data:function(){return{seatInfo:{show:!1,type:"add",row:{}}}},created:function(){this.initData(),this.queryData()},methods:{initData:function(){this.initSearch(),this.initTable()},initSearch:function(){var e=this;this.search={list:[{type:"input",label:"关键字",currentVal:""},{type:"select",label:"坐席组",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[],optionLabel:"title",optionValue:"id"}],keyword:0,groupSeat:1},this.$fetch.callCenter.seatListOption({}).then(function(t){e.$handleResponse(t,function(t){e.search.list[e.search.groupSeat].selectOptions=e.$hasArrContent(t.dccGroup)?t.dccGroup:[]},!1)})},initTable:function(){this.dataTable={tr:[{id:"1",label:"坐席号",prop:"thirdSeatId",align:"center"},{id:"2",label:"姓名",prop:"dccNickname",tooltip:!0,align:"center"},{id:"3",label:"角色",prop:"roleName",tooltip:!0,align:"center"},{id:"4",label:"手机号",prop:"dccTel",tooltip:!0,align:"center"},{id:"5",label:"所属坐席组",prop:"dccGroupTitle",tooltip:!0,align:"center"},{id:"6",label:"坐席电话",prop:"seatTel",tooltip:!0,align:"center"},{id:"7",label:"操作",prop:"caozuo",show:"template",minWidth:"120",align:"center"}],data:[],page:{totalCount:0,pageSize:20,currentPage:1},border:!0,hasSelect:!1,hasExpand:!1,hasFirstPagination:!0,lastPageLayout:"sizes, prev, pager, next",search:{}}},getParams:function(){var e=this.dataTable.page,t=e.currentPage,a=e.pageSize,s=this.search,i=s.keyword,n=s.groupSeat,o=s.list;return{kwd:o[i].currentVal,dccGroupId:o[n].currentVal,pageSize:a,page:t}},queryData:function(){var e=this,t=this,a=this.getParams();this.$fetch.callCenter.seatList(a).then(function(a){e.$handleResponse(a,function(e){t.dataTable.data=e.list?e.list:[],t.dataTable.page=e.page?e.page:t.dataTable.page},!0)}).catch(function(){e.$store.commit("closeLoading")})},handleFn:function(e,t){this.seatInfo.type=e,this.seatInfo.row=t,this.seatInfo.show=!0},closeSeat:function(e){"success"==e&&this.queryData(),this.seatInfo.show=!1}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"seat-setting-page m-20 common-box "},[a("div",{staticClass:"search-flex search-wrap"},[a("search-col",{staticClass:"seat-search",attrs:{info:e.search.list[e.search.keyword],placeholder:"DCC邀约员/手机号/坐席号"}}),e._v(" "),a("search-col",{staticClass:"seat-search",attrs:{info:e.search.list[e.search.groupSeat],placeholder:"请选择"}}),e._v(" "),a("search-col",{staticClass:"seat-search-btn",attrs:{leftCol:0,rightCol:24}},[a("div",{attrs:{slot:"custom"},slot:"custom"},[a("el-button",{staticClass:"m-l-30 w-110",attrs:{round:"",icon:"el-icon-search",size:"small",type:"primary"},on:{click:e.find}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{round:"",icon:"el-icon-delete",size:"small",plain:""},on:{click:e.clear}},[e._v("清空查询条件")])],1)])],1),e._v(" "),a("div",{staticClass:"separate-line w-100-percent"}),e._v(" "),a("div",{staticClass:"p-l-r-20 m-b-20"},[a("data-table",{ref:"DataTableRef",staticClass:"table-cyan",attrs:{table:e.dataTable},on:{searchTable:e.searchTable},scopedSlots:e._u([{key:"caozuo",fn:function(t){return[a("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(a){return e.handleFn("edit",t.obj.row)}}},[e._v("编辑")])]}}])},[a("div",{attrs:{slot:"buttons"},slot:"buttons"},[a("el-button",{staticClass:"m-b-20",attrs:{round:"",icon:"el-icon-plus",size:"small",type:"primary"},on:{click:function(t){return e.handleFn("add",{})}}},[e._v("新增坐席")])],1)])],1),e._v(" "),e.seatInfo.show?a("add-seat",{attrs:{rowItem:e.seatInfo},on:{close:e.closeSeat}}):e._e()],1)},staticRenderFns:[]};var h=a("VU/8")(d,u,!1,function(e){a("tPmJ")},"data-v-30cc8850",null);t.default=h.exports},qN1r:function(e,t){},tPmJ:function(e,t){}});
//# sourceMappingURL=26.4a7bb3f0ca691c23b5dc.js.map