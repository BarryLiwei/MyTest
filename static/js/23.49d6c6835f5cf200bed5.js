webpackJsonp([23],{P7v6:function(n,e,t){(n.exports=t("FZ+f")(!0)).push([n.i,"\n.top-title[data-v-f2d5e088]{color:#444;font-size:20px;padding-left:20px;font-weight:600;height:60px;line-height:60px;background-color:#fafcff;border-bottom:solid 1px #eaebf0\n}\n.setting-role-page[data-v-f2d5e088] .top-pagination{display:none\n}\n[data-v-f2d5e088] .export-log-btn.el-col-6{width:290px\n}\n","",{version:3,sources:["D:/liu/vue-project/MyTest/src/pages/setting/role/D:/liu/vue-project/MyTest/src/pages/setting/role/Role.vue"],names:[],mappings:";AAqOA,4BACI,WACA,eACA,kBACA,gBACA,YACA,iBACA,yBACA,+BAAgC;CACnC;AAAA,oDAGG,YAAa;CAChB;AAAA,2CAGG,WAAY;CACf",file:"Role.vue",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.top-title {\r\n    color: #444;\r\n    font-size: 20px;\r\n    padding-left: 20px;\r\n    font-weight: 600;\r\n    height: 60px;\r\n    line-height: 60px;\r\n    background-color: #fafcff;\r\n    border-bottom: solid 1px #eaebf0;\r\n}\r\n\r\n.setting-role-page /deep/ .top-pagination {\r\n    display: none;\r\n}\r\n\r\n/deep/ .export-log-btn.el-col-6 {\r\n    width: 290px;\r\n}\r\n"],sourceRoot:""}])},XxI3:function(n,e,t){var i=t("P7v6");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("rjj0")("48214955",i,!1,{})},YDEO:function(n,e,t){(n.exports=t("FZ+f")(!0)).push([n.i,"\n.view-role-dialog[data-v-e7be9afe] .el-dialog__body{padding:20px 35px 20px 20px\n}\n.view-role-dialog[data-v-e7be9afe] .el-dialog__footer{padding-bottom:35px\n}\n.view-role-dialog[data-v-e7be9afe] .el-form-item{margin-bottom:10px\n}\n.box-wrap[data-v-e7be9afe]{border-left:1px solid #ddd;border-top:1px solid #ddd\n}\n.box-item[data-v-e7be9afe]{font-size:14px;color:#444;border-right:1px solid #ddd;border-bottom:1px solid #ddd\n}\n.box-left[data-v-e7be9afe]{height:50px;line-height:50px\n}\n.box-right[data-v-e7be9afe]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center\n}\n.box-right-p[data-v-e7be9afe]{color:#9ba6b6;line-height:25px;padding:12px 0\n}\n.user-table[data-v-e7be9afe]{width:100%\n}\n.el-table[data-v-e7be9afe] .el-table__header .has-gutter tr th{height:30px;line-height:25px\n}\n","",{version:3,sources:["D:/liu/vue-project/MyTest/src/pages/setting/role/D:/liu/vue-project/MyTest/src/pages/setting/role/ViewRole.vue"],names:[],mappings:";AAsKA,oDACI,2BAA4B;CAC/B;AAAA,sDAGG,mBAAoB;CACvB;AAAA,iDAGG,kBAAmB;CACtB;AAAA,2BAGG,2BACA,yBAA0B;CAC7B;AAAA,2BAEG,eACA,WAEA,4BACA,4BAA6B;CAChC;AAAA,2BAEG,YACA,gBAAiB;CACpB;AAAA,4BAGG,oBAAA,oBAAA,aACA,yBAAA,sBAAA,kBAAmB;CACtB;AAAA,8BAGG,cACA,iBACA,cAAe;CAClB;AAAA,6BAIG,UAAW;CACd;AAAA,+DAEG,YACA,gBAAiB;CACpB",file:"ViewRole.vue",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.view-role-dialog /deep/.el-dialog__body {\r\n    padding: 20px 35px 20px 20px;\r\n}\r\n\r\n.view-role-dialog /deep/.el-dialog__footer {\r\n    padding-bottom: 35px;\r\n}\r\n\r\n.view-role-dialog /deep/ .el-form-item {\r\n    margin-bottom: 10px;\r\n}\r\n\r\n.box-wrap {\r\n    border-left: 1px solid #ddd;\r\n    border-top: 1px solid #ddd;\r\n}\r\n.box-item {\r\n    font-size: 14px;\r\n    color: #444;\r\n    \r\n    border-right: 1px solid #ddd;\r\n    border-bottom: 1px solid #ddd;\r\n}\r\n.box-left {\r\n    height: 50px;\r\n    line-height: 50px;\r\n}\r\n\r\n.box-right {\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.box-right-p {\r\n    color: #9ba6b6;\r\n    line-height: 25px;\r\n    padding: 12px 0;\r\n}\r\n\r\n\r\n.user-table {\r\n    width: 100%;\r\n}\r\n.el-table /deep/ .el-table__header .has-gutter tr th{\r\n    height: 30px;\r\n    line-height: 25px;\r\n}\r\n\r\n"],sourceRoot:""}])},cLjS:function(n,e,t){var i=t("YDEO");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t("rjj0")("3c9e4f5a",i,!1,{})},z8fj:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=t("IaGi"),o=t("ufHF"),a={props:{info:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:!0,permissionsList:[],userList:[]}},created:function(){this.getDetail(this.info.id),this.getUsers()},methods:{cancel:function(n){this.$emit("close","cancel")},editFn:function(){this.$router.push({path:"/setting/role-power/edit",query:{roleId:this.info.id}})},getDetail:function(n){var e=this;this.$fetch.setting.roleInfo(n,{expand:"permissions"}).then(function(n){e.$handleResponse(n,function(n){e.handleData(n.role.permissions)},!0)}).catch(function(n){e.$store.commit("closeLoading")})},handleData:function(n){var e=this;this.$hasArrContent(n)&&n.forEach(function(n){if(n.checked){var t=[];e.$hasArrContent(n.child)&&n.child.forEach(function(n){if(n.checked){var i=[];e.$hasArrContent(n.child)&&n.child.forEach(function(n){n.checked&&i.push(n.name)}),e.$hasArrContent(i)?t.push(n.name+"("+i.join(",")+")"):t.push(n.name)}}),e.permissionsList.push({left:n.name,right:t.join("、")})}})},getUsers:function(){var n=this;this.$fetch.setting.queryAccountList({expand:"roles",roleId:this.info.id}).then(function(e){n.$handleResponse(e,function(e){n.handleUserData(e.list)},!0)}).catch(function(e){n.$store.commit("closeLoading")})},handleUserData:function(n){var e=this;this.$hasArrContent(n)&&n.forEach(function(n){var t=[];e.$hasArrContent(n.roles)&&n.roles.forEach(function(n){if(-1==["dcc_supervisor","dcc_inviter","dcc_group_leader"].indexOf(n.role_key)){var e=[];n.orgs&&n.orgs.length?(n.orgs.forEach(function(n){e.push(n.name)}),t.push(n.name+"("+e.join("、")+")")):t.push(n.name)}}),e.userList.push({name:(n.nickname?n.nickname:"--")+"("+(n.tel?n.tel:"--")+")",org:t.join("、")})})}}},r=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("el-dialog",{staticClass:"view-role-dialog",attrs:{title:"角色详情",visible:n.dialogVisible,width:"800px",appentToBody:"","close-on-click-modal":!1,"before-close":n.cancel},on:{"update:visible":function(e){n.dialogVisible=e}}},[t("el-form",{ref:"form",attrs:{"label-width":"110px"}},[t("el-form-item",{attrs:{label:"角色名称:"}},[n._v("\n            "+n._s(n._f("filterBlank")(n.info.name))+"\n        ")]),n._v(" "),t("el-form-item",{attrs:{label:"角色描述:"}},[n._v("\n            "+n._s(n._f("filterBlank")(n.info.desc))+"\n        ")]),n._v(" "),t("el-form-item",{attrs:{label:"权限:"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:n.permissionsList.length,expression:"permissionsList.length"}],staticClass:"box-wrap"},n._l(n.permissionsList,function(e,i){return t("div",{key:"pow"+i,staticClass:"flex box-item"},[t("div",{staticClass:"w-90 p-l-10 box-left"},[n._v(n._s(e.left))]),n._v(" "),t("div",{staticClass:"flex-1 p-r-10 box-right"},[t("p",{staticClass:"box-right-p"},[n._v(n._s(e.right))])])])}),0)]),n._v(" "),t("el-form-item",{attrs:{label:"用户:"}},[t("el-table",{staticClass:"user-table",attrs:{data:n.userList,border:!0,"max-height":"360"}},[t("el-table-column",{attrs:{prop:"name",label:"用户姓名",width:"300",align:"center"}}),n._v(" "),t("el-table-column",{attrs:{prop:"org",label:"管理范围",align:"center"},scopedSlots:n._u([{key:"default",fn:function(e){return[t("span",[n._v(n._s(n._f("filterBlank")(e.row.org)))])]}}])})],1)],1)],1),n._v(" "),t("span",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"w-90",attrs:{round:"",size:"small"},on:{click:n.cancel}},[n._v("关闭")]),n._v(" "),t("el-button",{staticClass:"w-90",attrs:{round:"",size:"small",type:"primary"},on:{click:function(e){return n.editFn()}}},[n._v(" 编辑")])],1)],1)};r._withStripped=!0;var s={render:r,staticRenderFns:[]},l=s;var c=!1;var d=t("VU/8")(a,l,!1,function(n){c||t("cLjS")},"data-v-e7be9afe",null);d.options.__file="src/pages/setting/role/ViewRole.vue";var p=d.exports,h=t("PdD4"),u={components:{SearchCol:i.a,DataTable:o.a,ViewRole:p},mixins:[h.a],data:function(){return{showView:!1}},created:function(){this.initData(),this.queryData()},methods:{initData:function(){this.initSearch(),this.initTable()},initSearch:function(){this.search={list:[{prop:"keyword",type:"input",label:"角色名称",currentVal:""},{prop:"status",type:"select",label:"角色类型",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[{name:"系统角色",id:0},{name:"自定义角色",id:1}],optionLabel:"name",optionValue:"id"}],keyword:0,status:1}},initTable:function(){this.dataTable={tr:[{id:"1",label:"角色名称",prop:"name",tooltip:!0,show:"template",align:"center"},{id:"2",label:"角色描述",prop:"desc",tooltip:!0,align:"center"},{id:"3",label:"用户数",prop:"userCount",tooltip:!0,align:"center"},{id:"4",label:"角色类型",prop:"type",show:"template",align:"center"},{id:"5",label:"操作",prop:"caozuo",show:"template",width:230,align:"center"}],data:[],page:{totalCount:0,pageSize:20,currentPage:1},border:!0,hasSelect:!0,hasExpand:!1,hasFirstPagination:!0,showScrollBar:!0,checkboxInit:function(n,e){return n.type},search:{value:"",show:!1,url:"setting.queryRoleList",width:"300",placeholder:"线索号码、微信号",displayCol:["nickname","tel"],params:{id:""}}}},getParams:function(){var n=this.dataTable.page,e=n.currentPage,t=n.pageSize,i=this.search,o=i.keyword,a=i.status,r=i.list;return{expand:"userCount",name:r[o].currentVal,type:r[a].currentVal,pageSize:t,page:e}},queryData:function(){var n=this,e=this,t=this.getParams();this.$fetch.setting.queryRoleList(t).then(function(t){n.$handleResponse(t,function(n){e.dataTable.data=n.list?n.list:[],e.dataTable.page=n.page?n.page:e.dataTable.page},!0)}).catch(function(){n.$store.commit("closeLoading")})},handleFn:function(n,e){this.$router.push({path:"add"==n?"/setting/role-power/add":"/setting/role-power/edit",query:{roleId:e.id}})},viewFn:function(n){this.showView=!0,this.viewInfo=n},batchDel:function(n,e){var t=this;if("batch"!=n||this.$hasArrContent(this.selectData)){var i="batch"==n?"您确定要删除选中的角色吗?":"您确定要删除该角色吗";this.$confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"needCenterStyle",cancelButtonClass:"big cancel",confirmButtonClass:"big",roundButton:!0}).then(function(){t.deleteRole("batch"==n?t.selectData:e)})}else this.$message.warning("您还没选择角色")},deleteRole:function(n){var e=this,t=[];n.forEach(function(n){t.push(n.id)}),this.$fetch.setting.roleDelete(t.join(",")).then(function(n){e.$handleResponse(n,function(n){e.$message.success("删除成功"),e.queryData()},!0)}).catch(function(){e.$store.commit("closeLoading")})}}},f=function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("div",{staticClass:"setting-role-page m-20 common-box"},[t("div",{staticClass:"top-title"},[n._v("角色管理")]),n._v(" "),t("div",{staticClass:"search-flex p-l-r-20 m-t-30 line"},[t("search-col",{attrs:{info:n.search.list[n.search.keyword],placeholder:"请输入"}}),n._v(" "),t("search-col",{attrs:{info:n.search.list[n.search.status]}}),n._v(" "),t("search-col",{staticClass:"export-log-btn",attrs:{leftCol:0,rightCol:24}},[t("div",{attrs:{slot:"custom"},slot:"custom"},[t("el-button",{staticClass:"m-l-20 w-110",attrs:{round:"",icon:"el-icon-search",size:"small",type:"primary"},on:{click:n.find}},[n._v("查询")]),n._v(" "),t("el-button",{attrs:{round:"",icon:"el-icon-delete",size:"small",plain:""},on:{click:n.clear}},[n._v("清空查询条件")])],1)])],1),n._v(" "),t("div",{staticClass:"p-l-r-20 p-b-20"},[t("data-table",{ref:"DataTableRef",attrs:{table:n.dataTable},on:{searchTable:n.searchTable,onHandleSelectionChange:n.handleSelectionChange},scopedSlots:n._u([{key:"name",fn:function(e){return[t("el-button",{staticClass:"pointer",attrs:{type:"text"},on:{click:function(t){return n.viewFn(e.obj.row)}}},[n._v(n._s(e.obj.row.name))])]}},{key:"type",fn:function(e){return[n._v("\n                "+n._s(0==e.obj.row.type?"系统角色":"自定义角色")+"\n            ")]}},{key:"userCount",fn:function(e){return[n._v("\n                "+n._s(n._f("filterBlank")(e.obj.row.userCount))+" 个\n            ")]}},{key:"caozuo",fn:function(e){return[t("div",{staticClass:"text-left p-l-50"},[t("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(t){return n.handleFn("edit",e.obj.row)}}},[n._v("编辑")]),n._v(" "),e.obj.row.type?t("el-button",{staticClass:"red_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(t){return n.batchDel("one",[e.obj.row])}}},[n._v("删除")]):n._e()],1)]}}])},[t("div",{attrs:{slot:"buttons"},slot:"buttons"},[t("el-button",{attrs:{type:"primary",round:"",size:"small"},on:{click:function(e){return n.handleFn("add",{})}}},[n._v("新增角色")]),n._v(" "),t("el-button",{staticClass:"w-90",attrs:{plain:"",size:"small",round:""},on:{click:function(e){return n.batchDel("batch",[])}}},[n._v("删除")])],1)])],1),n._v(" "),n.showView?t("view-role",{attrs:{info:n.viewInfo},on:{close:function(e){n.showView=!1}}}):n._e()],1)};f._withStripped=!0;var A={render:f,staticRenderFns:[]},g=A;var b=!1;var v=t("VU/8")(u,g,!1,function(n){b||t("XxI3")},"data-v-f2d5e088",null);v.options.__file="src/pages/setting/role/Role.vue";e.default=v.exports}});
//# sourceMappingURL=23.49d6c6835f5cf200bed5.js.map