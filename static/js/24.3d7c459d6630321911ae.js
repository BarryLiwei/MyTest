webpackJsonp([24],{I0vm:function(t,e){},P2HM:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("/Uby"),n=a("IaGi"),r=a("ufHF"),s=a("PdD4"),o=a("QeCa"),l=a("//Fk"),c=a.n(l),d={components:{CarSelect:o.a},props:{dialogType:{type:String,default:""},rowData:{type:Object,default:{}}},data:function(){return{title:"新增攻防话术",isView:!1,stateOptions:[{label:"显示",value:1},{label:"隐藏",value:0}],mainCarConfig:{brand:!0,brandId:null,series:!0,seriesId:null,model:!1},compareCarConfig:{brand:!0,brandId:null,series:!0,seriesId:null,model:!1},attackForm:{carSeriesId:null,competitionCarSeriesId:null,brandId:null,competitionBrandId:null,displayStatus:null,displayStatusTitle:"",carSeriesName:"",competitionCarSeriesName:"",content:""},rules:{displayStatus:[{required:!0,message:"请选择状态",trigger:"change"}],carSeriesId:[{required:!0,message:"请选择主体车型",trigger:"change"}],competitionCarSeriesId:[{required:!0,message:"请选择对比车型",trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},dialogVisible:!0,brandOptions:[],compareBrandOptions:[]}},created:function(){this.initForm()},methods:{initForm:function(){var t=this;switch(this.dialogType){case"add":this.title="新增攻防话术",this.initBrandOptins(),this.initCompareBrandOptins();break;case"edit":this.title="编辑攻防话术",c.a.all([this.initBrandOptins(),this.initCompareBrandOptins()]).then(function(){t.initData()});break;case"view":this.title="攻防话术详情",this.initData(),this.isView=!0}},initBrandOptins:function(){var t=this;this.$fetch.common.carBrand({},!1).then(function(e){t.$handleResponse(e,function(e){t.brandOptions=e},!1)})},initCompareBrandOptins:function(t){var e=this;this.$fetch.common.carBrandAll({kwd:t},!1).then(function(t){e.$handleResponse(t,function(t){e.compareBrandOptions=t},!1)})},initData:function(){if(this.rowData){var t=this.rowData,e=t.id,a=t.displayStatus,i=t.carSeriesId,n=t.competitionCarSeriesId,r=t.content,s=t.displayStatusTitle,o=t.carSeriesName,l=t.competitionCarSeriesName,c=t.brandId,d=t.competitionBrandId;this.attackForm={id:e,displayStatus:a,displayStatusTitle:s,carSeriesName:o,competitionCarSeriesName:l,brandId:c,competitionBrandId:d,carSeriesId:i,competitionCarSeriesId:n,content:r},this.mainCarConfig.brandId=parseInt(c),this.compareCarConfig.brandId=parseInt(d),this.mainCarConfig.seriesId=parseInt(i),this.compareCarConfig.seriesId=parseInt(n)}},handleSave:function(){var t=this;this.$refs.attackForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;var a=t.attackForm,i="",n={displayStatus:a.displayStatus,carSeriesId:a.carSeriesId,competitionCarSeriesId:a.competitionCarSeriesId,content:a.content};switch(t.dialogType){case"add":i="competitionCreate";break;default:n.id=t.attackForm.id,i="competitionUpdate"}t.$fetch.callCenter[i](n).then(function(e){t.$handleResponse(e,function(e){t.$message.success(("add"==t.dialogType?"新增":"修改")+"成功"),t.$emit("success")},!0)}).catch(function(){t.$store.commit("closeLoading")})})},handleEdit:function(){this.isView=!this.isView},getMainCarData:function(t){var e=t.seriesId;this.attackForm.carSeriesId=e},getCompareCarData:function(t){var e=t.seriesId;this.attackForm.competitionCarSeriesId=e},handleCancel:function(){this.$emit("cancel")}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"attack-form-dialog",attrs:{title:t.title,visible:t.dialogVisible,width:"480px","close-on-click-modal":!1,"before-close":t.handleCancel},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"attackForm",attrs:{"label-width":"90px",model:t.attackForm,rules:t.rules}},[a("el-form-item",{staticClass:"require-right",attrs:{label:"状态",prop:t.isView?"":"displayStatus"}},[t.isView?t._e():a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"状态",size:"small"},model:{value:t.attackForm.displayStatus,callback:function(e){t.$set(t.attackForm,"displayStatus",e)},expression:"attackForm.displayStatus"}},t._l(t.stateOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v(" "),t.isView?a("div",[t._v(t._s(t.attackForm.displayStatusTitle))]):t._e()],1),t._v(" "),a("el-form-item",{staticClass:"require-right",attrs:{label:"主体车型",prop:t.isView?"":"carSeriesId"}},[t.isView?t._e():a("car-select",{attrs:{showCar:t.mainCarConfig,brandOptions:t.brandOptions},on:{carSelect:t.getMainCarData}}),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{size:"small"},model:{value:t.attackForm.carSeriesId,callback:function(e){t.$set(t.attackForm,"carSeriesId",e)},expression:"attackForm.carSeriesId"}}),t._v(" "),t.isView?a("div",[t._v(t._s(t.attackForm.carSeriesName))]):t._e()],1),t._v(" "),a("el-form-item",{staticClass:"require-right",attrs:{label:"对比车型",prop:t.isView?"":"competitionCarSeriesId"}},[t.isView?t._e():a("car-select",{attrs:{showCar:t.compareCarConfig,brandOptions:t.compareBrandOptions,remote:"","remote-method":t.initCompareBrandOptins},on:{carSelect:t.getCompareCarData}}),t._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{size:"small"},model:{value:t.attackForm.competitionCarSeriesId,callback:function(e){t.$set(t.attackForm,"competitionCarSeriesId",e)},expression:"attackForm.competitionCarSeriesId"}}),t._v(" "),t.isView?a("div",[t._v(t._s(t.attackForm.competitionCarSeriesName))]):t._e()],1),t._v(" "),a("el-form-item",{staticClass:"require-right",attrs:{label:"内容",prop:t.isView?"":"content"}},[t.isView?t._e():a("el-input",{attrs:{type:"textarea",maxlength:"500",autosize:{minRows:5},"show-word-limit":""},model:{value:t.attackForm.content,callback:function(e){t.$set(t.attackForm,"content",e)},expression:"attackForm.content"}}),t._v(" "),t.isView?a("div",[t._v(t._s(t.attackForm.content))]):t._e()],1)],1),t._v(" "),a("div",{staticClass:"p-b-20",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"blue_font_white_bg w-90",attrs:{size:"small",round:""},on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),t.isView?t._e():a("el-button",{staticClass:"w-90",attrs:{size:"small",type:"primary",round:""},on:{click:t.handleSave}},[t._v("保存")]),t._v(" "),t.isView?a("el-button",{staticClass:"w-90",attrs:{size:"small",type:"primary",round:""},on:{click:t.handleEdit}},[t._v("编辑")]):t._e()],1)],1)},staticRenderFns:[]};var p=a("VU/8")(d,u,!1,function(t){a("I0vm")},"data-v-63565fa7",null).exports,h={components:{SearchBar:i.a,SearchCol:n.a,DataTable:r.a,CarSelect:o.a,AttackForm:p},mixins:[s.a],data:function(){return{dialogType:"add",showDialog:!1,brandOptions:[],rowData:{}}},created:function(){this.initData(),this.initBrandOptins(),this.queryCompareData(),this.queryData()},methods:{initData:function(){this.initSearch(),this.initTable()},initSearch:function(){this.search={list:[{type:"input",label:"话术ID",currentVal:""},{type:"selectCar",label:"主体车型",brand:!0,series:!0,model:!1,brandId:null,seriesId:null},{prop:"compareCar",type:"cascader",label:"对比车型",currentVal:"",oneVal:"",oneOptions:[],oneOptionLabel:"title",oneOptionValue:"id",secondVal:"",isAll:!0,isAllTitle:"全部",secondOptions:[],secondOptionLabel:"title",secondOptionValue:"id"},{type:"select",label:"状态",currentVal:"",isAll:!0,isAllTitle:"全部",selectOptions:[],optionLabel:"title",optionValue:"id"},{type:"datePicker",dateType:"daterange",label:"创建时间",currentVal:""},{type:"datePicker",dateType:"daterange",label:"更新时间",currentVal:""}],kwd:0,mainCar:1,compareCar:2,state:3,createTime:4,updateTime:5}},initTable:function(){this.dataTable={tr:[{id:"1",label:"话术ID",prop:"longId",tooltip:!0},{id:"2",label:"主体车型",prop:"carSeriesName",tooltip:!0,minWidth:"180"},{id:"3",label:"对比车型",prop:"competitionCarSeriesName",tooltip:!0,minWidth:"180"},{id:"4",label:"状态",prop:"displayStatusTitle",tooltip:!0,minWidth:"80"},{id:"5",label:"创建时间",prop:"createDate",tooltip:!0,minWidth:"110"},{id:"6",label:"更新时间",prop:"updateDate",tooltip:!0,minWidth:"110"},{id:"7",label:"操作选项",prop:"caozuo",show:"template",width:"300"}],data:[],page:{totalCount:0,pageSize:20,currentPage:1},border:!0,hasSelect:!0,hasExpand:!1,hasFirstPagination:!0,showScrollBar:!0,search:{value:"",show:!1,width:"300",placeholder:"请输入任务名称",displayCol:["name","tel"],parma:{id:""}}}},initBrandOptins:function(){var t=this;this.$fetch.common.carBrand({},!1).then(function(e){t.$handleResponse(e,function(e){t.brandOptions=e},!1)})},getParams:function(){var t=this.dataTable.page,e=t.currentPage,a=t.pageSize,i=this.search,n=i.kwd,r=i.mainCar,s=i.compareCar,o=i.state,l=i.createTime,c=i.updateTime,d=i.list;return{kwd:d[n].currentVal,carSeries:d[r].currentVal,competitionCarSeries:d[s].secondVal,displayStatus:d[o].currentVal,createDateStart:d[l].currentVal&&d[l].currentVal[0],createDateEnd:d[l].currentVal&&d[l].currentVal[1],updateDateStart:d[c].currentVal&&d[c].currentVal[0],updateDateEnd:d[c].currentVal&&d[c].currentVal[1],pageSize:a,page:e}},queryData:function(){var t=this,e=this,a=this.getParams();this.$fetch.callCenter.competitionList(a).then(function(a){t.$handleResponse(a,function(a){var i=a.list,n=a.page,r=a.options;e.dataTable.data=i||[],e.dataTable.page=n||e.dataTable.page,t.search.list[t.search.state].selectOptions=r.displayStatus?r.displayStatus:[]},!0)}).catch(function(){t.$store.commit("closeLoading")})},clear:function(){this.clearSearch(),this.dataTable.page.currentPage=1,this.$refs.DataTableRef.initCurrentPage(),this.queryData(),this.queryCompareData()},batchDelete:function(){var t=this;this.$hasArrContent(this.selectData)?this.$confirm("您确定要删除选中的话术吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"needCenterStyle",cancelButtonClass:"big cancel",confirmButtonClass:"big",roundButton:!0}).then(function(){var e=[];t.selectData.forEach(function(t){e.push(t.id)}),t.deleteCompetition(e)}):this.$message.warning("您还没选择话术")},handleState:function(t){var e=this;this.$confirm("您确定要"+(1==t.displayStatus?"隐藏":"显示")+"此话术吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"needCenterStyle",cancelButtonClass:"big cancel",confirmButtonClass:"big",roundButton:!0}).then(function(){e.$fetch.callCenter.competitionToggle({id:t.id}).then(function(a){e.$handleResponse(a,function(a){e.$message.success((1==t.displayStatus?"隐藏":"显示")+"成功"),e.queryData()},!0)}).catch(function(){e.$store.commit("closeLoading")})})},handleDelete:function(t){var e=this;this.$confirm("删除后不可恢复，是否确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"needCenterStyle",cancelButtonClass:"big cancel",confirmButtonClass:"big",roundButton:!0}).then(function(){e.deleteCompetition([t.id])})},deleteCompetition:function(t){var e=this;this.$fetch.callCenter.competitionDelete({id:t}).then(function(t){e.$handleResponse(t,function(t){e.$message.success("删除成功"),e.queryData()},!0)}).catch(function(){e.$store.commit("closeLoading")})},handleFn:function(t,e){this.rowData=e,this.dialogType=t,this.showDialog=!0},handleCancelDialog:function(){this.showDialog=!1},handleSuccessDialog:function(){this.queryData(),this.showDialog=!1},getMainCarData:function(t){var e=t.seriesId,a=this.search,i=a.mainCar;a.list[i].currentVal=e},remoteMethod:function(t){console.log("haha"),this.queryCompareData(t)},getCompareCarData:function(t,e){var a=this;this.search.list[this.search.compareCar].secondVal="",this.$fetch.common.carSeries({brandId:t},!1).then(function(t){a.$handleResponse(t,function(t){a.search.list[a.search.compareCar].secondOptions=a.$hasArrContent(t)?t:[]},!1)})},queryCompareData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$fetch.common.carBrandAll({kwd:e},!1).then(function(e){t.$handleResponse(e,function(e){t.search.list[t.search.compareCar].oneOptions=t.$hasArrContent(e)?e:[]},!1)})}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"attack-skill-page m-20 common-box"},[a("search-bar",{staticClass:"m-t-10 p-20",attrs:{size:"medium"},on:{clear:t.clear,find:t.find}},[a("div",{staticClass:"search-flex"},[a("search-col",{attrs:{info:t.search.list[t.search.kwd],placeholder:"请输入"}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.mainCar],colWidth:7,rightCol:23,brandOptions:t.brandOptions},on:{carSelect:t.getMainCarData}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.compareCar],colWidth:7,rightCol:23,onePlaceholder:"请选择",filterable:"",secondPlaceholder:"请选择",size:"small",oneRemote:!0,"remote-method":t.remoteMethod},on:{fristChange:t.getCompareCarData}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.state],colWidth:4}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.createTime],type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"}}),t._v(" "),a("search-col",{attrs:{info:t.search.list[t.search.updateTime],type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"}})],1)]),t._v(" "),a("div",{staticClass:"p-l-r-20 p-b-20"},[a("data-table",{ref:"DataTableRef",staticClass:"table-cyan",attrs:{table:t.dataTable},on:{searchTable:t.searchTable,onHandleSelectionChange:t.handleSelectionChange},scopedSlots:t._u([{key:"caozuo",fn:function(e){return[a("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(a){return t.handleFn("view",e.obj.row)}}},[t._v("查看")]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(a){return t.handleState(e.obj.row)}}},[t._v(t._s(1==e.obj.row.displayStatus?"隐藏":"显示"))]),t._v(" "),a("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(a){return t.handleFn("edit",e.obj.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{staticClass:"red_font_white_bg",attrs:{plain:"",round:"",size:"mini"},on:{click:function(a){return t.handleDelete(e.obj.row)}}},[t._v("删除")])]}}])},[a("div",{attrs:{slot:"buttons"},slot:"buttons"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus",round:"",size:"small"},on:{click:function(e){return t.handleFn("add",{})}}},[t._v("新建话术")]),t._v(" "),a("el-button",{staticClass:"w-90",attrs:{plain:"",size:"small",round:""},on:{click:t.batchDelete}},[t._v("删除")])],1)])],1),t._v(" "),t.showDialog?a("attack-form",{attrs:{dialogType:t.dialogType,rowData:t.rowData},on:{cancel:t.handleCancelDialog,success:t.handleSuccessDialog}}):t._e()],1)},staticRenderFns:[]};var f=a("VU/8")(h,m,!1,function(t){a("jqBi")},"data-v-4808893e",null);e.default=f.exports},jqBi:function(t,e){}});
//# sourceMappingURL=24.3d7c459d6630321911ae.js.map