webpackJsonp([19],{CxGC:function(t,i){},WMMZ:function(t,i){},a9tQ:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o,s=e("woOf"),n=e.n(s),a=e("Gu7T"),l=e.n(a),r=e("Dd8w"),c=e.n(r),f=e("bOdI"),d=e.n(f),u=e("NYxO"),h=e("MvR/"),g=e("zWK9"),v=e("Y1jt"),p=e("MsbF"),m=e("K9jU"),_={components:(o={BreadCrumb:h.a,StepTitle:g.a,FollowRecord:v.a,Distribute:p.a},d()(o,"Distribute",p.a),d()(o,"Actived",m.a),o),data:function(){return{info:{},showDistribute:!1,showActived:!1,recordList:[],followPage:{totalCount:0,page:1,pageSize:10,totalPage:1},dialogLoading:!1}},created:function(){this.editId=this.$route.query.id,this.getDetail(),this.getFollowList("init")},computed:c()({},Object(u.b)(["roleKey"]),{customeFrom:function(){var t=[];return this.info&&this.info.fromTopName&&t.push(this.info.fromTopName),this.info&&this.info.fromSecondName&&t.push(this.info.fromSecondName),t.join("--")},buyPlace:function(){var t=[];return this.info&&this.info.provinceName&&t.push(this.info.provinceName),this.info&&this.info.cityName&&t.push(this.info.cityName),this.info&&this.info.regionName&&t.push(this.info.regionName),t.join("--")},buyQuotaText:function(){var t="";if(this.info)switch(this.info.buyQuota){case 0:t="未知";break;case 1:t="有";break;case 2:t="无"}return t}}),methods:{getDetail:function(){var t=this;this.$fetch.business.clueDetail({id:this.editId}).then(function(i){t.$handleResponse(i,function(i){t.info=i},!0)}).catch(function(){t.$store.commit("closeLoading")})},getFollowList:function(t){var i=this;"init"==t&&(this.recordList=[],this.followPage.page=1);var e=this.followPage,o=e.page,s=e.pageSize,n={typeId:2,id:this.editId,page:o,pageSize:s};this.$fetch.common.followListByType(n).then(function(t){i.$handleResponse(t,function(t){var e=t.list,o=t.page;e&&e.length>0&&(i.recordList=[].concat(l()(i.recordList),l()(e))),i.followPage.totalCount=o.totalCount,i.followPage.totalPage=o.totalPage},!0)}).catch(function(){i.$store.commit("closeLoading")})},handleFollowScroll:function(){this.followPage.page>=this.followPage.totalPage||(this.followPage.page++,this.getFollowList())},handleClue:function(){this.$router.push({path:"/work/cluesDeal",query:{id:this.info.id,userId:this.info.userId}})},seeArchive:function(){this.$router.push({path:"/business/potential/detail",query:{id:this.info.intentionId}})},distributeFn:function(){var t=this;this.disConfig={title:"分配",groupLabel:"处理坐席组",groupOptions:[],groupObj:{},dccLabel:"处理DCC",selectId:[this.editId],tip:""},this.$fetch.business.assignDCCList({ids:this.disConfig.selectId,operate:"assign"}).then(function(i){t.$handleResponse(i,function(i){t.disConfig.listTotal=i.listTotal,1==i.listTotal?(t.disConfig.groupOptions=t.$hasArrContent(i.list)?i.list:[],t.showDistribute=!0,t.dialogLoading=!1):i.listTotal>1?t.$message.error("所选线索分别归属多个组，不能被分配"):t.$notify.error({title:"错误提示",message:"当前线索不符合要求"})},!0)}).catch(function(){t.$store.commit("closeLoading")})},closeDistribute:function(t,i){var e=this;if("cancel"==t)return this.showDistribute=!1,void(this.dialogLoading=!1);var o=n()({ids:this.disConfig.selectId},i);this.dialogLoading=!0,this.$fetch.business.clueAssign(o).then(function(t){e.$handleResponse(t,function(t){e.$message.success("分配成功"),e.showDistribute=!1,e.getDetail(),e.getFollowList("init")},!0),e.dialogLoading=!1}).catch(function(){e.dialogLoading=!1,e.$store.commit("closeLoading")})},handleActive:function(){var t=this;this.actConfig={title:"激活",groupLabel:"处理坐席组",groupOptions:[],groupObj:{},dccLabel:"处理DCC",selectId:[this.editId],tip:"线索激活状态变为“待处理”由所选坐席组及对应人员进行跟进处理"},this.$fetch.business.assignDCCList({ids:this.actConfig.selectId,operate:"invalidActive"}).then(function(i){t.$handleResponse(i,function(i){t.actConfig.listTotal=i.listTotal,1==i.listTotal?(t.actConfig.groupOptions=t.$hasArrContent(i.list)?i.list:[],t.showActived=!0,t.dialogLoading=!1):i.listTotal>1?(t.showActived=!0,t.dialogLoading=!1,t.actConfig.groupOptions=[],t.actConfig.tip="您所选中的线索分别归属多个组，批量激活后由原处理的DCC继续处理"):t.$notify.error({title:"错误提示",message:"当前线索不符合要求"})},!0)}).catch(function(){t.$store.commit("closeLoading")})},closeActived:function(t,i){var e=this;if("cancel"==t)return this.showActived=!1,void(this.dialogLoading=!1);var o=n()({ids:this.actConfig.selectId},i);this.dialogLoading=!0,this.$fetch.business.InvalidActive(o).then(function(t){e.$handleResponse(t,function(t){e.$message.success("激活成功"),e.showActived=!1,e.getDetail(),e.getFollowList("init")},!0),e.dialogLoading=!1}).catch(function(){e.dialogLoading=!1,e.$store.commit("closeLoading")})}}},b={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"clue-detail-page m-20"},[e("bread-crumb"),t._v(" "),e("div",{staticClass:"common-box detail-wrap m-t-20"},[e("div",{staticClass:"text-right m-b-20"},[t.info&&[1,2,3].indexOf(t.info.status)>-1?e("el-button",{staticClass:"w-60",attrs:{type:"primary",round:"",size:"small",disabled:-1==["dcc_supervisor","dcc_group_leader","administrator"].indexOf(t.roleKey)},on:{click:function(i){return t.distributeFn()}}},[t._v("分配")]):t._e(),t._v(" "),t.info&&1==t.info.status?e("el-button",{staticClass:"w-60",attrs:{type:"primary",round:"",size:"small",disabled:"dcc_inviter"!=t.roleKey},on:{click:t.handleClue}},[t._v("处理")]):t._e(),t._v(" "),t.info&&t.info.intentionId?e("el-button",{staticClass:"blue_font_white_bg",attrs:{plain:"",round:"",size:"small"},on:{click:t.seeArchive}},[t._v("查看档案")]):t._e()],1),t._v(" "),e("div",{staticClass:"flex"},[e("div",{staticClass:"flex-1 detail-left"},[e("step-title",{attrs:{step:{title:"线索信息"}}}),t._v(" "),e("el-form",{ref:"form",staticClass:"m-t-20",attrs:{"label-position":"right","label-width":"150px"}},[e("el-form-item",{attrs:{label:"线索状态"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.statusName))+" ")]),t._v(" "),e("el-form-item",{attrs:{label:"线索类型"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.clueTypeName))+" ")]),t._v(" "),e("el-form-item",{attrs:{label:"处理坐席组"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.dccGroupName))+" ")]),t._v(" "),e("el-form-item",{attrs:{label:"处理DCC"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.dccName))+" ")]),t._v(" "),e("el-form-item",{attrs:{label:"客户姓名"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.nickname))+" ")]),t._v(" "),e("el-form-item",{attrs:{label:"手机号码"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.tel))+" ")]),t._v(" "),e("el-form-item",{attrs:{label:"线索评分"}},[t._v(" "+t._s(t._f("filterBlank")(11!=t.info.grade?t.info.grade:"--"))+" "),11!=t.info.grade?e("span",[t._v("分")]):t._e()]),t._v(" "),e("el-form-item",{attrs:{label:"归属门店"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.areaName))+" ")]),t._v(" "),e("el-form-item",{attrs:{label:"意向车型"}},[t._v(" "+t._s(t._f("filterBlank")(t.info.model))+" ")]),t._v(" "),e("el-form-item",{attrs:{label:"客户来源"}},[t._v(" "+t._s(t._f("filterBlank")(t.customeFrom)))]),t._v(" "),e("el-form-item",{attrs:{label:"购车区域"}},[t._v(" "+t._s(t._f("filterBlank")(t.buyPlace)))]),t._v(" "),e("el-form-item",{attrs:{label:"购车指标"}},[t._v(" "+t._s(t._f("filterBlank")(t.buyQuotaText))+" ")])],1)],1),t._v(" "),e("div",{staticClass:"w-100"}),t._v(" "),e("div",{staticClass:"flex-1 detail-right"},[e("step-title",{attrs:{step:{title:"跟进记录"}}}),t._v(" "),e("follow-record",{staticClass:"m-t-20 p-20 clue-follow-record reset-scrollbar",attrs:{"record-list":t.recordList,scrollEvent:!0},on:{"event-scroll":t.handleFollowScroll}})],1)])]),t._v(" "),t.showDistribute?e("distribute",{attrs:{config:t.disConfig,loading:t.dialogLoading},on:{close:t.closeDistribute}}):t._e(),t._v(" "),t.showActived?e("actived",{attrs:{config:t.actConfig,loading:t.dialogLoading},on:{close:t.closeActived}}):t._e()],1)},staticRenderFns:[]};var C=e("VU/8")(_,b,!1,function(t){e("WMMZ")},"data-v-8c76416e",null);i.default=C.exports},zWK9:function(t,i,e){"use strict";var o={props:{step:{type:Object,default:function(){return{title:"第一步",content:"海报内容"}}},colorStyle:{type:String,default:""}},data:function(){return{}}},s={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"step-title-component step__order por"},[e("el-row",[e("el-col",{attrs:{span:12}},[e("span",{staticClass:"step_left"},[t._v(t._s(t.step.title))]),t._v(" "),e("span",{class:t.colorStyle},[t._v(t._s(t.step.content))])]),t._v(" "),e("el-col",{attrs:{span:12}},[t._t("default")],2)],1)],1)},staticRenderFns:[]};var n=e("VU/8")(o,s,!1,function(t){e("CxGC")},"data-v-27537562",null);i.a=n.exports}});
//# sourceMappingURL=19.2561d9f8fa86de6cd7c9.js.map